{
	"id": 140642614,
	"body": "The situation is not really simple: RFC 6265 is not clear whether to allow or deny \r\ndomain cookies on IP addresses and browsers handle this case differently.\r\nThat was the reason for the TODO in line 450 [1] of the cookiejar implementation.\r\nI have the impression that half a decade ago domain cookies on IP addresses\r\nwhere commonly accepted, sometimes just to match the behavior of Internet Explorer\r\n(see e.g. [2] [3] [4] [10]).\r\n\r\nThe current implementation in Chromium rejects domain cookies in IP addresses \r\n[5] lines 457-477.  If I my understanding of the Mozilla code [6] is correct then\r\nFirefox silently converts a domain cookie for an IP address to a host cookie.\r\n(I have not done tests on any browsers recently.)\r\n\r\nMy gut feeling is that cookies with an IP address as the domain-attribute should be\r\neither rejected (an IP address _is_ _not_ a domain) or be converted to host cookie (i.e.\r\npretending the domain-attribute was not set, a forgivable user error).\r\n\r\nRFC 6265 is not really clear here. I read the following\r\n\r\n\u003e The string is a host name (i.e., not an IP address).\r\n\r\nRFC 6265 section 5.1.3, second bullet, third star [7] as a definition of host name in\r\nthe sense of: \"a host name is not an IP address\".\r\n\r\nTherefore my understanding of the algorithm to produce a canonicalized host name\r\n\r\n\u003e Convert the host name to a sequence of individual domain name labels.\r\n\r\nRFC 6265 section 5.1.2 step 1 [8] is that an IP address does _not_ qualify as a\r\ncanonicalized host name. \r\nAs an IP address is not a canonicalized host name I think that  RFC 6265 section 5.3\r\nstep 6 first case [9] applies:\r\n\r\n\u003e If the canonicalized request-host does not domain-match the domain-attribute:\r\n\u003e         Ignore the cookie entirely and abort these steps.\r\n\r\nand the cookie should be dropped as it is done currently.\r\n\r\n\r\n[1] https://github.com/golang/go/blob/7f0be1f781a523b5acafb527ca123f5b0eac1536/src/net/http/cookiejar/jar.go#L447-L452\r\n[2] https://code.google.com/p/chromium/issues/detail?id=3699\r\n[3] https://codereview.chromium.org/18657/diff/1/net/base/cookie_monster_unittest.cc\r\n[4] https://bugzilla.mozilla.org/show_bug.cgi?id=125344\r\n[5] http://src.chromium.org/viewvc/chrome/trunk/src/net/cookies/cookie_store_unittest.h\r\n[6] https://hg.mozilla.org/mozilla-central/file/3e8dde8f8c17/netwerk/cookie/nsCookieService.cpp#l3502\r\n\r\n[7] http://tools.ietf.org/html/rfc6265#section-5.1.3\r\n[8] http://tools.ietf.org/html/rfc6265#section-5.1.2\r\n[9] http://tools.ietf.org/html/rfc6265#section-5.3\r\n[10] https://bugzilla.mozilla.org/show_bug.cgi?id=125344",
	"user": {
		"login": "vdobler",
		"id": 701382,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2015-09-16T06:27:35Z",
	"updated_at": "2015-09-16T06:27:35Z"
}
