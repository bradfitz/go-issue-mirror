{
	"id": 165002493,
	"number": 16330,
	"state": "closed",
	"title": "invalid memory address or nil pointer dereference in /usr/local/go/src/sync/atomic/64bit_arm.go",
	"body": "I'm getting \"invalid memory address or nil pointer dereference\" in /usr/local/go/src/sync/atomic/64bit_arm.go on my ARM box when trying to run unit tests for my little project (http://github.com/kopia/kopia).\r\n\r\nTried on both 1.6.2 and 1.7 RC1 using official binaries. \r\n\r\nThe same test works fine on AMD64.\r\n\r\n1. What version of Go are you using (`go version`)?\r\n\r\ngo version go1.6.2 linux/arm\r\ngo version go1.7rc1 linux/arm\r\n\r\n2. What operating system and processor architecture are you using (`go env`)?\r\n\r\n$ uname -a\r\n\r\nLinux chip1 4.3.0-ntc #1 SMP Fri Feb 19 09:37:25 PST 2016 armv7l GNU/Linux\r\nThe hardware is from http://getchip.com/\r\n\r\n$ go env (1.6.2)\r\n\r\nGOARCH=\"arm\"\r\nGOBIN=\"\"\r\nGOEXE=\"\"\r\nGOHOSTARCH=\"arm\"\r\nGOHOSTOS=\"linux\"\r\nGOOS=\"linux\"\r\nGOPATH=\"/home/chip/go\"\r\nGORACE=\"\"\r\nGOROOT=\"/usr/local/go\"\r\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_arm\"\r\nGO15VENDOREXPERIMENT=\"1\"\r\nCC=\"gcc\"\r\nGOGCCFLAGS=\"-fPIC -marm -pthread -fmessage-length=0\"\r\nCXX=\"g++\"\r\nCGO_ENABLED=\"1\"\r\n\r\n$ go env (1.7rc1)\r\n\r\nGOARCH=\"arm\"\r\nGOBIN=\"\"\r\nGOEXE=\"\"\r\nGOHOSTARCH=\"arm\"\r\nGOHOSTOS=\"linux\"\r\nGOOS=\"linux\"\r\nGOPATH=\"/home/chip/go\"\r\nGORACE=\"\"\r\nGOROOT=\"/usr/local/go\"\r\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_arm\"\r\nCC=\"gcc\"\r\nGOGCCFLAGS=\"-fPIC -marm -pthread -fmessage-length=0\"\r\nCXX=\"g++\"\r\nCGO_ENABLED=\"1\"\r\n\r\n3. What did you do?\r\n$ go test github.com/kopia/kopia/fs/...\r\n\r\n4. What did you expect to see?\r\nno failures\r\n\r\n5. What did you see instead?\r\n\r\n--- FAIL: TestUpload (0.02s)\r\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\r\n\tpanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal 0xb code=0x1 addr=0x4 pc=0xc8b5c]\r\n\r\ngoroutine 8 [running]:\r\npanic(0x39a2d8, 0x1070a038)\r\n\t/usr/local/go/src/runtime/panic.go:481 +0x330\r\ntesting.tRunner.func1(0x1076a9c0)\r\n\t/usr/local/go/src/testing/testing.go:467 +0x168\r\npanic(0x39a2d8, 0x1070a038)\r\n\t/usr/local/go/src/runtime/panic.go:443 +0x448\r\nsync/atomic.addUint64(0x1074ef5c, 0x3, 0x0, 0x3, 0x0)\r\n\t/usr/local/go/src/sync/atomic/64bit_arm.go:31 +0x68\r\ngithub.com/kopia/kopia/repo.(*countingReader).Read(0x107a4cf0, 0x107ba000, 0x8000, 0x8000, 0x0, 0x0, 0x0)\r\n\t/home/chip/go/src/github.com/kopia/kopia/repo/counting_reader.go:19 +0xa4\r\nio.copyBuffer(0xb65ab2b8, 0x1070a870, 0xb65ab9c8, 0x107a4cf0, 0x107ba000, 0x8000, 0x8000, 0x0, 0x0, 0x0, ...)\r\n\t/usr/local/go/src/io/io.go:380 +0x1c4\r\nio.Copy(0xb65ab2b8, 0x1070a870, 0xb65ab9c8, 0x107a4cf0, 0x107a4cf0, 0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/io/io.go:350 +0x64\r\ngithub.com/kopia/kopia/blob.(*fsStorage).PutBlock(0x107108d0, 0x10710e71, 0x20, 0xb65ab9a8, 0x107a4cf0, 0x0, 0x0, 0x0)\r\n\t/home/chip/go/src/github.com/kopia/kopia/blob/filesystem.go:174 +0x51c\r\ngithub.com/kopia/kopia/repo.(*objectWriter).flushBuffer(0x10719540, 0x0, 0x0, 0x0)\r\n",
	"user": {
		"login": "jkowalski",
		"id": 249880,
		"type": "User",
		"site_admin": false
	},
	"comments": 1,
	"closed_at": "2016-07-12T12:35:18Z",
	"created_at": "2016-07-12T06:20:50Z",
	"updated_at": "2016-07-12T12:35:18Z"
}
