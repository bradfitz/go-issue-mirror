{
	"id": 66059256,
	"body": "\u003ca id=\"c7\"\u003e\u003c/a\u003eComment 7 by **fw@deneb.enyo.de**:\n\n\u003cpre\u003ego-mode-cs is not used from font-lock.  You need something like this (part of my changes\nwhich are not ready for submission):\n\n(defvar go-mode-font-lock-keywords\n  (let ((builtins '(\"append\" \"cap\" \"close\" \"complex\" \"copy\" \"delete\" \"imag\" \"len\"\n                    \"make\" \"new\" \"panic\" \"print\" \"println\" \"real\" \"recover\"))\n        (constants '(\"nil\" \"true\" \"false\" \"iota\"))\n        (type-name \"\\\\s *\\\\(?:[*(]\\\\s *\\\\)*\\\\(?:\\\\w+\\\\s *\\\\.\\\\s *\\\\)?\\\\(\\\\w+\\\\)\")\n        )\n    `((go-mode-cs-font-lock-comment 0 font-lock-comment-face t)\n      (go-mode-cs-font-lock-string 0 font-lock-string-face t)\n      (,(regexp-opt go-mode-keywords 'words) . font-lock-keyword-face)\n  ...)))\n\n(defun go-mode-cs-font-lock-comment (end)\n  \"Font lock support function for comments.\"\n  (go-mode-cs-font-lock-support end t))\n\n(defun go-mode-cs-font-lock-string (end)\n  \"Font lock support function for strings.\"\n  (go-mode-cs-font-lock-support end nil))\n\n(defun go-mode-cs-font-lock-support (end comment)\n  \"Font lock support function for comments and strings.\"\n  (go-mode-cs end)\n  (or\n   (let ((cs-state (go-mode-cs)))\n     (when cs-state\n       (let ((cs-end (min (cdr cs-state) end))\n\t     (cs-char (char-after (car cs-state))))\n\t (when (if comment\n\t\t   (eq cs-char ?/)\n\t\t (not (eq cs-char ?/)))\n\t   ;; Inside a comment/string, skip to its end.\n\t   (set-match-data (list (point) cs-end (current-buffer)))\n\t   (goto-char cs-end)\n\t   t))))\n   ;; Not inside comment/string.  Search for one.\n   (when (re-search-forward (if comment \"/[/*]\" \"[\\\"'`]\") end t)\n     (goto-char (match-beginning 0))\n     (let ((cs (go-mode-cs)))\n       ;; Check that the character is at the start.\n       (if (and cs (= (point) (car cs)))\n\t   (let ((cs-end (min (cdr cs) end)))\n\t     (set-match-data (list (point) cs-end (current-buffer)))\n\t     (goto-char cs-end)\n\t     t)\n\t ;; Not a comment/string.  Continue search.\n\t (goto-char (1+ (point)))\n\t (go-mode-cs-font-lock-support end comment))))))\n\nThe font-lock code will call the functions as iterators, until they return nil. As it\nstands, the search operation in go-mode-cs-font-lock-support is not quite correct, but\nit does work in principle.\n\nMy fixed go-mode-mark-cs is much more complex than yours (which lacks save-match-data,\nby the way). I'll need to check if this is really necessary.\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2012-01-01T21:41:58Z",
	"updated_at": "2014-12-08T10:12:33Z"
}
