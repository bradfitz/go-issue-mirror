{
	"id": 66057653,
	"body": "\u003ca id=\"c8\"\u003e\u003c/a\u003eComment 8:\n\n\u003cpre\u003eBrad,\n\nI don't know how to reproduce the problem reliably and on all different platforms. But\nhere I can demonstrate it on Windows. Build this program:\n\npackage main\n\nimport (\n       \"fmt\"\n       \"io\"\n       \"net\"\n       \"log\"\n       \"os\"\n)\n\nfunc serveClient(fd io.ReadWriteCloser) {\n       defer fd.Close()\n       var buf [1024]byte\n       for {\n               // both parties are blocked reading\n               n, err := fd.Read(buf[0:])\n               if err != nil || n == 0 {\n                       fmt.Printf(\"disconneted: %q\\n\", err)\n                       break\n               }\n       }\n}\n\nfunc server() {\n       const addr = \":0\"\n       fmt.Printf(\"running server ...\\n\")\n       l, err := net.Listen(\"tcp\", addr)\n       if err != nil {\n               log.Fatalf(\"Listen(%q) failed: %v\", addr, err)\n       }\n       defer l.Close()\n       fmt.Printf(\"listening on %s ...\\n\", l.Addr().String())\n       for {\n               fd, err := l.Accept()\n               if err != nil {\n                       break\n               }\n               go serveClient(fd)\n       }\n}\n\nfunc client(addr string) {\n       fmt.Printf(\"running client ...\\n\")\n       fd, err := net.Dial(\"tcp\", addr)\n       if err != nil {\n               log.Fatalf(\"Dial(%q) failed: %v\", addr, err)\n       }\n       defer fd.Close()\n\n       // both parties are blocked reading\n       var b [1024]byte\n       n, err := fd.Read(b[:])\n       if err != nil {\n               log.Fatalf(\"fd.Read() = %d, %v\", n, err)\n       }\n}\n\nfunc main() {\n       if len(os.Args) == 1 {\n               server()\n       } else {\n               client(os.Args[1])\n       }\n}\n\nand then run it on Windows:\n\nC:\\\u003ea.exe\nrunning server ...\nlistening on 0.0.0.0:1713 ...\n\nthen run the same program, but in a new window:\n\nC:\\\u003ea.exe localhost:1713\nrunning client ...\n\nGo back to original (server) window and hit Ctrl+C to kill the program. You should see\nclient program exit with:\n\n2011/07/22 19:33:16 fd.Read() = 0, WSARecv tcp 127.0.0.1:1713: The specified network\nname is no longer available.\n\nIf you run client program on Linux, the message is:\n\n2011/07/22 19:52:22 fd.Read() = 0, read tcp 10.0.0.13:1713: connection reset by peer\n\nAlex\u003c/pre\u003e",
	"user": {
		"login": "alexbrainman",
		"id": 9796621,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2011-07-22T12:24:34Z",
	"updated_at": "2014-12-08T10:11:09Z"
}
