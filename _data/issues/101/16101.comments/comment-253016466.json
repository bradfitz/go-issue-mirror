{
	"id": 253016466,
	"body": "We have a reproduce-able case in a private Hugo site repo, I will try to boil it down, but haven't had any success yet.\r\n\r\nBut here is the trace from the race detector:\r\n\r\n```\r\nWARNING: DATA RACE\r\nRead at 0x00c424139110 by goroutine 6:\r\n  runtime.mapaccess1_faststr()\r\n      /usr/local/go/src/runtime/hashmap_fast.go:192 +0x0\r\n  text/template.(*state).walkTemplate()\r\n      /usr/local/go/src/text/template/exec.go:369 +0x12b\r\n  text/template.(*state).walk()\r\n      /usr/local/go/src/text/template/exec.go:239 +0x3a4\r\n  text/template.(*state).walk()\r\n      /usr/local/go/src/text/template/exec.go:234 +0x1f7\r\n  text/template.(*Template).execute()\r\n      /usr/local/go/src/text/template/exec.go:189 +0x4a2\r\n  text/template.(*Template).Execute()\r\n      /usr/local/go/src/text/template/exec.go:175 +0x64\r\n  html/template.(*Template).Execute()\r\n      /usr/local/go/src/html/template/template.go:104 +0xd0\r\n  github.com/spf13/hugo/hugolib.(*Site).renderThing()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:2436 +0xcf\r\n  github.com/spf13/hugo/hugolib.(*Site).renderForLayouts()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:2408 +0x2b8\r\n  github.com/spf13/hugo/hugolib.(*Site).renderAndWritePage()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:2316 +0x138\r\n  github.com/spf13/hugo/hugolib.pageRenderer()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:1658 +0x23e\r\n\r\nPrevious write at 0x00c424139110 by goroutine 7:\r\n  runtime.mapassign1()\r\n      /usr/local/go/src/runtime/hashmap.go:442 +0x0\r\n  text/template.(*Template).associate()\r\n      /usr/local/go/src/text/template/template.go:216 +0x166\r\n  text/template.(*Template).AddParseTree()\r\n      /usr/local/go/src/text/template/template.go:128 +0x26c\r\n  html/template.(*escaper).commit()\r\n      /usr/local/go/src/html/template/escape.go:746 +0x30c\r\n  html/template.escapeTemplate()\r\n      /usr/local/go/src/html/template/escape.go:39 +0x4fd\r\n  html/template.(*Template).escape()\r\n      /usr/local/go/src/html/template/template.go:85 +0x2fb\r\n  html/template.(*Template).Execute()\r\n      /usr/local/go/src/html/template/template.go:101 +0x3c\r\n  github.com/spf13/hugo/hugolib.(*Site).renderThing()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:2436 +0xcf\r\n  github.com/spf13/hugo/hugolib.(*Site).renderForLayouts()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:2408 +0x2b8\r\n  github.com/spf13/hugo/hugolib.(*Site).renderAndWritePage()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:2316 +0x138\r\n  github.com/spf13/hugo/hugolib.pageRenderer()\r\n      /Users/bep/go/src/github.com/spf13/hugo/hugolib/site.go:1658 +0x23e\r\n```\r\n\r\nWhat I see above is:\r\n\r\n* Both stacks on the Go side starts in `html/template.Execute` \r\n* `Execute` do both reads and writes to the internal template map\r\n* `Execute` is documented as ` A template may be executed safely in parallel.`\r\n\r\n\r\nhttps://github.com/spf13/hugo/issues/2549",
	"user": {
		"login": "bep",
		"id": 394382,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-10-11T19:17:00Z",
	"updated_at": "2016-10-11T19:17:22Z"
}
