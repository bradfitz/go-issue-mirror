{
	"id": 66063087,
	"body": "\u003ca id=\"c9\"\u003e\u003c/a\u003eComment 9:\n\n\u003cpre\u003eOkay, here are slightly tweaked input files. I added\n\n//#cgo linux LDFLAGS: -libverbs\n\nto qp.go.\n\n$ go test -v -x -c ./...\nWORK=/dev/shm/go-build351850605\nmkdir -p $WORK/ib/_test/\n$GOROOT/pkg/tool/linux_amd64/cgo -objdir $WORK/ib/_test/ -- -I $WORK/ib/_test/ qp.go\n$GOROOT/pkg/tool/linux_amd64/6c -FVw -I $WORK/ib/_test/ -I $GOROOT/pkg/linux_amd64 -o\n$WORK/ib/_test/_cgo_defun.6 -DGOOS_linux -DGOARCH_amd64 $WORK/ib/_test/_cgo_defun.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -I $WORK/ib/_test/ -o $WORK/ib/_test/_cgo_main.o -c\n$WORK/ib/_test/_cgo_main.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -I $WORK/ib/_test/ -o $WORK/ib/_test/_cgo_export.o\n-c $WORK/ib/_test/_cgo_export.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -I $WORK/ib/_test/ -o $WORK/ib/_test/qp.cgo2.o -c\n$WORK/ib/_test/qp.cgo2.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -o $WORK/ib/_test/_cgo_.o $WORK/ib/_test/_cgo_main.o\n$WORK/ib/_test/_cgo_export.o $WORK/ib/_test/qp.cgo2.o -libverbs\n$GOROOT/pkg/tool/linux_amd64/cgo -objdir $WORK/ib/_test/ -dynimport\n$WORK/ib/_test/_cgo_.o -dynout $WORK/ib/_test/_cgo_import.c\n$GOROOT/pkg/tool/linux_amd64/6c -FVw -I $WORK/ib/_test/ -I $GOROOT/pkg/linux_amd64 -o\n$WORK/ib/_test/_cgo_import.6 -DGOOS_linux -DGOARCH_amd64 $WORK/ib/_test/_cgo_import.c\n$GOROOT/pkg/tool/linux_amd64/6g -o $WORK/ib/_test/_go_.6 -p ib -D ib -I $WORK\n./qp_test.go $WORK/ib/_test/_cgo_gotypes.go $WORK/ib/_test/qp.cgo1.go\n$GOROOT/pkg/tool/linux_amd64/pack grc $WORK/ib/_test/ib.a $WORK/ib/_test/_go_.6\n$WORK/ib/_test/_cgo_import.6 $WORK/ib/_test/_cgo_defun.6 $WORK/ib/_test/_cgo_export.o\n$WORK/ib/_test/qp.cgo2.o\ncd $WORK/ib/_test\n$GOROOT/pkg/tool/linux_amd64/6g -o ./_go_.6 -p testmain -D  -I . -I $WORK ./_testmain.go\n$GOROOT/pkg/tool/linux_amd64/pack grc ./main.a ./_go_.6\n$GOROOT/pkg/tool/linux_amd64/6l -o ./ib.test -L . -L $WORK ./main.a\ncp $WORK/ib/_test/ib.test ib.test\n\n$ ldd ib.test\nlinux-vdso.so.1 =\u003e  (0x00007fff743ff000)\nlibibverbs.so.1 =\u003e /usr/lib64/libibverbs.so.1 (0x00007ff54cf3c000)\nlibpthread.so.0 =\u003e /lib64/libpthread.so.0 (0x00007ff54cd1f000)\nlibc.so.6 =\u003e /lib64/libc.so.6 (0x00007ff54c967000)\nlibdl.so.2 =\u003e /lib64/libdl.so.2 (0x00007ff54c763000)\n/lib64/ld-linux-x86-64.so.2 (0x00007ff54d157000)\n\n$ GC=gccgo go test -v -x -c ./...\nWORK=/dev/shm/go-build196429072\ncd /home/alberts/ib/src/ib\n$GOROOT/pkg/tool/linux_amd64/cgo -objdir $WORK/ib/_test/ -gccgo -- -I $WORK/ib/_test/\nqp.go\ngcc -Wall -g -I $WORK/ib/_test/ -I $GOROOT/pkg/linux_amd64 -o\n$WORK/ib/_test/_cgo_defun.6 -DGOOS_linux -DGOARCH_amd64 -c $WORK/ib/_test/_cgo_defun.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -I $WORK/ib/_test/ -o $WORK/ib/_test/_cgo_main.o -c\n$WORK/ib/_test/_cgo_main.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -I $WORK/ib/_test/ -o $WORK/ib/_test/_cgo_export.o\n-c $WORK/ib/_test/_cgo_export.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -I $WORK/ib/_test/ -o $WORK/ib/_test/qp.cgo2.o -c\n$WORK/ib/_test/qp.cgo2.c\ngcc -I . -g -O2 -fPIC -m64 -pthread -o $WORK/ib/_test/_cgo_.o $WORK/ib/_test/_cgo_main.o\n$WORK/ib/_test/_cgo_export.o $WORK/ib/_test/qp.cgo2.o -libverbs\ngccgo -I $WORK -c -g -fgo-prefix=fake_ib -o $WORK/ib/_test/ib.o ./qp_test.go\n$WORK/ib/_test/_cgo_gotypes.go $WORK/ib/_test/qp.cgo1.go\nar cru $WORK/ib/_test/libib.a $WORK/ib/_test/ib.o $WORK/ib/_test/_cgo_defun.6\n$WORK/ib/_test/_cgo_export.o $WORK/ib/_test/qp.cgo2.o\ncd $WORK/ib/_test\ngccgo -I . -I $WORK -c -g -o ./main.o ./_testmain.go\nar cru ./main.a ./main.o\ngccgo -o ./ib.test ./main.o -Wl,-( ./libib.a -lpthread -libverbs -Wl,-)\n# testmain\nqp.go:15: error: undefined reference to 'ibv_post_send'\ncollect2: error: ld returned 1 exit status\n\nibverbs shows up in the link line, but it doesn't work.\n\nI configured with --with-ld=/usr/bin/ld.gold.\u003c/pre\u003e\n\n\n\n\n\nAttachments:\n\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/3027/9/qp.go\"\u003eqp.go\u003c/a\u003e (236 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/3027/9/qp_test.go\"\u003eqp_test.go\u003c/a\u003e (103 bytes)",
	"user": {
		"login": "alberts",
		"id": 409689,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2012-03-04T10:48:33Z",
	"updated_at": "2014-12-08T10:15:46Z"
}
