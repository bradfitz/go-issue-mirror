{
	"id": 51282965,
	"number": 4998,
	"state": "closed",
	"title": "runtime: some kind deadlock issue with the new scheduler",
	"body": "\u003cpre\u003eWhat steps will reproduce the problem?\n\nGOMAXPROCS=random ./run.bash --no-rebuild in a loop\n\nWhat do you see instead?\n\n# ../test\nrun mallocfin.go: incorrect output\ncheckdead: find g 4 in status 1\nfatal error: checkdead: runnable g\n\ngoroutine 1 [sleep]:\ntime.Sleep(0xf4240)\n/build/go.tip/go/src/pkg/runtime/ztime_linux_amd64.c:19 +0x2f\nmain.main()\n/build/go.tip/go/test/mallocfin.go:68 +0x190\n\ngoroutine 3 [finalizer wait]:\nexit status 2\n\nexit status 1\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n\n6g\n\nWhich operating system are you using?\n\nlinux\n\nWhich version are you using?  (run 'go version')\n\ngo version devel +e7e2b3ec4717 Wed Mar 06 16:15:04 2013 -0800 linux/amd64\n\nPlease provide any additional information below.\n\nI've seen another hint of this. I think I have a build where the go command deadlocked\nwhile running short tests.\n\nthe test that timed out was compress/lzw, which usually takes only a few milliseconds,\nso I suspect the go command that was running it got very confused.\n\npanic: test timed out\n\ngoroutine 7 [running]:\ntesting.alarm()\n        /build/go.tip/go/src/pkg/testing/testing.go:526 +0x53\ncreated by time.goFunc\n        /build/go.tip/go/src/pkg/time/sleep.go:122 +0x48\n\ngoroutine 1 [chan receive]:\ntesting.RunTests(0x52a0f8, 0x5b6000, 0x3, 0x3, 0x1, ...)\n        /build/go.tip/go/src/pkg/testing/testing.go:427 +0x88e\ntesting.Main(0x52a0f8, 0x5b6000, 0x3, 0x3, 0x5b6410, ...)\n        /build/go.tip/go/src/pkg/testing/testing.go:358 +0x8a\nmain.main()\n        compress/lzw/_test/_testmain.go:59 +0x9a\n\ngoroutine 5 [semacquire]:\nsync.runtime_Semacquire(0xc200000118)\n        /build/go.tip/go/src/pkg/runtime/zsema_linux_amd64.c:165 +0x2e\nsync.(*Cond).Wait(0xc2000a3030)\n        /build/go.tip/go/src/pkg/sync/cond.go:73 +0x95\nio.(*pipe).read(0xc2000a3000, 0xc2000de000, 0x1000, 0x1000, 0x0, ...)\n        /build/go.tip/go/src/pkg/io/pipe.go:52 +0x1f2\nio.(*PipeReader).Read(0xc200000108, 0xc2000de000, 0x1000, 0x1000,\n0x51373842, ...)\n        /build/go.tip/go/src/pkg/io/pipe.go:130 +0x5d\nbufio.(*Reader).fill(0xc2000a51e0)\n        /build/go.tip/go/src/pkg/bufio/bufio.go:79 +0x10c\nbufio.(*Reader).ReadByte(0xc2000a51e0, 0x20, 0x0, 0x0)\n        /build/go.tip/go/src/pkg/bufio/bufio.go:171 +0x7d\ncompress/lzw.(*decoder).readLSB(0xc2000d8300, 0x414b5e, 0xc20004f008,\n0x100000002)\n        /build/go.tip/go/src/pkg/compress/lzw/reader.go:83 +0x3a\ncompress/lzw.(*decoder).decode(0xc2000d8300)\n        /build/go.tip/go/src/pkg/compress/lzw/reader.go:133 +0x34\ncompress/lzw.(*decoder).Read(0xc2000d8300, 0xc200092a00, 0x200, 0x200,\n0x201, ...)\n        /build/go.tip/go/src/pkg/compress/lzw/reader.go:122 +0x17e\nbytes.(*Buffer).ReadFrom(0x7f7febee9a68, 0xc20004a630, 0xc2000d8300,\n0x0, 0x0, ...)\n        /build/go.tip/go/src/pkg/bytes/buffer.go:166 +0x203\nio/ioutil.readAll(0xc20004a630, 0xc2000d8300, 0x200, 0x0, 0x0, ...)\n        /build/go.tip/go/src/pkg/io/ioutil/ioutil.go:32 +0x141\nio/ioutil.ReadAll(0xc20004a630, 0xc2000d8300, 0xc2000d8300,\n0xc20004a630, 0xc2000d8300, ...)\n        /build/go.tip/go/src/pkg/io/ioutil/ioutil.go:41 +0x3d\ncompress/lzw.testFile(0xc20008e120, 0x5138e8, 0x11, 0x0, 0x6, ...)\n        /build/go.tip/go/src/pkg/compress/lzw/writer_test.go:67 +0x5d3\ncompress/lzw.TestWriter(0xc20008e120)\n        /build/go.tip/go/src/pkg/compress/lzw/writer_test.go:93 +0x172\ntesting.tRunner(0xc20008e120, 0x5b6018)\n        /build/go.tip/go/src/pkg/testing/testing.go:346 +0x8a\ncreated by testing.RunTests\n        /build/go.tip/go/src/pkg/testing/testing.go:426 +0x86b\n\ngoroutine 6 [running]:\nsyscall.Syscall()\n        /build/go.tip/go/src/pkg/syscall/asm_linux_amd64.s:16 +0x5\nsyscall.read(0x4, 0xc2000c2000, 0x1000, 0x1000, 0x4301c0, ...)\n        /build/go.tip/go/src/pkg/syscall/zerrors_linux_amd64.go:2337 +0x70\nsyscall.Read(0x0, 0x43071e, 0xc2000b1000, 0x234, 0x0, ...)\n        /build/go.tip/go/src/pkg/syscall/syscall_unix.go:132 +0x5a\ncreated by compress/lzw.testFile\n        /build/go.tip/go/src/pkg/compress/lzw/writer_test.go:61 +0x4b3\nFAIL    compress/lzw    120.020s\u003c/pre\u003e",
	"user": {
		"login": "alberts",
		"id": 409689,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 6,
	"closed_at": "2014-12-08T10:26:41Z",
	"created_at": "2013-03-07T07:16:00Z",
	"updated_at": "2016-06-24T22:35:06Z"
}
