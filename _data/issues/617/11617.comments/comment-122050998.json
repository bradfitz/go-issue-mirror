{
	"id": 122050998,
	"body": "Now we're getting somewhere! Using @mdempsky's link5 core dump with PS3 of my CL, I think I've found the interleaving the leads to this. I don't know why this happens yet.\r\n\r\n```\r\n(gdb) p 'runtime.allp'[0].bitmapLogPos%2048\r\n$4 = 443\r\n(gdb) p 'runtime.allp'[1].bitmapLogPos%2048\r\n$5 = 315\r\n\r\n(gdb) afind 'runtime.allp'[0].bitmapLog, !(x['addr']==0x184ef7ff)\r\n[1310]={addr = 407828479, entry = 0x500, pre = 196 '\\304', post = 0 '\\000'}\r\nentry=initSpan, pre=0b11000100 [presumably reusing a span]\r\n[1311]={addr = 407828479, entry = 0x615, pre = 197 '\\305', post = 0 '\\000'}\r\nentry=heapBitsSweepSpan, pre=0b11000101\r\n[92]={addr = 407828479, entry = 0x297, pre = 0 '\\000', post = 16 '\\020'}\r\nentry=setMarked, post=0b0001000 (marked, no pointers)\r\n\r\n(gdb) afind 'runtime.allp'[1].bitmapLog, !(x['addr']==0x184ef7ff)\r\n[370]={addr = 407828479, entry = 0x500, pre = 0 '\\000', post = 0 '\\000'}\r\nentry=initSpan\r\n[371]={addr = 407828479, entry = 0x954, pre = 0 '\\000', post = 197 '\\305'}\r\nentry=heapBitsSetType, pre=0b11000101 [correct LSym bitmap, not marked]\r\n[1529]={addr = 407828479, entry = 0x615, pre = 16 '\\020', post = 0 '\\000'}\r\nentry=heapBitsSweepSpan\r\n[314]={addr = 407828479, entry = 0x297, pre = 0 '\\000', post = 16 '\\020'}\r\nentry=setMarked\r\n```\r\n\r\nMy guess about the global interleaving (I should probably add timestamps to the log...):\r\n\r\n```\r\nP0 [1310]={addr = 407828479, entry = 0x500, pre = 196 '\\304', post = 0 '\\000'}\r\nentry=initSpan, pre=0b11000100 [presumably reusing a span]\r\n\r\nP1 [370]={addr = 407828479, entry = 0x500, pre = 0 '\\000', post = 0 '\\000'}\r\nentry=initSpan\r\n\r\nP1 [371]={addr = 407828479, entry = 0x954, pre = 0 '\\000', post = 197 '\\305'}\r\nentry=heapBitsSetType, pre=0b11000101 [correct LSym bitmap, not marked]\r\n\r\nP0 [1311]={addr = 407828479, entry = 0x615, pre = 197 '\\305', post = 0 '\\000'}\r\nentry=heapBitsSweepSpan, pre=0b11000101\r\n```\r\n\r\nAt this point we're toast. Note that the above four events probably happened in quick succession, given their event indexes, and appear to be interleaved.\r\n\r\n```\r\nP0 [92]={addr = 407828479, entry = 0x297, pre = 0 '\\000', post = 16 '\\020'}\r\nentry=setMarked, post=0b0001000 (marked, no pointers)\r\n\r\nP1 [1529]={addr = 407828479, entry = 0x615, pre = 16 '\\020', post = 0 '\\000'}\r\nentry=heapBitsSweepSpan\r\n\r\nP1 [314]={addr = 407828479, entry = 0x297, pre = 0 '\\000', post = 16 '\\020'}\r\nentry=setMarked [post agrees with current value of byte, and 314 was *just* logged]\r\n```",
	"user": {
		"login": "aclements",
		"id": 2688315,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2015-07-16T19:01:02Z",
	"updated_at": "2015-07-16T19:08:05Z"
}
