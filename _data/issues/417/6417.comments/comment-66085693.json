{
	"id": 66085693,
	"body": "\u003ca id=\"c10\"\u003e\u003c/a\u003eComment 10:\n\n\u003cpre\u003e\"go test -short\" works.\n\n\"go test\" fails with\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003ego test\nruntime: out of memory: cannot allocate 1073741824-byte block (1074790400 in use)\nfatal error: out of memory\n\ngoroutine 8 [running]:\nruntime.throw(0x61e7f7)\n        C:/go/root/src/pkg/runtime/panic.c:464 +0x67 fp=0x30dc66c0\nruntime.mallocgc(0x40000000, 0x4c4d41, 0x1)\n        C:/go/root/src/pkg/runtime/malloc.goc:91 +0x412 fp=0x30dc66fc\ncnew(0x4c4d40, 0x40000000, 0x1)\n        C:/go/root/src/pkg/runtime/malloc.goc:718 +0xa9 fp=0x30dc670c\nruntime.cnewarray(0x4c4d40, 0x40000000)\n        C:/go/root/src/pkg/runtime/malloc.goc:731 +0x3b fp=0x30dc671c\nmakeslice1(0x4c01c0, 0x40000000, 0x40000000, 0x30dc675c)\n        C:/go/root/src/pkg/runtime/slice.c:57 +0x47 fp=0x30dc6728\nruntime.makeslice(0x4c01c0, 0x40000000, 0x0, 0x40000000, 0x0, ...)\n        C:/go/root/src/pkg/runtime/slice.c:38 +0x96 fp=0x30dc6748\nruntime/pprof_test.TestCPUProfileWithFork(0x10da8420)\n        c:/go/root/src/pkg/runtime/pprof/pprof_test.go:161 +0x78 fp=0x30dc6798\ntesting.tRunner(0x10da8420, 0x61c5f8)\n        C:/go/root/src/pkg/testing/testing.go:389 +0x87 fp=0x30dc67c4\nruntime.goexit()\n        C:/go/root/src/pkg/runtime/proc.c:1396 fp=0x30dc67c8\ncreated by testing.RunTests\n        C:/go/root/src/pkg/testing/testing.go:469 +0x6d2\n\ngoroutine 1 [chan receive]:\ntesting.RunTests(0x529508, 0x61c5e0, 0x5, 0x5, 0x1)\n        C:/go/root/src/pkg/testing/testing.go:470 +0x6ed\ntesting.Main(0x529508, 0x61c5e0, 0x5, 0x5, 0x61fe60, ...)\n        C:/go/root/src/pkg/testing/testing.go:401 +0x6a\nmain.main()\n        runtime/pprof/_test/_testmain.go:55 +0x82\nexit status 2\nFAIL    runtime/pprof   1.078s\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003e\n\nBut if I disable TestCPUProfileWithFork, then sometimes \"go test\" work and sometimes it\ndoes not:\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003ego test\n--- FAIL: TestGoroutineSwitch (0.14 seconds)\n        pprof_test.go:63: profile too short: [0x0 0x3 0x0 0x2710 0x0 0x0 0x1 0x0]\nFAIL\nexit status 1\nFAIL    runtime/pprof   1.391s\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003ego test\n--- FAIL: TestGoroutineSwitch (0.45 seconds)\n        pprof_test.go:63: profile too short: [0x0 0x3 0x0 0x2710 0x0 0x0 0x1 0x0]\nFAIL\nexit status 1\nFAIL    runtime/pprof   1.703s\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003ego test\n--- FAIL: TestGoroutineSwitch (0.59 seconds)\n        pprof_test.go:63: profile too short: [0x0 0x3 0x0 0x2710 0x0 0x0 0x1 0x0]\nFAIL\nexit status 1\nFAIL    runtime/pprof   1.844s\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003ego test\nPASS\nok      runtime/pprof   2.750s\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003ego test\n--- FAIL: TestGoroutineSwitch (0.30 seconds)\n        pprof_test.go:63: profile too short: [0x0 0x3 0x0 0x2710 0x0 0x0 0x1 0x0]\nFAIL\nexit status 1\nFAIL    runtime/pprof   1.547s\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003ego test\n--- FAIL: TestGoroutineSwitch (0.14 seconds)\n        pprof_test.go:63: profile too short: [0x0 0x3 0x0 0x2710 0x0 0x0 0x1 0x0]\nFAIL\nexit status 1\nFAIL    runtime/pprof   1.406s\n\nC:\\go\\root\\src\\pkg\\runtime\\pprof\u003e\n\nAlex\u003c/pre\u003e",
	"user": {
		"login": "alexbrainman",
		"id": 9796621,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2013-10-01T01:50:30Z",
	"updated_at": "2014-12-08T10:35:24Z"
}
