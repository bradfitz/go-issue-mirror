{
	"id": 66088436,
	"body": "\u003ca id=\"c10\"\u003e\u003c/a\u003eComment 10 by **aidanphs**:\n\n\u003cpre\u003eHmm, I've edited the gist (same link) to show a more reduced version (no global\nrequestno any more) that exhibits a similar (ish) stacktrace. Unfortunately the race\ndetector isn't pointing at anything else.\n\nThe docs on database/sql say stmt is safe across goroutines, but database/sql/driver\nsays stmt is not used by goroutines concurrently. So based on that and the mutexes in\nsql.go it seems the safety should be ensured by the database/sql interface? I'm sorry if\nI'm missing something in my go code here, would you prefer this to go to the list?\n\nThe stacktrace is from that exact code (i.e. /opt/go/src/bug.go:29 refers to the\nQueryRow call)\n\nstarting\ncaught signal while mallocing: 11\nfatal error: caught signal while mallocing\n[signal 0xb code=0x1 addr=0x20000001a]\n\ngoroutine 8 [running]:\nruntime_dopanic\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/panic.c:71\nruntime_throw\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/panic.c:106\nsig_panic_leadin\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/go-signal.c:265\nsig_panic_info_handler\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/go-signal.c:300\n\n        :0\nruntime_MCentral_AllocList\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/mcentral.c:63\nruntime_MCache_Alloc\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/mcache.c:24\nruntime_mallocgc\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/malloc.goc:81\nfmt.fmt_sbx.pN7_fmt.fmt\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/fmt/format.go:297\nfmt.fmt_bx.pN7_fmt.fmt\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/fmt/format.go:309\nfmt.fmtBytes.pN6_fmt.pp\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/fmt/print.go:582\nfmt.printField.pN6_fmt.pp\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/fmt/print.go:802\nfmt.doPrintf.pN6_fmt.pp\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/fmt/print.go:1111\nfmt.Sprintf\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/fmt/print.go:229\npq.md5s\n        /opt/go/src/github.com/lib/pq/conn.go:1005\ngithub.com_lib_pq.auth.pN22_github.com_lib_pq.conn\n        /opt/go/src/github.com/lib/pq/conn.go:710\ngithub.com_lib_pq.startup.pN22_github.com_lib_pq.conn\n        /opt/go/src/github.com/lib/pq/conn.go:680\ngithub.com_lib_pq.Open\n        /opt/go/src/github.com/lib/pq/conn.go:147\ngithub.com_lib_pq.Open.pN21_github.com_lib_pq.drv\n        /opt/go/src/github.com/lib/pq/conn.go:32\ndatabase_sql.conn.pN15_database_sql.DB\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/database/sql/sql.go:484\ndatabase_sql.connStmt.pN17_database_sql.Stmt\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/database/sql/sql.go:1135\ndatabase_sql.Query.pN17_database_sql.Stmt\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/database/sql/sql.go:1167\ndatabase_sql.QueryRow.pN17_database_sql.Stmt\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/database/sql/sql.go:1232\nmain.abc\n        /opt/go/src/bug.go:29\nnet_http.ServeHTTP.pN17_net_http.ServeMux\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/net/http/server.go:1416\nnet_http.serve.pN13_net_http.conn\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/go/net/http/server.go:1096\nkickoff\n        /home/aidanhs/Desktop/apparicon/compiler/gcc-4.8.2/libgo/runtime/proc.c:229\n\n        :0\npanic during panic\nexit status 3\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2013-11-23T20:53:57Z",
	"updated_at": "2014-12-08T10:37:57Z"
}
