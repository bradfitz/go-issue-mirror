{
	"id": 51282418,
	"number": 4638,
	"state": "closed",
	"title": "net: go tip fails on some timeout tests",
	"body": "by **qeed.quan**:\n\n\u003cpre\u003eWhat steps will reproduce the problem?\nIf possible, include a link to a program on play.golang.org.\n1. build golang on tip on x86_64 port, 6g etc.\n2. run all.bash\n3.\n\nWhat is the expected output?\nall test is supposed to pass\n\n\nWhat do you see instead?\n# Building C bootstrap tool.\ncmd/dist\n\n# Building compilers and Go bootstrap tool for host, linux/amd64.\nlib9\nlibbio\nlibmach\nmisc/pprof\ncmd/addr2line\ncmd/cov\ncmd/nm\ncmd/objdump\ncmd/pack\ncmd/prof\ncmd/cc\ncmd/gc\ncmd/6l\ncmd/6a\ncmd/6c\ncmd/6g\npkg/runtime\npkg/errors\npkg/sync/atomic\npkg/sync\npkg/io\npkg/unicode\npkg/unicode/utf8\npkg/unicode/utf16\npkg/bytes\npkg/math\npkg/strings\npkg/strconv\npkg/bufio\npkg/sort\npkg/container/heap\npkg/encoding/base64\npkg/syscall\npkg/time\npkg/os\npkg/reflect\npkg/fmt\npkg/encoding/json\npkg/flag\npkg/path/filepath\npkg/path\npkg/io/ioutil\npkg/log\npkg/regexp/syntax\npkg/regexp\npkg/go/token\npkg/go/scanner\npkg/go/ast\npkg/go/parser\npkg/os/exec\npkg/os/signal\npkg/net/url\npkg/text/template/parse\npkg/text/template\npkg/go/doc\npkg/go/build\ncmd/go\n\n# Building packages and commands for linux/amd64.\nruntime\nerrors\nsync/atomic\nunicode\nsync\nio\nunicode/utf8\nmath\nbytes\nbufio\nsyscall\nstrconv\ntime\nreflect\nos\nsort\nstrings\nfmt\npath/filepath\npath\nregexp/syntax\nflag\ngo/token\nregexp\ngo/scanner\ngo/ast\nio/ioutil\nnet/url\ntext/template/parse\ngo/parser\ntext/template\ngo/doc\nlog\ntext/tabwriter\ngo/printer\ngo/build\nos/exec\nhash\ncrypto\ncrypto/md5\ncmd/api\nencoding/binary\ndebug/dwarf\ndebug/elf\ndebug/macho\ndebug/pe\ncmd/cgo\ngo/format\ncmd/fix\ncontainer/heap\nencoding/base64\nunicode/utf16\nencoding/json\nencoding/xml\ncompress/flate\nhash/crc32\ncompress/gzip\ncrypto/cipher\ncrypto/aes\ncrypto/des\nmath/rand\ncrypto/subtle\ncrypto/hmac\ncrypto/rc4\nmath/big\ncrypto/sha1\ncrypto/sha256\nencoding/hex\nencoding/pem\nruntime/cgo\ncrypto/elliptic\ncrypto/ecdsa\ncrypto/rand\ncrypto/rsa\ncrypto/dsa\nencoding/asn1\nnet\ncrypto/x509/pkix\ncrypto/x509\nmime\nos/signal\narchive/zip\nencoding/gob\nindex/suffixarray\nhtml\nhtml/template\nruntime/pprof\ntext/scanner\ncmd/gofmt\ncrypto/tls\nnet/textproto\nmime/multipart\ncmd/vet\nnet/http\ncmd/go\nexpvar\nnet/http/pprof\ncmd/godoc\ncmd/yacc\narchive/tar\ncompress/bzip2\ncompress/lzw\nhash/adler32\ncompress/zlib\ncontainer/list\ncontainer/ring\ncrypto/sha512\ndatabase/sql/driver\ndatabase/sql\ndebug/gosym\nencoding/ascii85\nencoding/base32\nencoding/csv\nexp/cookiejar\nexp/ebnf\ngo/types\nexp/ebnflint\nexp/html/atom\nexp/html\nexp/gotype\nexp/inotify\nexp/norm\nexp/locale/collate\nhash/fnv\nexp/utf8string\nhash/crc64\nimage/color\nimage\nimage/draw\nimage/gif\nimage/jpeg\nimage/png\nlog/syslog\nmath/cmplx\nnet/http/cgi\nnet/http/fcgi\nnet/http/httptest\nnet/http/httputil\nnet/mail\nnet/rpc\nnet/rpc/jsonrpc\nnet/smtp\nold/netchan\nos/user\nexp/locale/collate/build\nexp/locale/collate/tools/colcmp\nruntime/debug\ntesting\ntesting/iotest\ntesting/quick\n\n# Testing packages.\nok  \tcmd/api\t0.019s\n?   \tcmd/cgo\t[no test files]\nok  \tcmd/fix\t3.069s\nok  \tcmd/go\t0.027s\n?   \tcmd/godoc\t[no test files]\nok  \tcmd/gofmt\t0.060s\n?   \tcmd/vet\t[no test files]\n?   \tcmd/yacc\t[no test files]\nok  \tarchive/tar\t0.008s\nok  \tarchive/zip\t0.076s\nok  \tbufio\t0.061s\nok  \tbytes\t0.178s\nok  \tcompress/bzip2\t0.074s\nok  \tcompress/flate\t1.006s\nok  \tcompress/gzip\t0.011s\nok  \tcompress/lzw\t0.098s\nok  \tcompress/zlib\t1.422s\nok  \tcontainer/heap\t0.008s\nok  \tcontainer/list\t0.006s\nok  \tcontainer/ring\t0.019s\n?   \tcrypto\t[no test files]\nok  \tcrypto/aes\t0.028s\nok  \tcrypto/cipher\t0.013s\nok  \tcrypto/des\t0.029s\nok  \tcrypto/dsa\t0.011s\nok  \tcrypto/ecdsa\t0.031s\nok  \tcrypto/elliptic\t0.021s\nok  \tcrypto/hmac\t0.008s\nok  \tcrypto/md5\t0.007s\nok  \tcrypto/rand\t0.055s\nok  \tcrypto/rc4\t0.006s\nok  \tcrypto/rsa\t0.080s\nok  \tcrypto/sha1\t0.007s\nok  \tcrypto/sha256\t0.007s\nok  \tcrypto/sha512\t0.007s\nok  \tcrypto/subtle\t0.017s\nok  \tcrypto/tls\t0.249s\nok  \tcrypto/x509\t0.777s\n?   \tcrypto/x509/pkix\t[no test files]\nok  \tdatabase/sql\t0.013s\nok  \tdatabase/sql/driver\t0.008s\nok  \tdebug/dwarf\t0.008s\nok  \tdebug/elf\t0.022s\nok  \tdebug/gosym\t0.229s\nok  \tdebug/macho\t0.017s\nok  \tdebug/pe\t0.024s\nok  \tencoding/ascii85\t0.009s\nok  \tencoding/asn1\t0.009s\nok  \tencoding/base32\t0.008s\nok  \tencoding/base64\t0.008s\nok  \tencoding/binary\t0.008s\nok  \tencoding/csv\t0.011s\nok  \tencoding/gob\t0.036s\nok  \tencoding/hex\t0.007s\nok  \tencoding/json\t0.048s\nok  \tencoding/pem\t0.011s\nok  \tencoding/xml\t0.016s\nok  \terrors\t0.020s\nok  \texp/cookiejar\t0.011s\nok  \texp/ebnf\t0.020s\nok  \texp/ebnflint\t0.010s\nok  \texp/gotype\t2.546s\nok  \texp/html\t0.146s\nok  \texp/html/atom\t0.008s\nok  \texp/inotify\t1.009s\nok  \texp/locale/collate\t0.060s\nok  \texp/locale/collate/build\t0.032s\n?   \texp/locale/collate/tools/colcmp\t[no test files]\nok  \texp/norm\t0.937s\nok  \texp/utf8string\t0.007s\nok  \texpvar\t0.017s\nok  \tflag\t0.009s\nok  \tfmt\t0.037s\nok  \tgo/ast\t0.009s\nok  \tgo/build\t0.114s\nok  \tgo/doc\t0.061s\nok  \tgo/format\t0.025s\nok  \tgo/parser\t0.048s\nok  \tgo/printer\t0.403s\nok  \tgo/scanner\t0.011s\nok  \tgo/token\t0.045s\nok  \tgo/types\t0.473s\n?   \thash\t[no test files]\nok  \thash/adler32\t0.018s\nok  \thash/crc32\t0.014s\nok  \thash/crc64\t0.021s\nok  \thash/fnv\t0.026s\nok  \thtml\t0.008s\nok  \thtml/template\t0.069s\nok  \timage\t0.089s\nok  \timage/color\t0.016s\nok  \timage/draw\t0.023s\n?   \timage/gif\t[no test files]\nok  \timage/jpeg\t0.144s\nok  \timage/png\t0.057s\nok  \tindex/suffixarray\t0.022s\nok  \tio\t0.022s\nok  \tio/ioutil\t0.009s\nok  \tlog\t0.008s\nok  \tlog/syslog\t0.414s\nok  \tmath\t0.009s\nok  \tmath/big\t0.180s\nok  \tmath/cmplx\t0.008s\nok  \tmath/rand\t0.036s\nok  \tmime\t0.013s\nok  \tmime/multipart\t0.207s\npollServer WaitFD: epoll_wait: invalid argument\n--- FAIL: TestVariousDeadlines1Proc-4 (2.00 seconds)\ntimeout_test.go:487: \t1ns run 1/1\ntimeout_test.go:507: \tfor 1ns run 1/1, good client timeout after 10.782us, reading 0\nbytes\ntimeout_test.go:521: \tfor 1ns run 1/1, timeout waiting for server to finish writing\n--- FAIL: TestVariousDeadlines4Proc-4 (2.01 seconds)\ntimeout_test.go:487: \t1ns run 1/1\ntimeout_test.go:507: \tfor 1ns run 1/1, good client timeout after 9.854us, reading 0 bytes\ntimeout_test.go:517: \tfor 1ns run 1/1: server in 4.19375ms wrote 729472, write tcp\n127.0.0.1:47567: connection reset by peer\ntimeout_test.go:487: \t2ns run 1/1\ntimeout_test.go:507: \tfor 2ns run 1/1, good client timeout after 12.411us, reading 0\nbytes\ntimeout_test.go:517: \tfor 2ns run 1/1: server in 1.339974ms wrote 729472, write tcp\n127.0.0.1:47568: connection reset by peer\ntimeout_test.go:487: \t5ns run 1/1\ntimeout_test.go:507: \tfor 5ns run 1/1, good client timeout after 11.013us, reading 0\nbytes\ntimeout_test.go:517: \tfor 5ns run 1/1: server in 1.244013ms wrote 729472, write tcp\n127.0.0.1:47569: connection reset by peer\ntimeout_test.go:487: \t50ns run 1/1\ntimeout_test.go:507: \tfor 50ns run 1/1, good client timeout after 18.326us, reading 0\nbytes\ntimeout_test.go:517: \tfor 50ns run 1/1: server in 1.07151ms wrote 729472, write tcp\n127.0.0.1:47570: connection reset by peer\ntimeout_test.go:487: \t100ns run 1/1\ntimeout_test.go:507: \tfor 100ns run 1/1, good client timeout after 4.817us, reading 0\nbytes\ntimeout_test.go:517: \tfor 100ns run 1/1: server in 1.072764ms wrote 729472, write tcp\n127.0.0.1:47571: connection reset by peer\ntimeout_test.go:487: \t200ns run 1/1\ntimeout_test.go:507: \tfor 200ns run 1/1, good client timeout after 2.09us, reading 0\nbytes\ntimeout_test.go:521: \tfor 200ns run 1/1, timeout waiting for server to finish writing\nFAIL\nFAIL\tnet\t6.273s\nok  \tnet/http\t2.797s\nok  \tnet/http/cgi\t0.235s\nok  \tnet/http/fcgi\t0.012s\nok  \tnet/http/httptest\t0.015s\nok  \tnet/http/httputil\t0.040s\n?   \tnet/http/pprof\t[no test files]\nok  \tnet/mail\t0.008s\nok  \tnet/rpc\t0.047s\nok  \tnet/rpc/jsonrpc\t0.024s\nok  \tnet/smtp\t0.012s\nok  \tnet/textproto\t0.008s\nok  \tnet/url\t0.009s\nok  \told/netchan\t0.020s\nok  \tos\t0.056s\nok  \tos/exec\t0.365s\nok  \tos/signal\t0.116s\nok  \tos/user\t0.017s\nok  \tpath\t0.009s\nok  \tpath/filepath\t0.098s\nok  \treflect\t0.041s\nok  \tregexp\t0.123s\nok  \tregexp/syntax\t0.548s\nok  \truntime\t2.275s\n?   \truntime/cgo\t[no test files]\nok  \truntime/debug\t0.007s\nok  \truntime/pprof\t0.356s\nok  \tsort\t0.064s\nok  \tstrconv\t0.432s\nok  \tstrings\t0.097s\nok  \tsync\t0.270s\nok  \tsync/atomic\t0.097s\nok  \tsyscall\t0.036s\n?   \ttesting\t[no test files]\n?   \ttesting/iotest\t[no test files]\nok  \ttesting/quick\t0.022s\nok  \ttext/scanner\t0.019s\nok  \ttext/tabwriter\t0.012s\nok  \ttext/template\t0.050s\nok  \ttext/template/parse\t0.014s\nok  \ttime\t2.156s\nok  \tunicode\t0.009s\nok  \tunicode/utf16\t0.007s\nok  \tunicode/utf8\t0.010s\n?   \tunsafe\t[no test files]\n\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n6g\n\nWhich operating system are you using?\nslackware linux 64 bit\n\nWhich version are you using?  (run 'go version')\ngo version devel +7359dad2971d Wed Jan 09 22:03:41 2013 +0100 linux/amd64\n\nPlease provide any additional information below.\nfor some reason other people running 64 bit hasnt been able to reproduce it. I am using\nthe latest kernel 3.8rc2 if that matters, otherwise, i cannot think of any software\nupdates ive done recently.\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 3,
	"closed_at": "2014-12-08T10:24:35Z",
	"created_at": "2013-01-09T21:52:13Z",
	"updated_at": "2016-06-24T22:30:59Z",
	"milestone": {
		"id": 1067199,
		"number": 11,
		"title": "Go1.1"
	}
}
