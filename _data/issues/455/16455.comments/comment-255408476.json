{
	"id": 255408476,
	"body": "We are certainly misparsing the output of pkg-config, since we use strings.Fields. There's no way that can possibly handle a path like C:/Program Files correctly. The question is how the output is defined so that we can parse it correctly.\n\nOn Linux, I get:\n\n\t$ cat /tmp/whitespace.pc\n\tprefix=/usr\n\texec_prefix=${prefix}\n\tlibdir=\"${exec_prefix}/white space/lib\"\n\tincludedir=\"${prefix}/white space/include\"\n\t\n\tName: Whitespace test\n\tDescription: Dummy pkgconfig test package for testing pkgconfig\n\tVersion: 1.0.0\n\tRequires:\n\tLibs: -L${libdir} -lfoo\\ bar \"-lbar baz\" -r:foo \n\tCflags: -I${includedir} -I$(top_builddir) -Iinclude\\ dir \"-Iother include dir\" -Dlala=misc\n\t$ PKG_CONFIG_PATH=/tmp pkg-config --libs whitespace\n\t-r:foo -L/usr/white\\ space/lib -lfoo\\ bar -lbar\\ baz  \n\t$ \n\nThat is, on Linux pkg-config seems to escape spaces with a backslash. We don't handle that (and we should), but if pkg-config on Windows were emitting those, we'd see them in the CGO_LDFLAGS print, and we don't. For example, if I continue on Linux:\n\n\t$ cat x.go\n\tpackage main\n\t\n\t/*\n\t#cgo pkg-config: whitespace\n\t*/\n\timport \"C\"\n\t\n\tfunc main() {}\n\n\t$ PKG_CONFIG_PATH=/tmp go build -x x.go\n\tWORK=/tmp/go-build540380321\n\tmkdir -p $WORK/command-line-arguments/_obj/\n\tmkdir -p $WORK/command-line-arguments/_obj/exe/\n\tcd /usr/local/google/home/rsc\n\tpkg-config --cflags whitespace\n\tpkg-config --libs whitespace\n\tCGO_LDFLAGS=\"-g\" \"-O2\" \"-r:foo\" \"-L/usr/white\\\\\" \"space/lib\" \"-lfoo\\\\\" \"bar\" \"-lbar\\\\\" \"baz\" ./go/pkg/tool/linux_amd64/cgo -objdir $WORK/command-line-arguments/_obj/ -importpath command-line-arguments -- -Dlala=misc \"-I/usr/white\\\\\" space/include -I$(top_builddir) \"-Iinclude\\\\\" dir \"-Iother\\\\\" \"include\\\\\" dir -I $WORK/command-line-arguments/_obj/ x.go\n\t# command-line-arguments\n\tgcc: error: space/include: No such file or directory\n\tgcc: error: dir: No such file or directory\n\tgcc: error: include\\: No such file or directory\n\tgcc: error: dir: No such file or directory\n\t$ \n\nSo it looks like, even if we were handling spaces correctly on Linux, handling them correctly on Windows would require different code.\n\nThe big question, then, is what pkg-config prints on Windows. It would be great if it printed one arg per line or something like that, so we could split at newline.\n\n@ktsakas, can you please send the output of\n\n\tpkg-config --cflags libgit2\n\tpkg-config --libs libgit2\n\non your Windows machine?\n\nThanks.",
	"user": {
		"login": "rsc",
		"id": 104030,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-10-21T15:29:08Z",
	"updated_at": "2016-10-21T15:29:08Z"
}
