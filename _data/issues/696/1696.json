{
	"id": 51278182,
	"number": 1696,
	"state": "closed",
	"title": "gofmt: rewrite causes panic: reflect: call of reflect.Value·Set on zero Value [recovered] ",
	"body": "\u003cpre\u003eWhat steps will reproduce the problem?\n1. make -C pkg/container/vector generate\n\nWhat is the expected output?\n\npkg/container/vector/intvector.go and friends are regenerated correctly\n\nWhat do you see instead?\n\nlucky(~/go/src) % hg identify ; make -C pkg/container/vector generate\n825dec400be8+ tip\n\u0026lt; vector.go cat\\\n\t| gofmt -r='Vector -\u0026gt; IntVector'\\\n\t| gofmt -r='interface{} -\u0026gt; int'\\\n\t\u0026gt; intvector.go\\\n\t\npanic: reflect: call of reflect.Value·Set on zero Value [recovered]\n\tpanic: reflect: call of reflect.Value·Set on zero Value\n\nruntime.panic+0xac /Users/dave/go/src/pkg/runtime/proc.c:1034\n\truntime.panic(0xb08c0, 0xf8400a76c0)\nmain._func_004+0xcb /Users/dave/go/src/cmd/gofmt/rewrite.go:88\n\tmain._func_004(0x6492, 0x21a8100, 0x21a8fb8, 0x21a8610)\n----- stack segment boundary -----\nruntime.panic+0xf3 /Users/dave/go/src/pkg/runtime/proc.c:1015\n\truntime.panic(0xb08c0, 0xf8400a76c0)\nreflect.Value·internal+0x8b /Users/dave/go/src/pkg/reflect/value.go:95\n\treflect.Value·internal(0x0, 0x0, 0x150000af59, 0xa7b9, 0xf8400a6fc0, ...)\nreflect.Value·Set+0x37 /Users/dave/go/src/pkg/reflect/value.go:715\n\treflect.Value·Set(0xf8400495b0, 0xf8400a76a0, 0x0, 0x0, 0xf8400a3590, ...)\nmain.setValue+0x64 /Users/dave/go/src/cmd/gofmt/rewrite.go:91\n\tmain.setValue(0xf8400495b0, 0xf8400a76a0, 0x0, 0x0, 0xf840049500, ...)\nmain.apply+0x16f /Users/dave/go/src/cmd/gofmt/rewrite.go:131\n\tmain.apply(0xf84000c7d0, 0xf8400495b0, 0xf8400a76a0, 0x0, 0x8, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x357e, ...)\nmain.apply+0x28d /Users/dave/go/src/cmd/gofmt/rewrite.go:127\n\tmain.apply(0xf84000c7d0, 0xf84001f700, 0xf8400a7640, 0xf84002b2d0, 0xb88d0, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x3440, ...)\nmain.apply+0x14f /Users/dave/go/src/cmd/gofmt/rewrite.go:131\n\tmain.apply(0xf84000c7d0, 0xf8400495b0, 0xf8400a7620, 0x0, 0x18, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x357e, ...)\nmain.apply+0x28d /Users/dave/go/src/cmd/gofmt/rewrite.go:127\n\tmain.apply(0xf84000c7d0, 0xf84001f700, 0xf8400a7500, 0xb5268, 0xc4ce0, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x34e8, ...)\n----- stack segment boundary -----\nmain.apply+0x1f7 /Users/dave/go/src/cmd/gofmt/rewrite.go:122\n\tmain.apply(0xf84000c7d0, 0xf840049620, 0xf8400a74e0, 0x0, 0x8, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x357e, ...)\nmain.apply+0x28d /Users/dave/go/src/cmd/gofmt/rewrite.go:127\n\tmain.apply(0xf84000c7d0, 0xf84001f700, 0xf8400a7480, 0x0, 0x10, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x357e, ...)\nmain.apply+0x28d /Users/dave/go/src/cmd/gofmt/rewrite.go:127\n\tmain.apply(0xf84000c7d0, 0xf84001f700, 0xf8400a70c0, 0x0, 0x18, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x357e, ...)\nmain.apply+0x28d /Users/dave/go/src/cmd/gofmt/rewrite.go:127\n\tmain.apply(0xf84000c7d0, 0xf84001f700, 0xf84009e940, 0xf84002b2d0, 0xb9c80, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x3440, ...)\nmain.apply+0x14f /Users/dave/go/src/cmd/gofmt/rewrite.go:131\n\tmain.apply(0xf84000c7d0, 0xf8400495b0, 0xf84009e920, 0xf84002b2d0, 0xb3430, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x34e8, ...)\nmain.apply+0x1f7 /Users/dave/go/src/cmd/gofmt/rewrite.go:122\n\tmain.apply(0xf84000c7d0, 0xf840049620, 0xf84009e900, 0x0, 0x18, ...)\nmain._func_003+0xe7 /Users/dave/go/src/cmd/gofmt/rewrite.go:69\n\tmain._func_003(0xf8400a1658, 0xf8400a1670, 0xf8400a3580, 0xf8400a3590, 0x357e, ...)\nmain.apply+0x28d /Users/dave/go/src/cmd/gofmt/rewrite.go:127\n\tmain.apply(0xf84000c7d0, 0xf84001f700, 0xf84009e7e0, 0xf84009e7e0, 0xf8400a3580, ...)\nmain.rewriteFile+0x1ae /Users/dave/go/src/cmd/gofmt/rewrite.go:75\n\tmain.rewriteFile(0xf840019700, 0xf8400017e0, 0xf840019700, 0xf8400017c0, 0xf840026de0, ...)\nmain._func_002+0x41 /Users/dave/go/src/cmd/gofmt/rewrite.go:31\n\tmain._func_002(0xf8400143f0, 0xf840014340, 0x20c1, 0xf840026de0, 0xd8f3c, ...)\nmain.processFile+0x26c /Users/dave/go/src/cmd/gofmt/gofmt.go:112\n\tmain.processFile(0xd8f3c, 0x6174733c00000010, 0xf84000fba0, 0xf84000f3f0, 0xf84000fb70, ...)\nmain.gofmtMain+0x3a5 /Users/dave/go/src/cmd/gofmt/gofmt.go:213\n\tmain.gofmtMain()\nmain.main+0x1c /Users/dave/go/src/cmd/gofmt/gofmt.go:182\n\tmain.main()\nruntime.mainstart+0xf /Users/dave/go/src/pkg/runtime/amd64/asm.s:77\n\truntime.mainstart()\nruntime.goexit /Users/dave/go/src/pkg/runtime/proc.c:178\n\truntime.goexit()\n----- goroutine created by -----\n_rt0_amd64+0x8e /Users/dave/go/src/pkg/runtime/amd64/asm.s:64\n\u0026lt;standard input\u0026gt;:1:1: expected 'package', found 'EOF'\nmake: *** [generate] Error 2\n\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n\n6g (also tried 8g)\n\nWhich operating system are you using?\n\nlucky(~) % uname -v\nDarwin Kernel Version 10.7.0: Sat Jan 29 15:17:16 PST 2011;\nroot:xnu-1504.9.37~1/RELEASE_I386\n\nWhich revision are you using?  (hg identify)\n\nlucky(~/go/src) % hg identify\n825dec400be8+ tip\n\nPlease provide any additional information below.\n\nThis occurred after \u003ca href=\"http://golang.org/cl/4387044\"\u003ehttp://golang.org/cl/4387044\u003c/a\u003e was committed\u003c/pre\u003e",
	"user": {
		"login": "davecheney",
		"id": 7171,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"assignee": {
		"login": "griesemer",
		"id": 8528975,
		"type": "User",
		"site_admin": false
	},
	"comments": 2,
	"closed_at": "2014-12-08T10:09:30Z",
	"created_at": "2011-04-14T05:27:34Z",
	"updated_at": "2016-06-24T19:27:34Z"
}
