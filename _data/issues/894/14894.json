{
	"id": 142304040,
	"number": 14894,
	"state": "open",
	"title": "cmd/link: build broken on plan9/amd64 since CL 20928",
	"body": "Since [CL 20928](https://golang.org/cl/20928), the build is broken on plan9/amd64.\r\n\r\nIt always fail when reading symbols from the buffer in [readsym](https://github.com/golang/go/blob/b6fe2c2/src/cmd/link/internal/ld/objfile.go#L180), but not always at the same place.\r\n\r\nExample 1:\r\n\r\n```\r\ncmd/compile\r\n# cmd/compile\r\n2016/03/21 01:38:22 bad pcdata -2\r\ncmd/compile/internal/ssa/gen\r\ncmd/cover\r\ncmd/dist\r\ncmd/doc\r\ncmd/fix\r\ncmd/go\r\n# cmd/go\r\npanic: runtime error: slice bounds out of range\r\n\r\ngoroutine 1 [running]:\r\npanic(0x42af80, 0x8872010)\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/runtime/panic.go:483 +0x3fd\r\nbootstrap/link/internal/ld.rddata(0xa941ec0, 0x95652d8, 0x0, 0x0, 0x0)\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/ld/objfile.go:490 +0xd7\r\nbootstrap/link/internal/ld.readsym(0x8ce4000, 0xa941ec0, 0x95652d8, 0x8873140, 0x8, 0xa8e7aa0, 0x54)\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/ld/objfile.go:290 +0x1251\r\nbootstrap/link/internal/ld.ldobjfile(0x8ce4000, 0xa941ec0, 0x8873140, 0x8, 0x1e5b84, 0xa8e7aa0, 0x54)\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/ld/objfile.go:165 +0xd84\r\nbootstrap/link/internal/ld.ldobj(0xa941ec0, 0x8873140, 0x8, 0x1e5bf1, 0xa8e7aa0, 0x54, 0x88955e0, 0x4c, 0x1, 0x0)\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/ld/lib.go:1350 +0x1413\r\nbootstrap/link/internal/ld.objfile(0x887f880)\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/ld/lib.go:846 +0xe2a\r\nbootstrap/link/internal/ld.loadlib()\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/ld/lib.go:523 +0x5d4\r\nbootstrap/link/internal/ld.Ldmain()\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/ld/pobj.go:187 +0x160c\r\nbootstrap/link/internal/amd64.Main()\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/internal/amd64/obj.go:44 +0x1e\r\nmain.main()\r\n\t/tmp/gobuilder/plan9-amd64-9front-36d5650a1c60/go/src/cmd/link/main.go:27 +0x374\r\n```\r\n\r\nSee http://build.golang.org/log/c3fee7600dc4ac359dd804577a201beb008d64d5\r\n\r\nWhere [src/cmd/link/internal/ld/objfile.go:290](https://github.com/golang/go/blob/36d5650a1c/src/cmd/link/internal/ld/objfile.go#L290) is:\r\n\r\n```\r\npc.Pcfile.P = rddata(f, buf)\r\n```\r\n\r\nExample 2:\r\n\r\n```\r\ncmd/compile/internal/ssa/gen\r\n# cmd/compile/internal/ssa/gen\r\npanic: runtime error: index out of range\r\n\r\ngoroutine 1 [running]:\r\npanic(0x371d40, 0x8870000)\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/runtime/panic.go:500 +0x181\r\nbootstrap/link/internal/ld.rdsym(0x8cf8000, 0x8e11ce0, 0x3ac71d, 0x7, 0x8e1fbf0)\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/ld/objfile.go:470 +0x56\r\nbootstrap/link/internal/ld.readsym(0x8cf8000, 0x8e11ce0, 0x908b4c0, 0x3ac71d, 0x7, 0x8892ea0, 0x53)\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/ld/objfile.go:274 +0x5c2\r\nbootstrap/link/internal/ld.ldobjfile(0x8cf8000, 0x8e11ce0, 0x3ac71d, 0x7, 0x16202c, 0x8892ea0, 0x53)\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/ld/objfile.go:164 +0x75d\r\nbootstrap/link/internal/ld.ldobj(0x8e11ce0, 0x3ac71d, 0x7, 0x1620a8, 0x8892ea0, 0x53, 0x8880280, 0x4b, 0x1, 0x0)\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/ld/lib.go:1350 +0x6d8\r\nbootstrap/link/internal/ld.objfile(0x887c2a0)\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/ld/lib.go:846 +0x501\r\nbootstrap/link/internal/ld.loadlib()\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/ld/lib.go:523 +0x165\r\nbootstrap/link/internal/ld.Ldmain()\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/ld/pobj.go:187 +0x122c\r\nbootstrap/link/internal/amd64.Main()\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/internal/amd64/obj.go:44 +0x1e\r\nmain.main()\r\n\t/tmp/gobuilder/plan9-amd64-9front-060a6915d4e3/go/src/cmd/link/main.go:27 +0x281\r\n```\r\n\r\nSee http://build.golang.org/log/48db2f11592b3b99c9ec92ac9e764d12c2c10a34\r\n\r\nWhere [src/cmd/link/internal/ld/objfile.go:274](https://github.com/golang/go/blob/060a691/src/cmd/link/internal/ld/objfile.go#L274) is:\r\n\r\n```\r\nGotype:  rdsym(ctxt, f, pkg),\r\n```\r\n\r\nExample 3:\r\n\r\n```\r\ncmd/yacc\r\n# cmd/yacc\r\npanic: runtime error: slice bounds out of range\r\n\r\ngoroutine 1 [running]:\r\npanic(0x371c80, 0x8870010)\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/runtime/panic.go:500 +0x181\r\nbootstrap/link/internal/ld.rddata(0x8dabf80, 0x907b4b8, 0x24, 0x9370e00, 0x24)\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/ld/objfile.go:431 +0x85\r\nbootstrap/link/internal/ld.readsym(0x8cf8000, 0x8dabf80, 0x907b4b8, 0x3ac636, 0x7, 0x8892de0, 0x53)\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/ld/objfile.go:287 +0x810\r\nbootstrap/link/internal/ld.ldobjfile(0x8cf8000, 0x8dabf80, 0x3ac636, 0x7, 0x16202c, 0x8892de0, 0x53)\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/ld/objfile.go:164 +0x75d\r\nbootstrap/link/internal/ld.ldobj(0x8dabf80, 0x3ac636, 0x7, 0x1620a8, 0x8892de0, 0x53, 0x8880190, 0x4b, 0x1, 0x0)\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/ld/lib.go:1350 +0x6d8\r\nbootstrap/link/internal/ld.objfile(0x887c230)\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/ld/lib.go:846 +0x501\r\nbootstrap/link/internal/ld.loadlib()\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/ld/lib.go:523 +0x165\r\nbootstrap/link/internal/ld.Ldmain()\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/ld/pobj.go:187 +0x122c\r\nbootstrap/link/internal/amd64.Main()\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/internal/amd64/obj.go:44 +0x1e\r\nmain.main()\r\n\t/tmp/gobuilder/plan9-amd64-9front-4402ee9fa3fd/go/src/cmd/link/main.go:27 +0x281\r\n```\r\n\r\nhttp://build.golang.org/log/63f0bac67454da50570bb9cb661f9058ff9a063e\r\n\r\nWhere [src/cmd/link/internal/ld/objfile.go:287](https://github.com/golang/go/blob/4402ee9/src/cmd/link/internal/ld/objfile.go#L287) is:\r\n\r\n```\r\npc.Pcdata[i].P = rddata(f, buf)\r\n```",
	"user": {
		"login": "0intro",
		"id": 6043744,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "OS-Plan9"
		}
	],
	"assignee": {
		"login": "0intro",
		"id": 6043744,
		"type": "User",
		"site_admin": false
	},
	"comments": 15,
	"created_at": "2016-03-21T10:07:20Z",
	"updated_at": "2016-06-27T22:13:50Z",
	"milestone": {
		"id": 1055141,
		"number": 6,
		"title": "Unplanned"
	}
}
