{
	"id": 51285158,
	"number": 6421,
	"state": "closed",
	"title": "8 and 16 bit gray-scale (and others) tiff Encode outputs defective on Mac - two 1/2 x1/2 images",
	"body": "by **gbulmer**:\n\n\u003cpre\u003eWhat steps will reproduce the problem?\n\nEach one of the following results in an image which does not display correctly using\nFinder Preview, Safari, Preview or MS Mac Word\n\n1. 'go build'  image04.go (attached)\n\n2. 'go build'  image03.go (attached)\n\n3. move the attached file writer2_test.go into the go.image/tiff directory, run \u0026quot;go\ntest\u0026quot;\nThis generates a set of files prefixed with roundtrip., and optionally\n\u0026quot;predictor.\u0026quot; or \u0026quot;deflate.\u0026quot; in the go.image/testdata directory\n\nWhat is the expected output?\n1. A 1D grey gradient, ranging from black on the left to white on the right. Each\nvertical line of pixels is the same shade of grey\n\n2. A 2D gray gradient, ranging from black in the top left corner, down to white bottom\nright.\n\n3. Images called go.image/testdata/roundtrip.(predictor.)?(deflate.)?xx.tiff should look\nidentical to the test image go.image/testdata/xx.tiff\n\n\nWhat do you see instead?\n1. results in an 8-bit tiff (attached gray.tiff) which is displayed by Preview and\nSafari as two 1/2 x 1/2 scale image, repeated twice, once top left quadrant, once top\nright quadrant. The lower two quadrants seem to be transparent as they are displayed as\nthe window background colour (mid gray for Preview, white for Safari)\n\n2. results in an 16-bit tiff (attached gray16.tiff) which is also displayed as 1/2 x 1/2\nscale in the same way as 1\n\n3. The files where the roundtrip.xx.tiff file (created by tiff.Decode then tiff.Encode)\nwhich do not correctly display on Finder Preview, Mac Safari or Mac Preview are:\ngo.image/testdata/roundtrip.bw-packbits.tiff\ngo.image/testdata/roundtrip.video-001-gray-16bit.tiff\ngo.image/testdata/roundtrip.video-001-gray.tiff\n\nTwo original go.image/testdata files are attached gray.tiff and gray16.tiff for\ncomparison\n\nA colour file which does not display correctly with Finder Preview, Mac Safari or Mac\nPreview:\ngo.image/testdata/roundtrip.predictor.video-001.tiff\nIt shows as a single vertical line of color pixels in Finder Preview\n\nThis file does not display at all\ngo.image/testdata/roundtrip.video-001-paletted.tiff\n\nOne result is in an 8-bit tiff (attached roundtrip.video-001-gray.tiff) which is\ndisplayed as 1/2 x 1/2 scale in the same way as 1 and 2\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n6g\n\nWhich operating system are you using?\nMac (OS X 10.6.8)\n\nWhich version are you using?  (run 'go version')\ngo version go1.1.2 darwin/amd64\n\nPlease provide any additional information below.\n\nThe writer2_test.go file also generates png.Encoded files. These all seem to be correct,\nand match the original test file. \n\nAttached is an example of the image go.image/testdata/roundtrip.video-001-gray.tiff\nprinted to pdf (roundtrip.video-001-gray.tiff.pdf) from Preview, showing the two 1/2 x\n1/2 scale top 2 quadrant images\n\nAlso attached is the same image saved as a .png which shows the 1/2 x 1/2 top quadrants\neffect\n\nAlso attached is an MS Mac Word document (roundtrip.video-001-gray.tiff.docx) which\ndisplays the image as two 1/2 x 1/2 scale images in the top two quadrants.\n\nHOWEVER Firefox 23.0.1 renders roundtrip.video-001-gray.tiff correctly, so that it looks\nthe same as the original.\u003c/pre\u003e\n\n\n\n\n\nAttachments:\n\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/writer2_test.go\"\u003ewriter2_test.go\u003c/a\u003e (1106 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/roundtrip.video-001-gray.tiff\"\u003eroundtrip.video-001-gray.tiff\u003c/a\u003e (15648 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/roundtrip.video-001-gray.preview.png\"\u003eroundtrip.video-001-gray.preview.png\u003c/a\u003e (11267 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/roundtrip.video-001-gray.tiff.pdf\"\u003eroundtrip.video-001-gray.tiff.pdf\u003c/a\u003e (18344 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/roundtrip.video-001-gray.tiff.docx\"\u003eroundtrip.video-001-gray.tiff.docx\u003c/a\u003e (45894 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/image04.go\"\u003eimage04.go\u003c/a\u003e (615 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/gray.tiff\"\u003egray.tiff\u003c/a\u003e (65734 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/image03.go\"\u003eimage03.go\u003c/a\u003e (622 bytes)\n1. \u003ca href=\"https://storage.googleapis.com/go-attachment/6421/0/gray16.tiff\"\u003egray16.tiff\u003c/a\u003e (1036 bytes)",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 6,
	"closed_at": "2014-12-08T10:35:25Z",
	"created_at": "2013-09-19T01:22:08Z",
	"updated_at": "2016-06-25T01:19:03Z"
}
