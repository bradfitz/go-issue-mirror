{
	"id": 51286001,
	"number": 6970,
	"state": "closed",
	"title": "net/http: test failure",
	"body": "\u003cpre\u003ehg at changeset:   18604:5118124bb019 on OS X 10.9 running amd64\n\nthe net/http tests fail always. they print the cookie errors (they're expected), then\nsit quietly for several minutes and then generate several megabytes of stack dump.\nhere's the first few hundred lines:\n\ntubenose=% go test\n2013/12/16 15:34:59 net/http: invalid Cookie.Domain \u0026quot;wrong;bad.abc\u0026quot;; dropping\ndomain attribute\n2013/12/16 15:34:59 net/http: invalid Cookie.Domain \u0026quot;bad-.abc\u0026quot;; dropping\ndomain attribute\n2013/12/16 15:34:59 net/http: invalid Cookie.Domain \u0026quot;::1\u0026quot;; dropping domain\nattribute\n2013/12/16 15:34:59 net/http: invalid byte ' ' in Cookie.Value; dropping invalid bytes\n2013/12/16 15:34:59 net/http: invalid byte '\\x00' in Cookie.Value; dropping invalid bytes\n2013/12/16 15:34:59 net/http: invalid byte '\u0026quot;' in Cookie.Value; dropping invalid\nbytes\n2013/12/16 15:34:59 net/http: invalid byte ';' in Cookie.Path; dropping invalid bytes\n--- FAIL: TestStressSurpriseServerCloses (7.11 seconds)\n\ttransport_test.go:449: presumed deadlock; no HTTP client activity seen in awhile\n\tz_last_test.go:96: Test appears to have leaked a timing out dial:\n\t\tnet.runtime_pollWait(0x917ed0, 0x77, 0x0)\n\t\t\t/Users/r/go/src/pkg/runtime/netpoll.goc:116 +0x6a\n\t\tnet.(*pollDesc).Wait(0xc21089e290, 0x77, 0x9140c0, 0x24)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:81 +0x34\n\t\tnet.(*pollDesc).WaitWrite(0xc21089e290, 0x24, 0x9140c0)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:90 +0x30\n\t\tnet.(*netFD).connect(0xc21089e230, 0x0, 0x0, 0x917ea8, 0xc2102c1680, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:86 +0x1c4\n\t\tnet.(*netFD).dial(0xc21089e230, 0x917e58, 0x0, 0x917e58, 0xc2109e31e0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:121 +0x33f\n\t\tnet.socket(0x3ad8b0, 0x3, 0x2, 0x1, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:91 +0x40b\n\t\tnet.internetSocket(0x3ad8b0, 0x3, 0x917e58, 0x0, 0x917e58, ...)\n\t\t\t/Users/r/go/src/pkg/net/ipsock_posix.go:136 +0x161\n\t\tnet.dialTCP(0x3ad8b0, 0x3, 0x0, 0xc2109e31e0, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/tcpsock_posix.go:155 +0x12f\n\t\tnet.dialSingle(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:225 +0x3d8\n\t\tnet.func·015(0x0, 0x0, 0x0, 0x3ad8b0, 0x3, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:158 +0xde\n\t\tnet.dial(0x3ad8b0, 0x3, 0x917df0, 0xc2109e31e0, 0x1b9bcb8, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:40 +0x45\n\t\tnet.(*Dialer).Dial(0x1b9bd58, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:165 +0x3e0\n\t\tnet.Dial(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:138 +0x75\n\t\tnet/http.(*Transport).dial(0xc2102fb880, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:401 +0xd4\n\t\tnet/http.(*Transport).dialConn(0xc2102fb880, 0xc210dbff60, 0xc210a764d0, 0x1, 0x0)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:444 +0x6e\n\t\tnet/http.func·016()\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:419 +0x3e\n\t\tcreated by net/http.(*Transport).getConn\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:421 +0x11a\n\t\t\n\t\tnet.runtime_pollWait(0x918020, 0x77, 0x0)\n\t\t\t/Users/r/go/src/pkg/runtime/netpoll.goc:116 +0x6a\n\t\tnet.(*pollDesc).Wait(0xc210dca840, 0x77, 0x9140c0, 0x24)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:81 +0x34\n\t\tnet.(*pollDesc).WaitWrite(0xc210dca840, 0x24, 0x9140c0)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:90 +0x30\n\t\tnet.(*netFD).connect(0xc210dca7e0, 0x0, 0x0, 0x917ea8, 0xc210e514a0, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:86 +0x1c4\n\t\tnet.(*netFD).dial(0xc210dca7e0, 0x917e58, 0x0, 0x917e58, 0xc2108fa330, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:121 +0x33f\n\t\tnet.socket(0x3ad8b0, 0x3, 0x2, 0x1, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:91 +0x40b\n\t\tnet.internetSocket(0x3ad8b0, 0x3, 0x917e58, 0x0, 0x917e58, ...)\n\t\t\t/Users/r/go/src/pkg/net/ipsock_posix.go:136 +0x161\n\t\tnet.dialTCP(0x3ad8b0, 0x3, 0x0, 0xc2108fa330, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/tcpsock_posix.go:155 +0x12f\n\t\tnet.dialSingle(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:225 +0x3d8\n\t\tnet.func·015(0x0, 0x0, 0x0, 0x3ad8b0, 0x3, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:158 +0xde\n\t\tnet.dial(0x3ad8b0, 0x3, 0x917df0, 0xc2108fa330, 0x1b3dcb8, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:40 +0x45\n\t\tnet.(*Dialer).Dial(0x1b3dd58, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:165 +0x3e0\n\t\tnet.Dial(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x1d44b, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:138 +0x75\n\t\tnet/http.(*Transport).dial(0xc2102fb880, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:401 +0xd4\n\t\tnet/http.(*Transport).dialConn(0xc2102fb880, 0xc2109027e0, 0xc210fc6930, 0x1, 0x0)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:444 +0x6e\n\t\tnet/http.func·016()\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:419 +0x3e\n\t\tcreated by net/http.(*Transport).getConn\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:421 +0x11a\n\t\t\n\t\tnet.runtime_pollWait(0x9180c8, 0x77, 0x0)\n\t\t\t/Users/r/go/src/pkg/runtime/netpoll.goc:116 +0x6a\n\t\tnet.(*pollDesc).Wait(0xc21089e060, 0x77, 0x9140c0, 0x24)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:81 +0x34\n\t\tnet.(*pollDesc).WaitWrite(0xc21089e060, 0x24, 0x9140c0)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:90 +0x30\n\t\tnet.(*netFD).connect(0xc21089e000, 0x0, 0x0, 0x917ea8, 0xc2102c15a0, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:86 +0x1c4\n\t\tnet.(*netFD).dial(0xc21089e000, 0x917e58, 0x0, 0x917e58, 0xc2109e30f0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:121 +0x33f\n\t\tnet.socket(0x3ad8b0, 0x3, 0x2, 0x1, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:91 +0x40b\n\t\tnet.internetSocket(0x3ad8b0, 0x3, 0x917e58, 0x0, 0x917e58, ...)\n\t\t\t/Users/r/go/src/pkg/net/ipsock_posix.go:136 +0x161\n\t\tnet.dialTCP(0x3ad8b0, 0x3, 0x0, 0xc2109e30f0, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/tcpsock_posix.go:155 +0x12f\n\t\tnet.dialSingle(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:225 +0x3d8\n\t\tnet.func·015(0x0, 0x0, 0x0, 0x3ad8b0, 0x3, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:158 +0xde\n\t\tnet.dial(0x3ad8b0, 0x3, 0x917df0, 0xc2109e30f0, 0x1bc1cb8, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:40 +0x45\n\t\tnet.(*Dialer).Dial(0x1bc1d58, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:165 +0x3e0\n\t\tnet.Dial(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x1d44b, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:138 +0x75\n\t\tnet/http.(*Transport).dial(0xc2102fb880, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:401 +0xd4\n\t\tnet/http.(*Transport).dialConn(0xc2102fb880, 0xc210dbfd80, 0xc210e59af0, 0x1, 0x0)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:444 +0x6e\n\t\tnet/http.func·016()\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:419 +0x3e\n\t\tcreated by net/http.(*Transport).getConn\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:421 +0x11a\n\t\t\n\t\tnet.runtime_pollWait(0x918170, 0x77, 0x0)\n\t\t\t/Users/r/go/src/pkg/runtime/netpoll.goc:116 +0x6a\n\t\tnet.(*pollDesc).Wait(0xc210af9ed0, 0x77, 0x9140c0, 0x24)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:81 +0x34\n\t\tnet.(*pollDesc).WaitWrite(0xc210af9ed0, 0x24, 0x9140c0)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:90 +0x30\n\t\tnet.(*netFD).connect(0xc210af9e70, 0x0, 0x0, 0x917ea8, 0xc2102ad5c0, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:86 +0x1c4\n\t\tnet.(*netFD).dial(0xc210af9e70, 0x917e58, 0x0, 0x917e58, 0xc210b638a0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:121 +0x33f\n\t\tnet.socket(0x3ad8b0, 0x3, 0x2, 0x1, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:91 +0x40b\n\t\tnet.internetSocket(0x3ad8b0, 0x3, 0x917e58, 0x0, 0x917e58, ...)\n\t\t\t/Users/r/go/src/pkg/net/ipsock_posix.go:136 +0x161\n\t\tnet.dialTCP(0x3ad8b0, 0x3, 0x0, 0xc210b638a0, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/tcpsock_posix.go:155 +0x12f\n\t\tnet.dialSingle(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:225 +0x3d8\n\t\tnet.func·015(0x0, 0x0, 0x0, 0x3ad8b0, 0x3, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:158 +0xde\n\t\tnet.dial(0x3ad8b0, 0x3, 0x917df0, 0xc210b638a0, 0x1b17cb8, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:40 +0x45\n\t\tnet.(*Dialer).Dial(0x1b17d58, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:165 +0x3e0\n\t\tnet.Dial(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x1d44b, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:138 +0x75\n\t\tnet/http.(*Transport).dial(0xc2102fb880, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:401 +0xd4\n\t\tnet/http.(*Transport).dialConn(0xc2102fb880, 0xc210b63600, 0xc2103f7380, 0x1, 0x0)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:444 +0x6e\n\t\tnet/http.func·016()\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:419 +0x3e\n\t\tcreated by net/http.(*Transport).getConn\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:421 +0x11a\n\t\t\n\t\tnet.runtime_pollWait(0x918368, 0x77, 0x0)\n\t\t\t/Users/r/go/src/pkg/runtime/netpoll.goc:116 +0x6a\n\t\tnet.(*pollDesc).Wait(0xc210dcaa70, 0x77, 0x9140c0, 0x24)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:81 +0x34\n\t\tnet.(*pollDesc).WaitWrite(0xc210dcaa70, 0x24, 0x9140c0)\n\t\t\t/Users/r/go/src/pkg/net/fd_poll_runtime.go:90 +0x30\n\t\tnet.(*netFD).connect(0xc210dcaa10, 0x0, 0x0, 0x917ea8, 0xc210e514e0, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:86 +0x1c4\n\t\tnet.(*netFD).dial(0xc210dcaa10, 0x917e58, 0x0, 0x917e58, 0xc2108fa390, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:121 +0x33f\n\t\tnet.socket(0x3ad8b0, 0x3, 0x2, 0x1, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/sock_posix.go:91 +0x40b\n\t\tnet.internetSocket(0x3ad8b0, 0x3, 0x917e58, 0x0, 0x917e58, ...)\n\t\t\t/Users/r/go/src/pkg/net/ipsock_posix.go:136 +0x161\n\t\tnet.dialTCP(0x3ad8b0, 0x3, 0x0, 0xc2108fa390, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/tcpsock_posix.go:155 +0x12f\n\t\tnet.dialSingle(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x0, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:225 +0x3d8\n\t\tnet.func·015(0x0, 0x0, 0x0, 0x3ad8b0, 0x3, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:158 +0xde\n\t\tnet.dial(0x3ad8b0, 0x3, 0x917df0, 0xc2108fa390, 0x1bd7cb8, ...)\n\t\t\t/Users/r/go/src/pkg/net/fd_unix.go:40 +0x45\n\t\tnet.(*Dialer).Dial(0x1bd7d58, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:165 +0x3e0\n\t\tnet.Dial(0x3ad8b0, 0x3, 0xc2102db727, 0xf, 0x1d44b, ...)\n\t\t\t/Users/r/go/src/pkg/net/dial.go:138 +0x75\n\t\tnet/http.(*Transport).dial(0xc2102fb880, 0x3ad8b0, 0x3, 0xc2102db727, 0xf, ...)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:401 +0xd4\n\t\tnet/http.(*Transport).dialConn(0xc2102fb880, 0xc2109028a0, 0xc210fc6770, 0x1, 0x0)\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:444 +0x6e\n\t\tnet/http.func·016()\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:419 +0x3e\n\t\tcreated by net/http.(*Transport).getConn\n\t\t\t/Users/r/go/src/pkg/net/http/transport.go:421 +0x11a\u003c/pre\u003e",
	"user": {
		"login": "robpike",
		"id": 4324516,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"assignee": {
		"login": "bradfitz",
		"id": 2621,
		"type": "User",
		"site_admin": false
	},
	"comments": 2,
	"closed_at": "2014-12-08T10:38:47Z",
	"created_at": "2013-12-16T23:49:13Z",
	"updated_at": "2016-06-25T01:24:03Z"
}
