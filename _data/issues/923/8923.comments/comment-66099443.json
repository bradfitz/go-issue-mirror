{
	"id": 66099443,
	"body": "\u003ca id=\"c3\"\u003e\u003c/a\u003eComment 3:\n\n\u003cpre\u003eThe repro program given ignores the error value, which is the most interesting part in\nthis bug.\n\nMore information for posterity and laziness:\n\nCurl says:\n\n\u0026lt; HTTP/1.1 206 Partial Content\n\u0026lt; Date: Mon, 13 Oct 2014 10:14:40 GMT\n* Server Apache is not blacklisted\n\u0026lt; Server: Apache\n\u0026lt; Access-Control-Allow-Origin: \u003ca href=\"https://render.githubusercontent.com\"\u003ehttps://render.githubusercontent.com\u003c/a\u003e\n\u0026lt; Content-Security-Policy: default-src 'none'\n\u0026lt; X-XSS-Protection: 1; mode=block\n\u0026lt; X-Frame-Options: deny\n\u0026lt; X-Content-Type-Options: nosniff\n\u0026lt; Strict-Transport-Security: max-age=31536000\n\u0026lt; ETag: \"272e65d6363f086441d12d519ac3ec60fbf1cda2\"\n\u0026lt; Content-Type: text/plain; charset=utf-8\n\u0026lt; Cache-Control: max-age=300\n\u0026lt; Accept-Ranges: bytes\n\u0026lt; Via: 1.1 varnish\n\u0026lt; X-Served-By: cache-lcy1122-LCY\n\u0026lt; X-Cache: MISS\n\u0026lt; X-Cache-Hits: 0\n\u0026lt; Vary: Authorization,Accept-Encoding\n\u0026lt; Expires: Mon, 13 Oct 2014 10:19:40 GMT\n\u0026lt; Source-Age: 0\n\u0026lt; Content-Range: bytes 0-5/1862\n\u0026lt; Content-Length: 6\n\u0026lt;\n\nGo says:\n\n$ go run client.go\nRes: \u0026http.Response{Status:\"206 Partial Content\", StatusCode:206, Proto:\"HTTP/1.1\",\nProtoMajor:1, ProtoMinor:1, Header:http.Header{\"Source-Age\":[]string{\"0\"},\n\"Access-Control-Allow-Origin\":[]string{\"\u003ca href=\"https://render.githubusercontent.com\"\u003ehttps://render.githubusercontent.com\u003c/a\u003e\"},\n\"Content-Security-Policy\":[]string{\"default-src 'none'\"},\n\"X-Content-Type-Options\":[]string{\"nosniff\"}, \"Cache-Control\":[]string{\"max-age=300\"},\n\"Accept-Ranges\":[]string{\"bytes\"}, \"Via\":[]string{\"1.1 varnish\"},\n\"X-Cache-Hits\":[]string{\"0\"}, \"X-Frame-Options\":[]string{\"deny\"},\n\"Etag\":[]string{\"\\\"272e65d6363f086441d12d519ac3ec60fbf1cda2\\\"\"},\n\"X-Served-By\":[]string{\"cache-lcy1129-LCY\"},\n\"Vary\":[]string{\"Authorization,Accept-Encoding\"}, \"Expires\":[]string{\"Mon, 13 Oct 2014\n10:22:26 GMT\"}, \"Date\":[]string{\"Mon, 13 Oct 2014 10:17:26 GMT\"},\n\"Server\":[]string{\"Apache\"}, \"Content-Type\":[]string{\"text/plain; charset=utf-8\"},\n\"X-Xss-Protection\":[]string{\"1; mode=block\"},\n\"Strict-Transport-Security\":[]string{\"max-age=31536000\"}, \"X-Cache\":[]string{\"MISS\"},\n\"Content-Range\":[]string{\"bytes 0-5/856\"}}, Body:(*http.bodyEOFSignal)(0xc208144d00),\nContentLength:-1, TransferEncoding:[]string(nil), Close:false, Trailer:http.Header(nil),\nRequest:(*http.Request)(0xc208032820), TLS:(*tls.ConnectionState)(0xc20804fc00)}\nExpires: [Mon, 13 Oct 2014 10:22:26 GMT]\nX-Frame-Options: [deny]\nEtag: [\"272e65d6363f086441d12d519ac3ec60fbf1cda2\"]\nX-Served-By: [cache-lcy1129-LCY]\nVary: [Authorization,Accept-Encoding]\nDate: [Mon, 13 Oct 2014 10:17:26 GMT]\nServer: [Apache]\nContent-Type: [text/plain; charset=utf-8]\nX-Xss-Protection: [1; mode=block]\nStrict-Transport-Security: [max-age=31536000]\nX-Cache: [MISS]\nContent-Range: [bytes 0-5/856]\nAccept-Ranges: [bytes]\nVia: [1.1 varnish]\nX-Cache-Hits: [0]\nSource-Age: [0]\nAccess-Control-Allow-Origin: [\u003ca href=\"https://render.githubusercontent.com\"\u003ehttps://render.githubusercontent.com\u003c/a\u003e]\nContent-Security-Policy: [default-src 'none']\nX-Content-Type-Options: [nosniff]\nCache-Control: [max-age=300]\nlength: -1\nBody: \"\" (0); unexpected EOF\n\n\nSo I think transfer.go is converting the actual \"Content-Length: 6\" from the server into\nContent-Length: -1 (unknown) because the StatusCode (206) is unexpected.  And then the\ntransfer body reader is returning unexpected EOF because there's a Content-Length of -1\n(which normally means chunked), but it's not in chunked encoding.\n\nSo the test and fix should be be that a response with 206 + a Content-Length keeps the\nContent-Length, and then reads the body, in response_test.go.  The fix is probably in\ntransfer.fo.\n\nFeel free to try to fix it soon here if you can in the next day or so, otherwise I will.\u003c/pre\u003e\n\n_Labels changed: added **release-go1.4**, removed **release-none**._\n\n_Owner changed to @bradfitz._\n\n_Status changed to **Accepted**._",
	"user": {
		"login": "bradfitz",
		"id": 2621,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2014-10-13T10:20:01Z",
	"updated_at": "2014-12-22T06:37:49Z"
}
