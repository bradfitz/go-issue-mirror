{
	"id": 51283670,
	"number": 5466,
	"state": "closed",
	"title": "runtime: crash on ARMv5TE when running tests",
	"body": "by **bga@bug-br.org.br**:\n\n\u003cpre\u003eWhat steps will reproduce the problem?\nIf possible, include a link to a program on play.golang.org.\n1. Download the Go 1.1 source code from the usual location.\n2. Try to compile it on an ARM5 device (in my case a QNAP TS-219 running Debian Linux)\nby running all.bash (make sure to set GOARM=5, just in case).\n3. Wait for it to compile and the tests to be executed.\n\nWhat is the expected output?\n\nIt compiles and tests get xecuted without issues.\n\nWhat do you see instead?\n\n[...]\nok  \tcrypto/hmac\t0.069s\nok  \tcrypto/md5\t0.065s\nSIGILL: illegal instruction\nPC=0x4e5154\n\n\ngoroutine 1 [semacquire]:\nsync.runtime_Semacquire(0x10c8ed88)\n\t/usr/local/go/src/pkg/runtime/zsema_linux_arm.c:165 +0x30\nsync.(*WaitGroup).Wait(0x10cfd940)\n\t/usr/local/go/src/pkg/sync/waitgroup.go:109 +0x118\nmain.(*builder).do(0x108573c0, 0x10d028c0)\n\t/usr/local/go/src/cmd/go/build.go:715 +0x428\nmain.runTest(0x4df438, 0x10668010, 0x3, 0x3)\n\t/usr/local/go/src/cmd/go/test.go:330 +0x1ff8\nmain.main()\n\t/usr/local/go/src/cmd/go/main.go:156 +0x4ec\n\ngoroutine 2 [syscall]:\n\ngoroutine 4 [syscall]:\ncreated by os/signal.init·1\n\t/usr/local/go/src/pkg/os/signal/signal_unix.go:27 +0x44\n\ngoroutine 6 [running]:\nsyscall.Syscall()\n\t/usr/local/go/src/pkg/syscall/asm_linux_arm.s:15 +0x8\ncreated by main.(*builder).do\n\t/usr/local/go/src/cmd/go/build.go:712 +0x40c\n\ngoroutine 26 [finalizer wait]:\n\ngoroutine 14 [chan receive]:\nmain.func·026()\n\t/usr/local/go/src/cmd/go/signal.go:21 +0x34\ncreated by main.processSignals\n\t/usr/local/go/src/cmd/go/signal.go:23 +0xc0\n\ntrap    0x6\nerror   0x0\noldmask 0x0\nr0      0x1\nr1      0x40dfcd80\nr2      0x40dfc954\nr3      0x9e4a0046\nr4      0x12fe131d\nr5      0x4e5154\nr6      0x1\nr7      0xf0\nr8      0x2\nr9      0x1066f400\nr10     0x1065f360\nfp      0x2b\nip      0x400b59f0\nsp      0x40dfc95c\nlr      0x7f0e0\npc      0x4e5154\ncpsr    0x80000010\nfault   0x0\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n\nWhatever all.bash uses by default when running the tests after Go is built.\n\nWhich operating system are you using?\n\nDebian Linux\nuname -a output : Linux blindio 2.6.32-5-kirkwood #1 Sun May 6 16:57:51 UTC 2012\narmv5tel GNU/Linux\n\nWhich version are you using?  (run 'go version')\n\nGo 1.1.\n\nPlease provide any additional information below.\n\ncat /proc/cpuinfo\nProcessor\t: Feroceon 88FR131 rev 1 (v5l)\nBogoMIPS\t: 1199.30\nFeatures\t: swp half thumb fastmult edsp \nCPU implementer\t: 0x56\nCPU architecture: 5TE\nCPU variant\t: 0x2\nCPU part\t: 0x131\nCPU revision\t: 1\n\nHardware\t: QNAP TS-119/TS-219\nRevision\t: 0000\nSerial\t\t: 0000000000000000\n\ncat /proc/cpu/alignment\nUser:\t\t0\nSystem:\t\t0\nSkipped:\t0\nHalf:\t\t0\nWord:\t\t0\nDWord:\t\t0\nMulti:\t\t0\nUser faults:\t0 (ignored)\n\nDmesg does not seem to have anything interesting. just in case, I am pasting it here too:\n\ndmesg\n[    0.000000] Initializing cgroup subsys cpuset\n[    0.000000] Initializing cgroup subsys cpu\n[    0.000000] Linux version 2.6.32-5-kirkwood (Debian 2.6.32-45) (dannf@debian.org)\n(gcc version 4.3.5 (Debian 4.3.5-4) ) #1 Sun May 6 16:57:51 UTC 2012\n[    0.000000] CPU: Feroceon 88FR131 [56251311] revision 1 (ARMv5TE), cr=00053977\n[    0.000000] CPU: VIVT data cache, VIVT instruction cache\n[    0.000000] Machine: QNAP TS-119/TS-219\n[    0.000000] Ignoring unrecognised tag 0x41000403\n[    0.000000] Memory policy: ECC disabled, Data cache writeback\n[    0.000000] On node 0 totalpages: 131072\n[    0.000000] free_area_init_node: node 0, pgdat c03d50c4, node_mem_map c0442000\n[    0.000000]   Normal zone: 1024 pages used for memmap\n[    0.000000]   Normal zone: 0 pages reserved\n[    0.000000]   Normal zone: 130048 pages, LIFO batch:31\n[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages:\n130048\n[    0.000000] Kernel command line: console=ttyS0,115200 root=/dev/ram\ninitrd=0xa00000,0x900000 ramdisk=32768\n[    0.000000] PID hash table entries: 2048 (order: 1, 8192 bytes)\n[    0.000000] Dentry cache hash table entries: 65536 (order: 6, 262144 bytes)\n[    0.000000] Inode-cache hash table entries: 32768 (order: 5, 131072 bytes)\n[    0.000000] Memory: 256MB 256MB = 512MB total\n[    0.000000] Memory: 505984KB available (3516K code, 583K data, 124K init, 0K highmem)\n[    0.000000] SLUB: Genslabs=11, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1\n[    0.000000] Hierarchical RCU implementation.\n[    0.000000] NR_IRQS:114\n[    0.000000] Console: colour dummy device 80x30\n[    0.000137] Calibrating delay loop... 1199.30 BogoMIPS (lpj=5996544)\n[    0.230092] Security Framework initialized\n[    0.230111] SELinux:  Disabled at boot.\n[    0.230138] Mount-cache hash table entries: 512\n[    0.230454] Initializing cgroup subsys ns\n[    0.230470] Initializing cgroup subsys cpuacct\n[    0.230480] Initializing cgroup subsys devices\n[    0.230489] Initializing cgroup subsys freezer\n[    0.230498] Initializing cgroup subsys net_cls\n[    0.230557] CPU: Testing write buffer coherency: ok\n[    0.231337] devtmpfs: initialized\n[    0.233041] regulator: core version 0.5\n[    0.233263] NET: Registered protocol family 16\n[    0.233794] Kirkwood: MV88F6281-A1, TCLK=200000000.\n[    0.233807] Feroceon L2: Enabling L2\n[    0.233840] Feroceon L2: Cache support initialised.\n[    0.234274] initial MPP regs: 21112222 11313311 00551110 00000000 00000000 00000000\n00000000\n[    0.234297]   final MPP regs: 21552222 03313311 00551110 00000000 00000000 00000000\n00000000\n[    0.234748] Kirkwood PCIe port 0: \n[    0.234754] link up\n[    0.234761] PCI: bus0 uses PCIe port 0\n[    0.234865] pci 0000:00:00.0: reg 10 64bit mmio pref: [0xf1000000-0xf10fffff]\n[    0.234880] pci 0000:00:00.0: reg 18 32bit mmio: [0x000000-0x1fffffff]\n[    0.234907] pci 0000:00:00.0: supports D1 D2\n[    0.234991] pci 0000:00:01.0: reg 24 32bit mmio: [0x40000000-0x40001fff]\n[    0.235007] pci 0000:00:01.0: reg 30 32bit mmio pref: [0x000000-0x00ffff]\n[    0.235044] pci 0000:00:01.0: PME# supported from D3hot\n[    0.235055] pci 0000:00:01.0: PME# disabled\n[    0.235110] pci 0000:00:01.1: reg 10 io port: [0xfff8-0xffff]\n[    0.235125] pci 0000:00:01.1: reg 14 io port: [0xfffc-0xffff]\n[    0.235139] pci 0000:00:01.1: reg 18 io port: [0xfff8-0xffff]\n[    0.235154] pci 0000:00:01.1: reg 1c io port: [0xfffc-0xffff]\n[    0.235168] pci 0000:00:01.1: reg 20 io port: [0xfff0-0xffff]\n[    0.235254] PCI: bus0: Fast back to back transfers disabled\n[    0.236623] bio: create slab \u0026lt;bio-0\u0026gt; at 0\n[    0.236909] vgaarb: loaded\n[    0.237359] Switching to clocksource orion_clocksource\n[    0.241227] NET: Registered protocol family 2\n[    0.241464] IP route cache hash table entries: 4096 (order: 2, 16384 bytes)\n[    0.242228] TCP established hash table entries: 16384 (order: 5, 131072 bytes)\n[    0.242580] TCP bind hash table entries: 16384 (order: 4, 65536 bytes)\n[    0.242758] TCP: Hash tables configured (established 16384 bind 16384)\n[    0.242767] TCP reno registered\n[    0.242939] NET: Registered protocol family 1\n[    0.243121] Unpacking initramfs...\n[    0.609095] Freeing initrd memory: 9216K\n[    0.609195] NetWinder Floating Point Emulator V0.97 (double precision)\n[    0.609442] audit: initializing netlink socket (disabled)\n[    0.609476] type=2000 audit(0.600:1): initialized\n[    0.615995] VFS: Disk quotas dquot_6.5.2\n[    0.616247] Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)\n[    0.616346] JFFS2 version 2.2. (NAND) (SUMMARY)  © 2001-2006 Red Hat, Inc.\n[    0.616932] msgmni has been set to 1006\n[    0.618694] alg: No test for stdrng (krng)\n[    0.618822] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 253)\n[    0.618835] io scheduler noop registered\n[    0.618842] io scheduler anticipatory registered\n[    0.618850] io scheduler deadline registered\n[    0.619028] io scheduler cfq registered (default)\n[    0.625102] Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled\n[    0.625572] serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 33) is a 16550A\n[    0.976681] console [ttyS0] enabled\n[    0.980445] serial8250.1: ttyS1 at MMIO 0xf1012100 (irq = 34) is a 16550A\n[    0.988234] m25p80 spi0.0: m25p128 (16384 Kbytes)\n[    0.992963] Creating 6 MTD partitions on \u0026quot;spi_flash\u0026quot;:\n[    0.998063] 0x000000000000-0x000000080000 : \u0026quot;U-Boot\u0026quot;\n[    1.003654] 0x000000200000-0x000000400000 : \u0026quot;Kernel\u0026quot;\n[    1.009138] 0x000000400000-0x000000d00000 : \u0026quot;RootFS1\u0026quot;\n[    1.014654] 0x000000d00000-0x000001000000 : \u0026quot;RootFS2\u0026quot;\n[    1.020183] 0x000000080000-0x0000000c0000 : \u0026quot;U-Boot Config\u0026quot;\n[    1.026212] 0x0000000c0000-0x000000200000 : \u0026quot;NAS Config\u0026quot;\n[    1.032224] mice: PS/2 mouse device common for all mice\n[    2.047398] rtc-mv rtc-mv: internal RTC not ticking\n[    2.052394] i2c /dev entries driver\n[    2.057795] rtc-s35390a 0-0030: rtc core: registered rtc-s35390a as rtc0\n[    2.064745] cpuidle: using governor ladder\n[    2.069004] cpuidle: using governor menu\n[    2.073005] mv_xor_shared mv_xor_shared.0: Marvell shared XOR driver\n[    2.079420] mv_xor_shared mv_xor_shared.1: Marvell shared XOR driver\n[    2.117419] mv_xor mv_xor.0: Marvell XOR: ( xor cpy )\n[    2.157417] mv_xor mv_xor.1: Marvell XOR: ( xor fill cpy )\n[    2.197418] mv_xor mv_xor.2: Marvell XOR: ( xor cpy )\n[    2.237419] mv_xor mv_xor.3: Marvell XOR: ( xor fill cpy )\n[    2.244081] TCP cubic registered\n[    2.247325] NET: Registered protocol family 17\n[    2.251821] Gating clock of unused units\n[    2.251829] before: 0x00c7c1dd\n[    2.251836]  after: 0x00c7c1cd\n[    2.252164] registered taskstats version 1\n[    2.257683] rtc-s35390a 0-0030: setting system clock to 2013-05-14 13:55:25 UTC\n(1368539725)\n[    2.266211] Initalizing network drop monitor service\n[    2.271275] Freeing init memory: 124K\n[    2.357840] udev[44]: starting version 164\n[    2.646260] SCSI subsystem initialized\n[    2.728189] libata version 3.00 loaded.\n[    2.745904] sata_mv sata_mv.0: version 1.28\n[    2.750262] sata_mv sata_mv.0: slots 32 ports 2\n[    2.755514] scsi0 : sata_mv\n[    2.759011] scsi1 : sata_mv\n[    2.762270] ata1: SATA max UDMA/133 irq 21\n[    2.766383] ata2: SATA max UDMA/133 irq 21\n[    3.277411] ata1: SATA link up 3.0 Gbps (SStatus 123 SControl F300)\n[    3.317438] ata1.00: ATA-8: ST31000528AS, CC38, max UDMA/133\n[    3.323129] ata1.00: 1953525168 sectors, multi 0: LBA48 NCQ (depth 31/32)\n[    3.387489] ata1.00: configured for UDMA/133\n[    3.392081] scsi 0:0:0:0: Direct-Access     ATA      ST31000528AS     CC38 PQ: 0\nANSI: 5\n[    3.907407] ata2: SATA link up 3.0 Gbps (SStatus 123 SControl F300)\n[    3.967439] ata2.00: ATA-8: WDC WD10EARS-00Y5B1, 80.00A80, max UDMA/133\n[    3.974086] ata2.00: 1953525168 sectors, multi 0: LBA48 NCQ (depth 31/32)\n[    4.017490] ata2.00: configured for UDMA/133\n[    4.022054] scsi 1:0:0:0: Direct-Access     ATA      WDC WD10EARS-00Y 80.0 PQ: 0\nANSI: 5\n[    4.064829] sd 0:0:0:0: [sda] 1953525168 512-byte logical blocks: (1.00 TB/931 GiB)\n[    4.072991] sd 1:0:0:0: [sdb] 1953525168 512-byte logical blocks: (1.00 TB/931 GiB)\n[    4.081812] sd 0:0:0:0: [sda] Write Protect is off\n[    4.086627] sd 0:0:0:0: [sda] Mode Sense: 00 3a 00 00\n[    4.086767] sd 1:0:0:0: [sdb] Write Protect is off\n[    4.091605] sd 1:0:0:0: [sdb] Mode Sense: 00 3a 00 00\n[    4.092046] sd 0:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn't\nsupport DPO or FUA\n[    4.101258] sd 1:0:0:0: [sdb] Write cache: enabled, read cache: enabled, doesn't\nsupport DPO or FUA\n[    4.111463]  sda:\n[    4.113315]  sdb: sdb1\n[    4.129921] sd 1:0:0:0: [sdb] Attached SCSI disk\n[    4.134641]  sda1\n[    4.138460] sd 0:0:0:0: [sda] Attached SCSI disk\n[    4.430995] md: raid1 personality registered for level 1\n[    4.451046] mdadm: sending ioctl 1261 to a partition!\n[    4.456128] mdadm: sending ioctl 1261 to a partition!\n[    4.461963] mdadm: sending ioctl 1261 to a partition!\n[    4.467045] mdadm: sending ioctl 1261 to a partition!\n[    4.496496] md: md0 stopped.\n[    4.500576] mdadm: sending ioctl 1261 to a partition!\n[    4.505657] mdadm: sending ioctl 1261 to a partition!\n[    4.513756] mdadm: sending ioctl 1261 to a partition!\n[    4.518867] mdadm: sending ioctl 1261 to a partition!\n[    4.533558] mdadm: sending ioctl 1261 to a partition!\n[    4.538683] mdadm: sending ioctl 1261 to a partition!\n[    4.552676] md: bind\u0026lt;sdb1\u0026gt;\n[    4.555706] md: bind\u0026lt;sda1\u0026gt;\n[    4.563216] raid1: raid set md0 active with 2 out of 2 mirrors\n[    4.569257] md0: detected capacity change from 0 to 1000201904128\n[    4.579552]  md0: unknown partition table\n[    4.819999] device-mapper: uevent: version 1.0.3\n[    4.826776] device-mapper: ioctl: 4.15.0-ioctl (2009-04-01) initialised:\ndm-devel@redhat.com\n[    5.447294] EXT4-fs (dm-0): INFO: recovery required on readonly filesystem\n[    5.454260] EXT4-fs (dm-0): write access will be enabled during recovery\n[    7.785537] EXT4-fs (dm-0): orphan cleanup on readonly fs\n[    7.791205] EXT4-fs (dm-0): ext4_orphan_cleanup: deleting unreferenced inode 31982811\n[    7.791437] EXT4-fs (dm-0): 1 orphan inode deleted\n[    7.796269] EXT4-fs (dm-0): recovery complete\n[    8.009557] EXT4-fs (dm-0): mounted filesystem with ordered data mode\n[    9.766690] udev[192]: starting version 164\n[   10.304695] input: gpio-keys as /devices/platform/gpio-keys/input/input0\n[   10.461444] ahci 0000:00:01.0: version 3.0\n[   10.477480] ahci 0000:00:01.0: AHCI 0001.0000 32 slots 2 ports 3 Gbps 0x3 impl SATA\nmode\n[   10.485622] ahci 0000:00:01.0: flags: 64bit ncq pm led clo pmp pio slum part \n[   10.494907] scsi2 : ahci\n[   10.498114] scsi3 : ahci\n[   10.501132] ata3: SATA max UDMA/133 abar m8192@0xe0010000 port 0xe0010100 irq 9\n[   10.508701] ata4: SATA max UDMA/133 abar m8192@0xe0010000 port 0xe0010180 irq 9\n[   10.634212] MV-643xx 10/100/1000 ethernet driver version 1.4\n[   10.640200] mv643xx_eth smi: probed\n[   10.659350] net eth0: port 0 with MAC address 00:08:9b:c4:46:d9\n[   10.735404] usbcore: Unknown symbol current_is_keventd\n[   10.741212] usbcore: Unknown symbol add_device_randomness\n[   10.765253] __ratelimit: 2 callbacks suppressed\n[   10.769850] mdadm: sending ioctl 1261 to a partition!\n[   10.774930] mdadm: sending ioctl 1261 to a partition!\n[   10.877491] ata3: SATA link down (SStatus 0 SControl 300)\n[   10.897445] ata4: SATA link down (SStatus 0 SControl 300)\n[   12.385717] mdadm: sending ioctl 1261 to a partition!\n[   12.471829] loop: module loaded\n[   12.524739] mdadm: sending ioctl 1261 to a partition!\n[   12.529898] mdadm: sending ioctl 1261 to a partition!\n[   13.105438] Adding 1499128k swap on /dev/mapper/blindio-swap.  Priority:-1 extents:1\nacross:1499128k \n[   15.671572] NET: Registered protocol family 10\n[   15.679566] ADDRCONF(NETDEV_UP): eth0: link is not ready\n[   18.255415] eth0: link up, 1000 Mb/s, full duplex, flow control disabled\n[   18.262430] ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready\n[   28.577394] eth0: no IPv6 routers present\n[   30.340013] VFS (dm-0): Writes happened before quota was turned on thus quota\ninformation is probably inconsistent. Please run quotacheck(8).\n[   30.458883] VFS (dm-0): Writes happened before quota was turned on thus quota\ninformation is probably inconsistent. Please run quotacheck(8).\n\n(Yes, this is all of it)\n\nLet me know if you need more information.\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 34,
	"closed_at": "2014-12-08T10:29:38Z",
	"created_at": "2013-05-14T20:06:17Z",
	"updated_at": "2016-06-24T22:40:03Z"
}
