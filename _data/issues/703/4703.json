{
	"id": 51282506,
	"number": 4703,
	"state": "closed",
	"title": " ssh/test: data race",
	"body": "\u003cpre\u003eWhat steps will reproduce the problem?\n\nrun ssh tests with -race\n\nWhat do you see instead?\n\n==================\nWARNING: DATA RACE\nWrite by goroutine 28:\n  os.(*file).close()\n      /build/go.tip/go/src/pkg/os/file_unix.go:110 +0x156\n  os.(*File).Close()\n      /build/go.tip/go/src/pkg/os/file_unix.go:99 +0x43\n  code.google.com/p/go.crypto/ssh/test.(*client).Close()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/doc.go:0 +0x48\n  code.google.com/p/go.crypto/ssh/test.TestFuncLargeRead()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/session_test.go:102 +0x575\n  testing.tRunner()\n      /build/go.tip/go/src/pkg/testing/testing.go:310 +0xe8\n\nPrevious read by goroutine 29:\n  os.(*File).write()\n      /build/go.tip/go/src/pkg/os/file_unix.go:188 +0x6c\n  os.(*File).Write()\n      /build/go.tip/go/src/pkg/os/file.go:139 +0xcf\n  code.google.com/p/go.crypto/ssh/test.(*client).Write()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/doc.go:0 +0x8e\n  bufio.(*Writer).Flush()\n      /build/go.tip/go/src/pkg/bufio/bufio.go:464 +0x161\n  code.google.com/p/go.crypto/ssh.(*writer).writePacket()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/transport.go:209 +0xc06\n  code.google.com/p/go.crypto/ssh.(*channel).sendClose()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/channel.go:107 +0xd4\n  code.google.com/p/go.crypto/ssh.(*clientChan).Close()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/channel.go:499 +0x16d\n  code.google.com/p/go.crypto/ssh.(*ClientConn).mainLoop()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/client.go:273 +0x18ca\n\nGoroutine 28 (running) created at:\n  testing.RunTests()\n      /build/go.tip/go/src/pkg/testing/testing.go:422 +0xc7d\n  testing.Main()\n      /build/go.tip/go/src/pkg/testing/testing.go:322 +0xcd\n  main.main()\n      code.google.com/p/go.crypto/ssh/test/_test/_testmain.go:75 +0xda\n  runtime.main()\n      /build/go.tip/go/src/pkg/runtime/proc.c:248 +0x91\n\nGoroutine 29 (running) created at:\n  code.google.com/p/go.crypto/ssh.Client()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/client.go:47 +0x2bd\n  code.google.com/p/go.crypto/ssh/test.(*server).Dial()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/test_unix_test.go:119 +0x5bf\n  code.google.com/p/go.crypto/ssh/test.TestFuncLargeRead()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/session_test.go:77 +0x8d\n  testing.tRunner()\n      /build/go.tip/go/src/pkg/testing/testing.go:310 +0xe8\n\n==================\n==================\nWARNING: DATA RACE\nWrite by goroutine 34:\n  os.(*file).close()\n      /build/go.tip/go/src/pkg/os/file_unix.go:110 +0x156\n  os.(*File).Close()\n      /build/go.tip/go/src/pkg/os/file_unix.go:99 +0x43\n  code.google.com/p/go.crypto/ssh/test.(*client).Close()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/doc.go:0 +0x48\n  code.google.com/p/go.crypto/ssh/test.TestValidTerminalMode()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/session_test.go:173 +0x9bc\n  testing.tRunner()\n      /build/go.tip/go/src/pkg/testing/testing.go:310 +0xe8\n\nPrevious read by goroutine 35:\n  os.(*File).write()\n      /build/go.tip/go/src/pkg/os/file_unix.go:188 +0x6c\n  os.(*File).Write()\n      /build/go.tip/go/src/pkg/os/file.go:139 +0xcf\n  code.google.com/p/go.crypto/ssh/test.(*client).Write()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/doc.go:0 +0x8e\n  bufio.(*Writer).Flush()\n      /build/go.tip/go/src/pkg/bufio/bufio.go:464 +0x161\n  code.google.com/p/go.crypto/ssh.(*writer).writePacket()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/transport.go:209 +0xc06\n  code.google.com/p/go.crypto/ssh.(*channel).sendClose()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/channel.go:107 +0xd4\n  code.google.com/p/go.crypto/ssh.(*clientChan).Close()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/channel.go:499 +0x16d\n  code.google.com/p/go.crypto/ssh.(*ClientConn).mainLoop()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/client.go:273 +0x18ca\n\nGoroutine 34 (running) created at:\n  testing.RunTests()\n      /build/go.tip/go/src/pkg/testing/testing.go:422 +0xc7d\n  testing.Main()\n      /build/go.tip/go/src/pkg/testing/testing.go:322 +0xcd\n  main.main()\n      code.google.com/p/go.crypto/ssh/test/_test/_testmain.go:75 +0xda\n  runtime.main()\n      /build/go.tip/go/src/pkg/runtime/proc.c:248 +0x91\n\nGoroutine 35 (running) created at:\n  code.google.com/p/go.crypto/ssh.Client()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/client.go:47 +0x2bd\n  code.google.com/p/go.crypto/ssh/test.(*server).Dial()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/test_unix_test.go:119 +0x5bf\n  code.google.com/p/go.crypto/ssh/test.TestValidTerminalMode()\n      /build/go.tip/go/src/pkg/code.google.com/p/go.crypto/ssh/test/session_test.go:126 +0xbe\n  testing.tRunner()\n      /build/go.tip/go/src/pkg/testing/testing.go:310 +0xe8\n\n==================\nPASS\nFound 2 data race(s)\nFAIL\tcode.google.com/p/go.crypto/ssh/test\t33.411s\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n\n6g\n\nWhich operating system are you using?\n\nlinux\n\nWhich version are you using?  (run 'go version')\n\ngo 76dc0d7cec07\ngo.crypto 7eef55bbd51c\n\nPlease provide any additional information below.\n\nmake sure PATH contains the directory where sshd is and that your shell isn't /bin/false\u003c/pre\u003e",
	"user": {
		"login": "alberts",
		"id": 409689,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 5,
	"closed_at": "2014-12-08T10:24:54Z",
	"created_at": "2013-01-24T15:53:07Z",
	"updated_at": "2016-06-24T22:31:44Z"
}
