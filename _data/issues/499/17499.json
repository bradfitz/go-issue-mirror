{
	"id": 183629057,
	"number": 17499,
	"state": "closed",
	"title": "x/crypto/poly1305: crash on ARM",
	"body": "Noticed a trybot flake on ARM:\r\n\r\nhttps://storage.googleapis.com/go-build-log/fbb1da3a/linux-arm_5dfc64f9.log\r\n```\r\nok  \tnet\t2.690s\r\nruntime: frame vendor/golang_org/x/crypto/poly1305.poly1305_auth_armv6 untyped locals 0x10c31a54+0x40\r\nfatal error: missing stackmap\r\n\r\nruntime stack:\r\nruntime.throw(0x3b4134, 0x10)\r\n\t/workdir/go/src/runtime/panic.go:587 +0x70\r\nruntime.scanframeworker(0x41486c04, 0x41486c78, 0x108193ac)\r\n\t/workdir/go/src/runtime/mgcmark.go:855 +0x56c\r\nruntime.scanstack.func1(0x41486c04, 0x0, 0x41486b01)\r\n\t/workdir/go/src/runtime/mgcmark.go:781 +0x54\r\nruntime.gentraceback(0xffffffff, 0x10c31a54, 0x0, 0x10b01860, 0x0, 0x0, 0x7fffffff, 0x41486d38, 0x0, 0x0, ...)\r\n\t/workdir/go/src/runtime/traceback.go:378 +0xe04\r\nruntime.scanstack(0x10b01860, 0x108193ac)\r\n\t/workdir/go/src/runtime/mgcmark.go:804 +0x1b0\r\nruntime.newstack()\r\n\t/workdir/go/src/runtime/stack.go:1035 +0x350\r\nruntime.morestack()\r\n\t/workdir/go/src/runtime/asm_arm.s:313 +0x5c\r\n\r\ngoroutine 5475 [select (scan)]:\r\nvendor/golang_org/x/crypto/poly1305.poly1305_auth_armv6(0x30, 0x30, 0x1d, 0x3fb)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/poly1305/sum_arm.s:367 +0x7c fp=0x10c31a94 sp=0x10c31a54\r\nvendor/golang_org/x/crypto/chacha20poly1305.(*chacha20poly1305).sealGeneric(0xd, 0xd, 0x10adc005, 0x1d, 0x3fb, 0x19fd60, 0x10a0c700, 0x10adc005, 0x0, 0x3fb, ...)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/chacha20poly1305/chacha20poly1305_generic.go:36 +0x350 fp=0x10c31b30 sp=0x10c31a94\r\ncreated by testing.(*T).Run\r\n\t/workdir/go/src/testing/testing.go:657 +0x238\r\n\r\ngoroutine 1 [chan receive]:\r\ntesting.(*T).Run(0x1080b080, 0x3b76c3, 0x15, 0x3d3164, 0x104201)\r\n\t/workdir/go/src/testing/testing.go:658 +0x258\r\ntesting.RunTests.func1(0x1080b080)\r\n\t/workdir/go/src/testing/testing.go:804 +0x54\r\ntesting.tRunner(0x1080b080, 0x10845f08)\r\n\t/workdir/go/src/testing/testing.go:621 +0x7c\r\ntesting.RunTests(0x3d2814, 0x5823e8, 0x191, 0x191, 0x10850070)\r\n\t/workdir/go/src/testing/testing.go:810 +0x24c\r\ntesting.(*M).Run(0x10830f7c, 0x3b7b8)\r\n\t/workdir/go/src/testing/testing.go:754 +0x70\r\nnet/http_test.TestMain(0x10845f74)\r\n\t/workdir/go/src/net/http/main_test.go:19 +0x1c\r\nmain.main()\r\n\tnet/http/_test/_testmain.go:904 +0xa0\r\n\r\ngoroutine 17 [syscall, locked to thread]:\r\nruntime.goexit()\r\n\t/workdir/go/src/runtime/asm_arm.s:996 +0x4\r\n\r\ngoroutine 2026 [chan receive]:\r\ntesting.(*T).Parallel(0x10a37800)\r\n\t/workdir/go/src/testing/testing.go:563 +0x118\r\nnet/http_test.setParallel(0x10a37800)\r\n\t/workdir/go/src/net/http/main_test.go:87 +0x34\r\nnet/http_test.TestServerTimeouts(0x10a37800)\r\n\t/workdir/go/src/net/http/serve_test.go:462 +0x20\r\ntesting.tRunner(0x10a37800, 0x3d3130)\r\n\t/workdir/go/src/testing/testing.go:621 +0x7c\r\ncreated by testing.(*T).Run\r\n\t/workdir/go/src/testing/testing.go:657 +0x238\r\n\r\ngoroutine 2182 [chan receive]:\r\ntesting.(*T).Parallel(0x10b0cd00)\r\n\t/workdir/go/src/testing/testing.go:563 +0x118\r\nnet/http_test.setParallel(0x10b0cd00)\r\n\t/workdir/go/src/net/http/main_test.go:87 +0x34\r\nnet/http_test.TestTLSHandshakeTimeout(0x10b0cd00)\r\n\t/workdir/go/src/net/http/serve_test.go:1026 +0x20\r\ntesting.tRunner(0x10b0cd00, 0x3d319c)\r\n\t/workdir/go/src/testing/testing.go:621 +0x7c\r\ncreated by testing.(*T).Run\r\n\t/workdir/go/src/testing/testing.go:657 +0x238\r\n\r\ngoroutine 5397 [IO wait]:\r\nnet.runtime_pollWait(0x41f12ab0, 0x72, 0x0)\r\n\t/workdir/go/src/runtime/netpoll.go:164 +0x44\r\nnet.(*pollDesc).wait(0x10920bbc, 0x72, 0x0, 0x10bde020)\r\n\t/workdir/go/src/net/fd_poll_runtime.go:75 +0x28\r\nnet.(*pollDesc).waitRead(0x10920bbc, 0xffffffff, 0x0)\r\n\t/workdir/go/src/net/fd_poll_runtime.go:80 +0x24\r\nnet.(*netFD).accept(0x10920b80, 0x0, 0x552658, 0x10bde020)\r\n\t/workdir/go/src/net/fd_unix.go:422 +0x15c\r\nnet.(*TCPListener).accept(0x10a02998, 0x584978, 0x40147258, 0x0)\r\n\t/workdir/go/src/net/tcpsock_posix.go:132 +0x20\r\nnet.(*TCPListener).Accept(0x10a02998, 0x10a2af48, 0x24faf8, 0x10a2af68, 0x60a38)\r\n\t/workdir/go/src/net/tcpsock.go:225 +0x3c\r\ncrypto/tls.(*listener).Accept(0x10a09190, 0x3d2940, 0x10bf8000, 0x555140, 0x109dc020)\r\n\t/workdir/go/src/crypto/tls/tls.go:52 +0x28\r\nnet/http.(*Server).Serve(0x109d08c0, 0x554798, 0x10a09190, 0x0, 0x0)\r\n\t/workdir/go/src/net/http/server.go:2345 +0x154\r\nnet/http/httptest.(*Server).goServe.func1(0x10920bc0)\r\n\t/workdir/go/src/net/http/httptest/server.go:236 +0x5c\r\ncreated by net/http/httptest.(*Server).goServe\r\n\t/workdir/go/src/net/http/httptest/server.go:237 +0x48\r\n\r\ngoroutine 5593 [runnable]:\r\nvendor/golang_org/x/crypto/chacha20poly1305.(*chacha20poly1305).sealGeneric(0x109dc780, 0x1096a005, 0x0, 0x1ffb, 0x109dc7a0, 0xc, 0xc, 0x1096a005, 0x1009, 0x1ffb, ...)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/chacha20poly1305/chacha20poly1305_generic.go:29 +0x188\r\nvendor/golang_org/x/crypto/chacha20poly1305.(*chacha20poly1305).seal(0x109dc780, 0x1096a005, 0x0, 0x1ffb, 0x109dc7a0, 0xc, 0xc, 0x1096a005, 0x1009, 0x1ffb, ...)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/chacha20poly1305/chacha20poly1305_noasm.go:10 +0x7c\r\nvendor/golang_org/x/crypto/chacha20poly1305.(*chacha20poly1305).Seal(0x109dc780, 0x1096a005, 0x0, 0x1ffb, 0x109dc7a0, 0xc, 0xc, 0x1096a005, 0x1009, 0x1ffb, ...)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/chacha20poly1305/chacha20poly1305.go:51 +0xc0\r\ncrypto/tls.(*xorNonceAEAD).Seal(0x109dc7a0, 0x1096a005, 0x0, 0x1ffb, 0x10998120, 0x8, 0x8, 0x1096a005, 0x1009, 0x1ffb, ...)\r\n\t/workdir/go/src/crypto/tls/cipher_suites.go:198 +0xcc\r\ncrypto/tls.(*halfConn).encrypt(0x109980fc, 0x109dc1a0, 0x0, 0x4000)\r\n\t/workdir/go/src/crypto/tls/conn.go:413 +0x4b0\r\ncrypto/tls.(*Conn).writeRecordLocked(0x10998000, 0x3d3717, 0x10873300, 0x1009, 0x1300, 0x0, 0x0, 0x0)\r\n\t/workdir/go/src/crypto/tls/conn.go:901 +0x278\r\ncrypto/tls.(*Conn).Write(0x10998000, 0x10873300, 0x1009, 0x1300, 0x0, 0x0, 0x0)\r\n\t/workdir/go/src/crypto/tls/conn.go:1054 +0x160\r\nbufio.(*Writer).Write(0x109482a0, 0x10873300, 0x1009, 0x1300, 0x10998000, 0x3d3717, 0x108b1000)\r\n\t/workdir/go/src/bufio/bufio.go:590 +0x140\r\nnet/http.(*http2bufferedWriter).Write(0x10bde1a0, 0x10873300, 0x1009, 0x1300, 0x10c41030, 0x1, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:2618 +0x44\r\nnet/http.(*http2Framer).endWrite(0x10862d90, 0x0, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:899 +0x8c\r\nnet/http.(*http2Framer).WriteDataPadded(0x10862d90, 0x11, 0x0, 0x10a32000, 0x1000, 0x1000, 0x0, 0x0, 0x0, 0x5e33c, ...)\r\n\t/workdir/go/src/net/http/h2_bundle.go:1177 +0x1f4\r\nnet/http.(*http2Framer).WriteData(0x10862d90, 0x11, 0x34e300, 0x10a32000, 0x1000, 0x1000, 0x22a4a0, 0x10a02501)\r\n\t/workdir/go/src/net/http/h2_bundle.go:1146 +0x58\r\nnet/http.(*http2writeData).writeFrame(0x109489c0, 0x555230, 0x10a30140, 0x0, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:6928 +0x5c\r\nnet/http.(*http2serverConn).writeFrameAsync(0x10a30140, 0x552418, 0x109489c0, 0x10b92380, 0x109206c0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:3369 +0x34\r\ncreated by net/http.(*http2serverConn).startFrameWrite\r\n\t/workdir/go/src/net/http/h2_bundle.go:3611 +0x16c\r\n\r\ngoroutine 5443 [select]:\r\nnet/http.(*http2serverConn).serve(0x10a30140)\r\n\t/workdir/go/src/net/http/h2_bundle.go:3437 +0x570\r\nnet/http.(*http2Server).ServeConn(0x109f5a00, 0x555ed0, 0x10998000, 0x10c33e2c)\r\n\t/workdir/go/src/net/http/h2_bundle.go:3102 +0x5ec\r\nnet/http.http2ConfigureServer.func1(0x109d08c0, 0x10998000, 0x552d78, 0x109be048)\r\n\t/workdir/go/src/net/http/h2_bundle.go:2989 +0x70\r\nnet/http.(*conn).serve(0x10bf8000, 0x555140, 0x109dc020)\r\n\t/workdir/go/src/net/http/server.go:1622 +0xbd0\r\ncreated by net/http.(*Server).Serve\r\n\t/workdir/go/src/net/http/server.go:2365 +0x394\r\n\r\ngoroutine 5400 [runnable]:\r\nnet.runtime_pollWait(0x41cd8638, 0x72, 0x10ad0800)\r\n\t/workdir/go/src/runtime/netpoll.go:164 +0x44\r\nnet.(*pollDesc).wait(0x10c4003c, 0x72, 0x553120, 0x5511e4)\r\n\t/workdir/go/src/net/fd_poll_runtime.go:75 +0x28\r\nnet.(*pollDesc).waitRead(0x10c4003c, 0x10ad0800, 0x400)\r\n\t/workdir/go/src/net/fd_poll_runtime.go:80 +0x24\r\nnet.(*netFD).Read(0x10c40000, 0x10ad0800, 0x400, 0x400, 0x0, 0x553120, 0x5511e4)\r\n\t/workdir/go/src/net/fd_unix.go:246 +0x124\r\nnet.(*conn).Read(0x109be008, 0x10ad0800, 0x400, 0x400, 0x0, 0x0, 0x0)\r\n\t/workdir/go/src/net/net.go:176 +0x58\r\ncrypto/tls.(*block).readFromUntil(0x109dc4c0, 0x41cd8a18, 0x109be008, 0x5, 0x109be008, 0x0)\r\n\t/workdir/go/src/crypto/tls/conn.go:481 +0x78\r\ncrypto/tls.(*Conn).readRecord(0x10998000, 0x3d3717, 0x10998094, 0x0)\r\n\t/workdir/go/src/crypto/tls/conn.go:583 +0x88\r\ncrypto/tls.(*Conn).Read(0x10998000, 0x10862db0, 0x9, 0x9, 0x0, 0x0, 0x0)\r\n\t/workdir/go/src/crypto/tls/conn.go:1120 +0xd4\r\nio.ReadAtLeast(0x551fb0, 0x10998000, 0x10862db0, 0x9, 0x9, 0x9, 0x0, 0x109f4670, 0x109f460c)\r\n\t/workdir/go/src/io/io.go:307 +0x8c\r\nio.ReadFull(0x551fb0, 0x10998000, 0x10862db0, 0x9, 0x9, 0x10a06e10, 0x0, 0x0)\r\n\t/workdir/go/src/io/io.go:325 +0x40\r\nnet/http.http2readFrameHeader(0x10862db0, 0x9, 0x9, 0x551fb0, 0x10998000, 0x0, 0x0, 0x0, 0x0, 0x10836f40)\r\n\t/workdir/go/src/net/http/h2_bundle.go:781 +0x50\r\nnet/http.(*http2Framer).ReadFrame(0x10862d90, 0x10c41180, 0x0, 0x1, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:1003 +0x60\r\nnet/http.(*http2serverConn).readFrames(0x10a30140)\r\n\t/workdir/go/src/net/http/h2_bundle.go:3341 +0x84\r\ncreated by net/http.(*http2serverConn).serve\r\n\t/workdir/go/src/net/http/h2_bundle.go:3431 +0x240\r\n\r\ngoroutine 5521 [select]:\r\nnet/http.(*http2serverConn).writeDataFromHandler(0x10a30140, 0x10b92380, 0x10a32000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:3518 +0x278\r\nnet/http.(*http2responseWriterState).writeChunk(0x10886370, 0x10a32000, 0x1000, 0x1000, 0x1000, 0x0, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:4637 +0x3e0\r\nnet/http.http2chunkWriter.Write(0x10886370, 0x10a32000, 0x1000, 0x1000, 0x1000, 0x0, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:4546 +0x34\r\nbufio.(*Writer).Flush(0x10948460, 0x10c83000, 0x1000)\r\n\t/workdir/go/src/bufio/bufio.go:558 +0x60\r\nbufio.(*Writer).WriteString(0x10948460, 0x10c83000, 0x5c000, 0x80001, 0x41d10000, 0x0)\r\n\t/workdir/go/src/bufio/bufio.go:661 +0xd0\r\nnet/http.(*http2responseWriter).write(0x10a02558, 0x80000, 0x0, 0x0, 0x0, 0x10c60000, 0x80000, 0x398f20, 0x80001, 0x41f05a38)\r\n\t/workdir/go/src/net/http/h2_bundle.go:4817 +0x13c\r\nnet/http.(*http2responseWriter).WriteString(0x10a02558, 0x10c60000, 0x80000, 0x10a2062c, 0x308701, 0x369a78)\r\n\t/workdir/go/src/net/http/h2_bundle.go:4793 +0x44\r\nio.WriteString(0x41d10000, 0x10a02558, 0x10c60000, 0x80000, 0x10a02558, 0x10921900, 0x22b408)\r\n\t/workdir/go/src/io/io.go:289 +0x70\r\nnet/http_test.testSniffWriteSize.func1(0x554898, 0x10a02558, 0x1093ad00)\r\n\t/workdir/go/src/net/http/sniff_test.go:166 +0xb8\r\nnet/http.HandlerFunc.ServeHTTP(0x10a02988, 0x554898, 0x10a02558, 0x1093ad00)\r\n\t/workdir/go/src/net/http/server.go:1800 +0x34\r\nnet/http.serverHandler.ServeHTTP(0x109d08c0, 0x554898, 0x10a02558, 0x1093ad00)\r\n\t/workdir/go/src/net/http/server.go:2276 +0x7c\r\nnet/http.initNPNRequest.ServeHTTP(0x10998000, 0x109d08c0, 0x554898, 0x10a02558, 0x1093ad00)\r\n\t/workdir/go/src/net/http/server.go:2742 +0x5c\r\nnet/http.(*initNPNRequest).ServeHTTP(0x109be048, 0x554898, 0x10a02558, 0x1093ad00)\r\n\t\u003cautogenerated\u003e:286 +0x6c\r\nnet/http.(Handler).ServeHTTP-fm(0x554898, 0x10a02558, 0x1093ad00)\r\n\t/workdir/go/src/net/http/h2_bundle.go:4113 +0x3c\r\nnet/http.(*http2serverConn).runHandler(0x10a30140, 0x10a02558, 0x1093ad00, 0x109f4680)\r\n\t/workdir/go/src/net/http/h2_bundle.go:4347 +0x70\r\ncreated by net/http.(*http2serverConn).processHeaders\r\n\t/workdir/go/src/net/http/h2_bundle.go:4125 +0x4f8\r\n\r\ngoroutine 5477 [runnable]:\r\nvendor/golang_org/x/crypto/chacha20poly1305.(*chacha20poly1305).openGeneric(0x10a0c740, 0x10bc0005, 0x0, 0x1ffb, 0x10a0c760, 0xc, 0xc, 0x10bc0005, 0x1019, 0x1ffb, ...)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/chacha20poly1305/chacha20poly1305_generic.go:53 +0x170\r\nvendor/golang_org/x/crypto/chacha20poly1305.(*chacha20poly1305).open(0x10a0c740, 0x10bc0005, 0x0, 0x1ffb, 0x10a0c760, 0xc, 0xc, 0x10bc0005, 0x1019, 0x1ffb, ...)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/chacha20poly1305/chacha20poly1305_noasm.go:14 +0x7c\r\nvendor/golang_org/x/crypto/chacha20poly1305.(*chacha20poly1305).Open(0x10a0c740, 0x10bc0005, 0x0, 0x1ffb, 0x10a0c760, 0xc, 0xc, 0x10bc0005, 0x1019, 0x1ffb, ...)\r\n\t/workdir/go/src/vendor/golang_org/x/crypto/chacha20poly1305/chacha20poly1305.go:67 +0xc8\r\ncrypto/tls.(*xorNonceAEAD).Open(0x10a0c760, 0x10bc0005, 0x0, 0x1ffb, 0x10ffc0b8, 0x8, 0x8, 0x10bc0005, 0x1019, 0x1ffb, ...)\r\n\t/workdir/go/src/crypto/tls/cipher_suites.go:210 +0xcc\r\ncrypto/tls.(*halfConn).decrypt(0x10ffc094, 0x10a0c020, 0x101e, 0x10a0c020, 0x10948240)\r\n\t/workdir/go/src/crypto/tls/conn.go:299 +0x588\r\ncrypto/tls.(*Conn).readRecord(0x10ffc000, 0x3d3717, 0x10ffc094, 0x589714)\r\n\t/workdir/go/src/crypto/tls/conn.go:640 +0x204\r\ncrypto/tls.(*Conn).Read(0x10ffc000, 0x10af1000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\r\n\t/workdir/go/src/crypto/tls/conn.go:1120 +0xd4\r\nbufio.(*Reader).fill(0x109a1260)\r\n\t/workdir/go/src/bufio/bufio.go:97 +0xf4\r\nbufio.(*Reader).Read(0x109a1260, 0x10bdcbf0, 0x9, 0x9, 0x10826500, 0x5e4dc, 0x10826500)\r\n\t/workdir/go/src/bufio/bufio.go:209 +0x15c\r\nio.ReadAtLeast(0x551e90, 0x109a1260, 0x10bdcbf0, 0x9, 0x9, 0x9, 0x10949540, 0x20258, 0x202ec)\r\n\t/workdir/go/src/io/io.go:307 +0x8c\r\nio.ReadFull(0x551e90, 0x109a1260, 0x10bdcbf0, 0x9, 0x9, 0x0, 0x10818aa4, 0x10818aa4)\r\n\t/workdir/go/src/io/io.go:325 +0x40\r\nnet/http.http2readFrameHeader(0x10bdcbf0, 0x9, 0x9, 0x551e90, 0x109a1260, 0x0, 0x0, 0x0, 0x10953000, 0x1000)\r\n\t/workdir/go/src/net/http/h2_bundle.go:781 +0x50\r\nnet/http.(*http2Framer).ReadFrame(0x10bdcbd0, 0x109dcde0, 0x0, 0x0, 0x0)\r\n\t/workdir/go/src/net/http/h2_bundle.go:1003 +0x60\r\nnet/http.(*http2clientConnReadLoop).run(0x10833fc0, 0x3d295c, 0x10a2d7c8)\r\n\t/workdir/go/src/net/http/h2_bundle.go:6107 +0x60\r\nnet/http.(*http2ClientConn).readLoop(0x10b7c000)\r\n\t/workdir/go/src/net/http/h2_bundle.go:6036 +0x8c\r\ncreated by net/http.(*http2Transport).newClientConn\r\n\t/workdir/go/src/net/http/h2_bundle.go:5360 +0x5a0\r\nFAIL\tnet/http\t17.660s\r\n2016/10/18 08:47:41 Failed: exit status 1\r\n\r\n\r\nError: tests failed: dist test failed: go_test:net/http: exit status 1\r\n```",
	"user": {
		"login": "bradfitz",
		"id": 2621,
		"type": "User",
		"site_admin": false
	},
	"assignee": {
		"login": "agl",
		"id": 21203,
		"type": "User",
		"site_admin": false
	},
	"comments": 13,
	"closed_at": "2016-10-20T16:32:11Z",
	"created_at": "2016-10-18T09:05:45Z",
	"updated_at": "2016-10-20T16:40:37Z",
	"milestone": {
		"id": 1709363,
		"number": 38,
		"title": "Go1.8"
	}
}
