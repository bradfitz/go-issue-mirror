{
	"id": 51289124,
	"number": 9123,
	"state": "closed",
	"title": "runtime: general runtime slowdown from 1.3 to 1.4 to 1.5",
	"body": "by **dippo6905**:\n\n\u003cpre\u003eI tested release 1.4rc1 and i noticed very slow performance compared to version 1.3. The\ncode runs almost twice as slow compared to version 1.3. The only thing i noticed is that\nwhen a Go routine is started the performance drops, even when a Go routine almost\ncontains nothing, it still drops.\n\nThis is the code i was currently working on :\n\npackage main\n\nimport (\n\t\u0026quot;fmt\u0026quot;\n\t\u0026quot;time\u0026quot;\n)\n\nfunc main() {\n\tstart := time.Now()\n\tinput := make(chan int)\n\toutput := input\n\terr := make(chan bool)\n\terrormsg := make(chan error)\n\tgo func(c chan int) { c \u0026lt;- 1 }(input)\n\tfor {\n\t\tgo func(input \u0026lt;-chan int, output chan\u0026lt;- int, err chan\u0026lt;- bool, errormsg chan\u0026lt;- error) {\n\t\t\terr \u0026lt;- false\n\t\t\tvalue := \u0026lt;-input\n\t\t\tvalue++\n\t\t\toutput \u0026lt;- value\n\t\t\tif value == 100000 {\n\t\t\t\terr \u0026lt;- true\n\t\t\t\terrormsg \u0026lt;- fmt.Errorf(\u0026quot;An error arise with output containing : %v\u0026quot;, value)\n\t\t\t}\n\t\t}(input, output, err, errormsg)\n\t\tif \u0026lt;-err {\n\t\t\tbreak\n\t\t}\n\t\tinput = output\n\t}\n\te := \u0026lt;-errormsg\n\tif e != nil {\n\t\tfmt.Println(e)\n\t}\n\tfmt.Printf(\u0026quot;Took %v to run.\\n\u0026quot;, time.Since(start))\n}\n\nThis code is just a toy to test what Go is good at, concurrent programming and channels.\nThis example is just a \u0026quot;over the top\u0026quot; daisychain of channels, based on the\nwork of Rob Pike. It's simply a counter that puts in number into a channel (input),\nincrease it with one and put this into a different channel (output). The Go routine must\ncheck if a value have been reached (100.000) and if that have been reached, a error must\nsend in a different channel. \n\nThis is the performance on 1.3 :\n\npath is set to :\nPATH=C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;c:\\program files\\nvidia gpu\ncomputing toolkit\\cuda\\v3.2\\bi\nn\\;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\system32\\wbem;C:\\Windows\\system32\\windowspowershell\\v1.0\\;c:\\program\nfile\ns (x86)\\microsoft asp.net\\asp.net web pages\\v1.0\\;c:\\program files (x86)\\common\nfiles\\adobe\\agl;c:\\program files\\ibm\\g\nsk8\\lib;C:\\PROGRA~1\\IBM\\DB2\\BIN;C:\\PROGRA~1\\IBM\\DB2\\FUNCTION;C:\\PROGRA~1\\IBM\\DB2\\SAMPLES\\REPL;C:\\Program\nFiles (x86)\\G\nit\\cmd;C:\\TDM-GCC-64\\bin;C:\\Android\\android-sdk\\tools;C:\\Android\\android-sdk;C:\\Android\\android-sdk\\platform-tools;C:\\\nGo\\bin\n\nGOROOT is set to :\nGOROOT=C:\\Go\\\n\nGOPATH is set to :\nGOPATH=C:\\Users\\Dippo\\Dropbox\\GO\n\nGO version is set to :\ngo version go1.3 windows/amd64\n\nMicrosoft Windows [versie 6.1.7601]\nCopyright (c) 2009 Microsoft Corporation. Alle rechten voorbehouden.\n\nC:\\Users\\Dippo\\Dropbox\\GO\u0026gt;cd io\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 93.0053ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 93.0053ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 92.0053ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 94.0054ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 94.0054ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 94.0053ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 94.0053ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 93.0053ms to run.\n\nThis is the performance on 1.4rc1 :\n\npath is set to :\nPATH=C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;c:\\program files\\nvidia gpu\ncomputing toolkit\\cuda\\v3.2\\bi\nn\\;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\system32\\wbem;C:\\Windows\\system32\\windowspowershell\\v1.0\\;c:\\program\nfile\ns (x86)\\microsoft asp.net\\asp.net web pages\\v1.0\\;c:\\program files (x86)\\common\nfiles\\adobe\\agl;c:\\program files\\ibm\\g\nsk8\\lib;C:\\PROGRA~1\\IBM\\DB2\\BIN;C:\\PROGRA~1\\IBM\\DB2\\FUNCTION;C:\\PROGRA~1\\IBM\\DB2\\SAMPLES\\REPL;C:\\Program\nFiles (x86)\\G\nit\\cmd;C:\\TDM-GCC-64\\bin;C:\\Android\\android-sdk\\tools;C:\\Android\\android-sdk;C:\\Android\\android-sdk\\platform-tools;C:\\\nGo1.4rc1\\bin\n\nGOROOT is set to :\nGOROOT=C:\\Go1.4rc1\\\n\nGOPATH is set to :\nGOPATH=C:\\Users\\Dippo\\Dropbox\\GO\n\nGO version is set to :\ngo version go1.4rc1 windows/amd64\n\nMicrosoft Windows [versie 6.1.7601]\nCopyright (c) 2009 Microsoft Corporation. Alle rechten voorbehouden.\n\nC:\\Users\\Dippo\\Dropbox\\GO\u0026gt;cd io\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 176.01ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 181.0103ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 178.0102ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 176.0101ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 177.0101ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 175.0101ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 176.0101ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 178.0102ms to run.\n\nC:\\Users\\Dippo\\Dropbox\\GO\\io\u0026gt;go run daisychain3.go\nAn error arise with output containing : 100000\nTook 176.0101ms to run.\n\nGood luck with this one. :) And keep up the good work! You are the best!\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "Performance"
		}
	],
	"comments": 17,
	"closed_at": "2016-05-06T00:27:58Z",
	"created_at": "2014-11-18T11:37:14Z",
	"updated_at": "2016-05-06T00:27:58Z",
	"milestone": {
		"id": 1414136,
		"number": 32,
		"title": "Go1.7Early"
	}
}
