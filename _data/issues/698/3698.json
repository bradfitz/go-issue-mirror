{
	"id": 51281014,
	"number": 3698,
	"state": "closed",
	"title": "gccgo runtime.NumCPU() issue  on Sparc solaris 10",
	"body": "\u003cpre\u003eWhat steps will reproduce the problem?\nIf possible, include a link to a program on play.golang.org.\n1. install CSW gcc-4.7.0 on a Sparc Solaris 10 machine.\n2. compile runtime.go to display CPU numbers.\n\npackage main\n\nimport (\n \u0026quot;fmt\u0026quot;\n \u0026quot;runtime\u0026quot;\n)\n\nfunc main() {\n        fmt.Printf(\u0026quot;CPU Numbers: %d \\n\u0026quot;,runtime.NumCPU())\n}\n\n3.\n\nWhat is the expected output?\n\nCorrect output from a ubuntu 12.04 machine.\nrelease@inspiron531:~/gocode/src/regular-expression$ ./runtime\nCPU Numbers: 2\nrelease@inspiron531:~/gocode/src/regular-expression$\n\nWhat do you see instead?\n\nbash-3.00$ ls -lrt\ntotal 44\n-rw-r--r--   1 hobbits  hobbits      118 Jun  3 16:52 runtime.go\n-rwxr-xr-x   1 hobbits  hobbits    20880 Jun  3 16:53 runtime\nbash-3.00$ ./runtime\nCPU Numbers: 0\nbash-3.00$ cat runtime.go\npackage main\n\nimport (\n \u0026quot;fmt\u0026quot;\n \u0026quot;runtime\u0026quot;\n)\n\nfunc main() {\n        fmt.Printf(\u0026quot;CPU Numbers: %d \\n\u0026quot;,runtime.NumCPU())\n}\nbash-3.00$\n\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\ngccgo\n\n\n\nWhich operating system are you using?\n\nbash-3.00$ uname -a\nSunOS testmachine  5.10 Generic_142909-17 sun4v sparc SUNW,SPARC-Enterprise-T5120\nbash-3.00$\n\nWhich version are you using?  (run 'go version')\n\nbash-3.00$ /opt/csw/bin/gccgo -v\nReading specs from /opt/csw/lib/gcc/sparc-sun-solaris2.10/4.7.0/specs\nCOLLECT_GCC=/opt/csw/bin/gccgo\nCOLLECT_LTO_WRAPPER=/opt/csw/libexec/gcc/sparc-sun-solaris2.10/4.7.0/lto-wrapper\nTarget: sparc-sun-solaris2.10\nConfigured with:\n/home/maciej/src/opencsw/pkg/gcc4/trunk/work/solaris10-sparc/build-isa-sparcv8plus/gcc-4.7.0/configure\n--program-s\\\nuffix=-4.7 --prefix=/opt/csw --exec_prefix=/opt/csw --bindir=/opt/csw/bin\n--sbindir=/opt/csw/sbin --libexecdir=/opt/csw/libexec --d\\\natadir=/opt/csw/share --sysconfdir=/etc/opt/csw --sharedstatedir=/opt/csw/share\n--localstatedir=/var/opt/csw --libdir=/opt/csw/lib \\\n--infodir=/opt/csw/share/info --includedir=/opt/csw/include --mandir=/opt/csw/share/man\n--with-gnu-as --with-as=/opt/csw/bin/gas --\\\nwithout-gnu-ld --with-ld=/usr/ccs/bin/ld --enable-nls --with-included-gettext\n--with-libiconv-prefix=/opt/csw --with-x --with-mpfr=\\\n/opt/csw --with-gmp=/opt/csw --with-ppl=/opt/csw --with-cloog=/opt/csw\n--enable-cloog-backend=isl --enable-java-awt=xlib --enable-l\\\nibada --enable-libssp --enable-objc-gc --enable-threads=posix\n--enable-languages=ada,c,c++,fortran,go,java,objc --with-system-zlib=\\\n/opt/csw --with-cpu=v9\nThread model: posix\ngcc version 4.7.0 (GCC)\nbash-3.00$\n\n\nPlease provide any additional information below.\nThis system has 32 CPUs.\nbash-3.00$ mpstat\nCPU minf mjf xcal  intr ithr  csw icsw migr smtx  srw syscl  usr sys  wt idl\n  0   14   0  642   227    6   51    0    4    7    0   154    1   1   0  99\n  1   20   0 1372    79   15  112    0   10   15    0   362    2   1   0  97\n  2    3   0  235    19    1   24    0    3    5    0    57    0   0   0  99\n  3    3   0  185    14    1   18    0    2    4    0    42    0   0   0 100\n  4   10   0  615    39    6   52    0    5    7    0   144    1   0   0  99\n  5   20   0 1381    80   16  114    0   10   15    0   367    2   1   0  97\n  6    3   0  243    22    3   24    0    3    5    0    57    0   0   0  99\n  7    3   0  204    14    1   18    0    2    4    0    43    0   0   0 100\n  8    6   0  139     8    1   12    0    2    3    0    41    0   0   0 100\n  9    9   0  604    38    6   53    0    4    7    0   176    1   1   0  99\n 10   20   0 1275    81   16  115    0   10   15    0   351    1   1   0  98\n 11    3   0  187    15    1   19    0    3    4    0    46    0   0   0 100\n 12    3   0  142     8    1   12    0    2    3    0    35    0   0   0 100\n 13    9   0  605    38    5   53    0    5    7    0   176    1   1   0  99\n 14   21   0 1292    80   16  116    0   10   16    0   362    2   1   0  97\n 15    3   0  191    15    1   19    0    3    4    0    46    0   0   0 100\n 16    3   0  146    10    1   16    0    2    4    0    55    0   0   0 100\n 17    1   0  114     8    1   12    0    2    3    0    40    0   0   0 100\n 18    7   0  483    34    5   48    0    4    7    0   152    1   0   0  99\n 19   21   0 1288    81   16  118    0   10   16    0   381    2   1   0  97\n 20    6   0  282    18    2   22    0    3    5    0    82    0   0   0  99\n 21    1   0  100     7    1   11    0    2    3    0    36    0   0   0 100\n 22    7   0  464    33    5   47    0    4    7    0   148    1   0   0  99\n 23   21   0 1349    81   16  118    0   10   16    0   379    2   1   0  97\n 24   36   0 1577   156   16  227    1    7   12    0   276    1   1   0  98\n 25    3   0  379   211  195   21    0    3    5    0    38    0   1   0  99\n 26    2   0  215   108   24  138    0    1    5    0    22    0   0   0  99\n 27    6   0  625    30    4   42    0    4    7    0   108    0   0   0  99\n 28   23   0 1682    78   15  112    0   11   16    0   310    1   1   0  98\n 29    3   0  271    15    1   20    0    3    5    0    42    0   0   0 100\n 30    3   0  313    11    4   12    0    2    4    0    31    0   0   0 100\n 31    7   0  691    32    5   45    0    4    7    0   118    0   0   0  99\nbash-3.00$ \n\ngccgo-4.7.0 is using go 1.0 runtime code, Hopefully this issue is fixed at Ian's gccgo\n1.0.1 runtime patch scheduled to be included in 4.7.1.\u003c/pre\u003e",
	"user": {
		"login": "tjyang",
		"id": 378638,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 8,
	"closed_at": "2014-12-08T10:19:32Z",
	"created_at": "2012-06-03T22:09:21Z",
	"updated_at": "2016-06-24T22:19:56Z"
}
