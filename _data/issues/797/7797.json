{
	"id": 51287223,
	"number": 7797,
	"state": "open",
	"title": "x/crypto/ssh: TestHandshakeBasic times out on Plan 9",
	"body": "\u003cpre\u003eWhat steps will reproduce the problem?\n\n% cd ssh\n% go test -run TestHandshakeBasic\n\nWhat is the expected output? What do you see instead?\n\nThe test is timing out because io.ReadFull in cipher.go:137 (called from\nhandshake_test.go:110) never returns.\n\ncpu% go test -v -timeout 30s -run TestHandshakeBasic\n=== RUN TestHandshakeBasic\npanic: test timed out after 30s\n\ngoroutine 25 [running]:\nruntime.panic(0x212240, 0x10570388)\n\t/usr/go/src/pkg/runtime/panic.c:279 +0xe3\ntesting.funcÂ·008()\n\t/usr/go/src/pkg/testing/testing.go:628 +0xd7\ncreated by time.goFunc\n\t/usr/go/src/pkg/time/sleep.go:121 +0x49\n\ngoroutine 16 [chan receive]:\ntesting.RunTests(0x320934, 0x413240, 0x57, 0x57, 0x21d01)\n\t/usr/go/src/pkg/testing/testing.go:504 +0x74a\ntesting.Main(0x320934, 0x413240, 0x57, 0x57, 0x410a80, 0x5, 0x5, 0x41abc0, 0x0, 0x0)\n\t/usr/go/src/pkg/testing/testing.go:435 +0x6d\nmain.main()\n\tcode.google.com/p/go.crypto/ssh/_test/_testmain.go:229 +0x85\n\ngoroutine 19 [finalizer wait]:\nruntime.park(0x120d0, 0x415618, 0x4141a9)\n\t/usr/go/src/pkg/runtime/proc.c:1354 +0x8f\nruntime.parkunlock(0x415618, 0x4141a9)\n\t/usr/go/src/pkg/runtime/proc.c:1370 +0x3e\nrunfinq()\n\t/usr/go/src/pkg/runtime/mgc0.c:2624 +0xc3\nruntime.goexit()\n\t/usr/go/src/pkg/runtime/proc.c:1430\n\ngoroutine 21 [chan receive]:\ncode.google.com/p/go.crypto/ssh.TestHandshakeBasic(0x10589260)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/handshake_test.go:110 +0x27c\ntesting.tRunner(0x10589260, 0x41333c)\n\t/usr/go/src/pkg/testing/testing.go:422 +0x86\ncreated by testing.RunTests\n\t/usr/go/src/pkg/testing/testing.go:503 +0x70e\n\ngoroutine 22 [syscall]:\nsyscall.Syscall6(0x7, 0x10549000, 0x1000, 0xffffffff, 0xffffffff, 0x0, 0x0, 0x0,\n0x13658639, 0x3b9aca00, ...)\n\t/usr/go/src/pkg/syscall/asm_plan9_386.s:54 +0x5\nsyscall.Pread(0x7, 0x10549000, 0x1000, 0x1000, 0xffffffff, 0xffffffff, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/syscall/zsyscall_plan9_386.go:118 +0x8f\nsyscall.Read(0x7, 0x10549000, 0x1000, 0x1000, 0x3074fbcc, 0x0, 0x0)\n\t/usr/go/src/pkg/syscall/syscall_plan9.go:123 +0x75\nos.(*File).read(0x10570528, 0x10549000, 0x1000, 0x1000, 0x178ba1, 0x0, 0x0)\n\t/usr/go/src/pkg/os/file_plan9.go:247 +0x6a\nos.(*File).Read(0x10570528, 0x10549000, 0x1000, 0x1000, 0x7, 0x0, 0x0)\n\t/usr/go/src/pkg/os/file.go:95 +0x8b\nnet.(*netFD).Read(0x105b04c0, 0x10549000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/net/fd_plan9.go:134 +0xfa\nnet.(*conn).Read(0x10570538, 0x10549000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/net/net.go:122 +0x8f\nbufio.(*Reader).fill(0x105d8f00)\n\t/usr/go/src/pkg/bufio/bufio.go:97 +0x14d\nbufio.(*Reader).Read(0x105d8f00, 0x10616250, 0x5, 0x5, 0x5, 0x0, 0x0)\n\t/usr/go/src/pkg/bufio/bufio.go:175 +0x193\nio.ReadAtLeast(0x3053e908, 0x105d8f00, 0x10616250, 0x5, 0x5, 0x5, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/io/io.go:289 +0xca\nio.ReadFull(0x3053e908, 0x105d8f00, 0x10616250, 0x5, 0x5, 0x105880c0, 0x0, 0x0)\n\t/usr/go/src/pkg/io/io.go:307 +0x71\ncode.google.com/p/go.crypto/ssh.(*streamPacketCipher).readPacket(0x10616240, 0x3,\n0x3053e908, 0x105d8f00, 0x0, 0x0, 0x0, 0x0, 0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/cipher.go:137 +0xd3\ncode.google.com/p/go.crypto/ssh.(*connectionState).readPacket(0x10586bd0, 0x105d8f00,\n0x0, 0x0, 0x0, 0x0, 0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/transport.go:110 +0xb1\ncode.google.com/p/go.crypto/ssh.(*transport).readPacket(0x10586bd0, 0x0, 0x0, 0x0, 0x0,\n0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/transport.go:106 +0x62\ncode.google.com/p/go.crypto/ssh.(*handshakeTransport).readOnePacket(0x10586cf0, 0x0,\n0x0, 0x0, 0x0, 0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/handshake.go:153 +0xc1\ncode.google.com/p/go.crypto/ssh.(*handshakeTransport).readLoop(0x10586cf0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/handshake.go:133 +0x2d\ncreated by code.google.com/p/go.crypto/ssh.newClientTransport\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/handshake.go:101 +0xb5\n\ngoroutine 23 [syscall]:\nsyscall.Syscall6(0x9, 0x105e2000, 0x1000, 0xffffffff, 0xffffffff, 0x0, 0x0, 0x8, 0x0,\n0x0, ...)\n\t/usr/go/src/pkg/syscall/asm_plan9_386.s:54 +0x5\nsyscall.Pread(0x9, 0x105e2000, 0x1000, 0x1000, 0xffffffff, 0xffffffff, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/syscall/zsyscall_plan9_386.go:118 +0x8f\nsyscall.Read(0x9, 0x105e2000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/syscall/syscall_plan9.go:123 +0x75\nos.(*File).read(0x10570548, 0x105e2000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/os/file_plan9.go:247 +0x6a\nos.(*File).Read(0x10570548, 0x105e2000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/os/file.go:95 +0x8b\nnet.(*netFD).Read(0x105b0500, 0x105e2000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/net/fd_plan9.go:134 +0xfa\nnet.(*conn).Read(0x10570558, 0x105e2000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/net/net.go:122 +0x8f\nbufio.(*Reader).fill(0x105d8f30)\n\t/usr/go/src/pkg/bufio/bufio.go:97 +0x14d\nbufio.(*Reader).Read(0x105d8f30, 0x10589ed0, 0x5, 0x5, 0x5, 0x0, 0x0)\n\t/usr/go/src/pkg/bufio/bufio.go:175 +0x193\nio.ReadAtLeast(0x3053e908, 0x105d8f30, 0x10589ed0, 0x5, 0x5, 0x5, 0x0, 0x0, 0x0)\n\t/usr/go/src/pkg/io/io.go:289 +0xca\nio.ReadFull(0x3053e908, 0x105d8f30, 0x10589ed0, 0x5, 0x5, 0x14, 0x0, 0x0)\n\t/usr/go/src/pkg/io/io.go:307 +0x71\ncode.google.com/p/go.crypto/ssh.(*streamPacketCipher).readPacket(0x10589ec0, 0xd,\n0x3053e908, 0x105d8f30, 0x0, 0x0, 0x0, 0x0, 0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/cipher.go:137 +0xd3\ncode.google.com/p/go.crypto/ssh.(*connectionState).readPacket(0x10586c60, 0x105d8f30,\n0x0, 0x0, 0x0, 0x0, 0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/transport.go:110 +0xb1\ncode.google.com/p/go.crypto/ssh.(*transport).readPacket(0x10586c60, 0x0, 0x0, 0x0, 0x0,\n0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/transport.go:106 +0x62\ncode.google.com/p/go.crypto/ssh.(*handshakeTransport).readOnePacket(0x10586d80, 0x0,\n0x0, 0x0, 0x0, 0x0)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/handshake.go:153 +0xc1\ncode.google.com/p/go.crypto/ssh.(*handshakeTransport).readLoop(0x10586d80)\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/handshake.go:133 +0x2d\ncreated by code.google.com/p/go.crypto/ssh.newServerTransport\n\t/mnt/term/home/djc/go/src/code.google.com/p/go.crypto/ssh/handshake.go:108 +0xa5\nexit status: 'ssh.test 520875: 2'\nFAIL\tcode.google.com/p/go.crypto/ssh\t31.912s\u003c/pre\u003e",
	"user": {
		"login": "0intro",
		"id": 6043744,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "OS-Plan9"
		}
	],
	"assignee": {
		"login": "0intro",
		"id": 6043744,
		"type": "User",
		"site_admin": false
	},
	"comments": 3,
	"created_at": "2014-04-16T19:37:25Z",
	"updated_at": "2015-07-30T09:02:10Z",
	"milestone": {
		"id": 1067491,
		"number": 22,
		"title": "Unreleased"
	}
}
