{
	"id": 123907487,
	"number": 13732,
	"state": "closed",
	"title": "Benchmarking error : runtime: goroutine stack exceeds 1000000000-byte limit ",
	"body": "I'm running benchmark on a simple piece of following code, \r\n    \r\n    package main\r\n    import \"fmt\"\r\n\r\n    func main() {\r\n\t    var fibMap map[int]int\r\n\t    fibMap = make(map[int]int)\r\n\t    fibMap[0] = 0\r\n\t    fibMap[1] = 1\r\n\r\n\t    fmt.Println(Fib(20, fibMap))\r\n    }\r\n    func Fib(n int, fibMap map[int]int) int {\r\n\r\n\t    if val, ok := fibMap[n]; ok {\r\n\t\t    return val\r\n\t    }\r\n\t    fibMap[n] = Fib(n-1, fibMap) + Fib(n-2, fibMap)\r\n\r\n\t    return fibMap[n]\r\n    }\r\n\r\nAnd here is the benchmark, \r\n\r\n    package main\r\n\r\n    import (\r\n\t    \"testing\"\r\n    )\r\n\r\n    func BenchmarkFibV1(b *testing.B) {\r\n\t    // run the Fib function b.N times\r\n\r\n\t    for n := 0; n \u003c b.N; n++ {\r\n\t\t    k := make(map[int]int) //even when the allocation is made outside the loop I get same error\r\n\t\t    Fib(5, k)\r\n\t    }\r\n    }\r\n\r\nThe following the error after I run the benchmark\r\n`\r\nruntime: goroutine stack exceeds 1000000000-byte limit\r\nfatal error: stack overflow\r\n\r\nruntime stack:\r\nruntime.throw(0x18d090, 0xe)\r\n\t/usr/local/go/src/runtime/panic.go:527 +0x90\r\nruntime.newstack()\r\n\t/usr/local/go/src/runtime/stack1.go:800 +0xb17\r\nruntime.morestack()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:330 +0x7f\r\n\r\ngoroutine 19 [stack growth]:\r\nruntime.mapaccess2_fast64(0x11de60, 0x860357de8, 0xffffffffff8e38fc, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/hashmap_fast.go:137 fp=0x840358258 sp=0x840358250\r\ngithub.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2.Fib(0xffffffffff8e38fc, 0x860357de8, 0xffffffffff8e38fd)\r\n\t/Users/hackintoshrao/mycode/go/src/github.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2/fib.go:15 +0x3b fp=0x8403582a0 sp=0x840358258\r\ngithub.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2.Fib(0xffffffffff8e38fd, 0x860357de8, 0xffffffffff8e38fe)\r\n\t/Users/hackintoshrao/mycode/go/src/github.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2/fib.go:18 +0x7a fp=0x8403582e8 sp=0x8403582a0\r\ngithub.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2.Fib(0xffffffffff8e38fe, 0x860357de8, 0xffffffffff8e38ff)\r\n\t/Users/hackintoshrao/mycode/go/src/github.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2/fib.go:18 +0x7a fp=0x840358330 sp=0x8403582e8\r\ngithub.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2.Fib(0xffffffffff8e38ff, 0x860357de8, 0xffffffffff8e3900)\r\n\t/Users/hackintoshrao/mycode/go/src/github.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2/fib.go:18 +0x7a fp=0x840358378 sp=0x840358330\r\ngithub.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2.Fib(0xffffffffff8e3900, 0x860357de8, 0xffffffffff8e3901)\r\n\t/Users/hackintoshrao/mycode/go/src/github.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2/fib.go:18 +0x7a fp=0x8403583c0 sp=0x840358378\r\ngithub.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2.Fib(0xffffffffff8e3901, 0x860357de8, 0xffffffffff8e3902)\r\n\t/Users/hackintoshrao/mycode/go/src/github.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2/fib.go:18 +0x7a fp=0x840358408 sp=0x8403583c0\r\ngithub.com/Karthic-Hackintosh/Codes-From-My-Blog-posts/122/v2.Fib(0xffffffffff8e3902, 0x860357de8, 0xffffffffff8e3903)\r\n`------------------------------------------------\r\n\r\n@davecheney , I'm trying to benchmark the memoized version of the code from your blog about benchmarking in Golang. Can you let me know whats going wrong with the code or the benchmark? what could solve this? ",
	"user": {
		"login": "hackintoshrao",
		"id": 2609511,
		"type": "User",
		"site_admin": false
	},
	"comments": 5,
	"closed_at": "2015-12-26T04:43:53Z",
	"created_at": "2015-12-26T04:13:53Z",
	"updated_at": "2015-12-26T06:00:19Z"
}
