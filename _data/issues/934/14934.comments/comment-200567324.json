{
	"id": 200567324,
	"body": "The SSA compiler is very slow with the large, auto-generated `lexer_test.go`.\r\n\r\nCPU and memory profiles follow:\r\n\r\n```\r\n(pprof) top --cum 20\r\n6.61s of 38.69s total (17.08%)\r\nDropped 294 nodes (cum \u003c= 0.19s)\r\nShowing top 20 nodes out of 85 (cum \u003e= 7.55s)\r\n      flat  flat%   sum%        cum   cum%\r\n         0     0%     0%     37.39s 96.64%  runtime.goexit\r\n         0     0%     0%     25.62s 66.22%  cmd/compile/internal/amd64.Main\r\n         0     0%     0%     25.62s 66.22%  cmd/compile/internal/gc.Main\r\n         0     0%     0%     25.62s 66.22%  main.main\r\n         0     0%     0%     25.62s 66.22%  runtime.main\r\n         0     0%     0%     25.51s 65.93%  cmd/compile/internal/gc.funccompile\r\n         0     0%     0%     25.46s 65.81%  cmd/compile/internal/gc.compile\r\n         0     0%     0%     25.23s 65.21%  cmd/compile/internal/gc.buildssa\r\n         0     0%     0%     16.41s 42.41%  cmd/compile/internal/ssa.Compile\r\n     6.06s 15.66% 15.66%     12.98s 33.55%  runtime.scanobject\r\n         0     0% 15.66%     11.69s 30.21%  runtime.gcBgMarkWorker\r\n     0.19s  0.49% 16.15%     11.66s 30.14%  runtime.gcDrain\r\n     0.17s  0.44% 16.59%     11.16s 28.84%  runtime.mallocgc\r\n     0.04s   0.1% 16.70%     10.99s 28.41%  runtime.systemstack\r\n     0.02s 0.052% 16.75%      8.76s 22.64%  cmd/compile/internal/gc.(*state).linkForwardReferences\r\n     0.04s   0.1% 16.85%      8.74s 22.59%  cmd/compile/internal/gc.(*state).resolveFwdRef\r\n     0.09s  0.23% 17.08%      8.60s 22.23%  cmd/compile/internal/gc.(*state).lookupVarOutgoing\r\n         0     0% 17.08%      8.29s 21.43%  cmd/compile/internal/ssa.regalloc\r\n         0     0% 17.08%      7.55s 19.51%  runtime.(*mcache).refill\r\n         0     0% 17.08%      7.55s 19.51%  runtime.(*mcentral).cacheSpan\r\n\r\n(pprof) top 20\r\n33550ms of 38690ms total (86.71%)\r\nDropped 294 nodes (cum \u003c= 193.45ms)\r\nShowing top 20 nodes out of 85 (cum \u003e= 240ms)\r\n      flat  flat%   sum%        cum   cum%\r\n    6260ms 16.18% 16.18%     7490ms 19.36%  runtime.(*mcentral).grow\r\n    6060ms 15.66% 31.84%    12980ms 33.55%  runtime.scanobject\r\n    4180ms 10.80% 42.65%     4180ms 10.80%  cmd/compile/internal/ssa.copyelimValue\r\n    3740ms  9.67% 52.31%     3740ms  9.67%  runtime.heapBitsForObject\r\n    2740ms  7.08% 59.40%     3210ms  8.30%  runtime.greyobject\r\n    2690ms  6.95% 66.35%     2690ms  6.95%  runtime.memclr\r\n    1270ms  3.28% 69.63%     3410ms  8.81%  cmd/compile/internal/ssa.deadcode\r\n    1070ms  2.77% 72.40%     1070ms  2.77%  runtime.duffcopy\r\n     880ms  2.27% 74.67%      880ms  2.27%  runtime.memmove\r\n     680ms  1.76% 76.43%      750ms  1.94%  runtime.evacuate\r\n     660ms  1.71% 78.13%      890ms  2.30%  cmd/compile/internal/ssa.(*regAllocState).computeLive\r\n     550ms  1.42% 79.56%      550ms  1.42%  cmd/compile/internal/ssa.(*Value).resetArgs\r\n     510ms  1.32% 80.87%      700ms  1.81%  cmd/compile/internal/ssa.(*sparseSet).addAll\r\n     470ms  1.21% 82.09%      470ms  1.21%  runtime.usleep\r\n     390ms  1.01% 83.10%      490ms  1.27%  runtime.(*mheap).allocSpanLocked\r\n     380ms  0.98% 84.08%     2340ms  6.05%  runtime.mapassign1\r\n     290ms  0.75% 84.83%     2800ms  7.24%  cmd/compile/internal/ssa.(*edgeState).setup\r\n     290ms  0.75% 85.58%      290ms  0.75%  runtime/internal/atomic.Or8\r\n     230ms  0.59% 86.17%      250ms  0.65%  cmd/compile/internal/ssa.phielimValue\r\n     210ms  0.54% 86.71%      240ms  0.62%  runtime.mapaccess2_fast64\r\n\r\n\r\n(pprof) top --cum 30\r\n4602.42MB of 5030.21MB total (91.50%)\r\nDropped 233 nodes (cum \u003c= 25.15MB)\r\nShowing top 30 nodes out of 37 (cum \u003e= 96.28MB)\r\n      flat  flat%   sum%        cum   cum%\r\n         0     0%     0%  5026.71MB 99.93%  cmd/compile/internal/gc.Main\r\n         0     0%     0%  5025.71MB 99.91%  cmd/compile/internal/amd64.Main\r\n         0     0%     0%  5025.21MB 99.90%  main.main\r\n         0     0%     0%  5024.21MB 99.88%  runtime.main\r\n         0     0%     0%  5023.21MB 99.86%  runtime.goexit\r\n         0     0%     0%  4999.15MB 99.38%  cmd/compile/internal/gc.funccompile\r\n         0     0%     0%  4997.98MB 99.36%  cmd/compile/internal/gc.compile\r\n         0     0%     0%  4955.84MB 98.52%  cmd/compile/internal/gc.buildssa\r\n         0     0%     0%  3249.92MB 64.61%  cmd/compile/internal/ssa.Compile\r\n         0     0%     0%  2293.67MB 45.60%  cmd/compile/internal/ssa.regalloc\r\n  173.93MB  3.46%  3.46%  1697.45MB 33.75%  cmd/compile/internal/ssa.(*regAllocState).regalloc\r\n         0     0%  3.46%  1682.08MB 33.44%  cmd/compile/internal/gc.(*state).linkForwardReferences\r\n         0     0%  3.46%  1682.08MB 33.44%  cmd/compile/internal/gc.(*state).resolveFwdRef\r\n  579.61MB 11.52% 14.98%  1663.08MB 33.06%  cmd/compile/internal/gc.(*state).lookupVarOutgoing\r\n  967.46MB 19.23% 34.21%   967.46MB 19.23%  cmd/compile/internal/ssa.(*Func).newValue\r\n         0     0% 34.21%   961.44MB 19.11%  cmd/compile/internal/ssa.(*Block).NewValue0A\r\n         0     0% 34.21%   853.75MB 16.97%  cmd/compile/internal/ssa.stackalloc\r\n  630.77MB 12.54% 46.75%   630.77MB 12.54%  cmd/compile/internal/ssa.(*Func).setHome\r\n         0     0% 46.75%   630.77MB 12.54%  cmd/compile/internal/ssa.(*regAllocState).assignReg\r\n  350.85MB  6.97% 53.73%   596.22MB 11.85%  cmd/compile/internal/ssa.(*regAllocState).init\r\n  233.10MB  4.63% 58.36%   495.48MB  9.85%  cmd/compile/internal/ssa.(*stackAllocState).init\r\n  356.95MB  7.10% 65.46%   358.26MB  7.12%  cmd/compile/internal/ssa.(*stackAllocState).stackalloc\r\n  292.95MB  5.82% 71.28%   295.07MB  5.87%  cmd/compile/internal/ssa.cse\r\n  272.54MB  5.42% 76.70%   272.54MB  5.42%  cmd/compile/internal/ssa.schedule\r\n  244.27MB  4.86% 81.56%   245.37MB  4.88%  cmd/compile/internal/ssa.(*regAllocState).computeLive\r\n  201.41MB  4.00% 85.56%   201.41MB  4.00%  cmd/compile/internal/ssa.(*stackAllocState).buildInterferenceGraph\r\n  174.84MB  3.48% 89.04%   174.84MB  3.48%  cmd/compile/internal/ssa.(*Func).newSparseSet\r\n  123.73MB  2.46% 91.50%   123.73MB  2.46%  cmd/compile/internal/gc.(*state).addNamedValue\r\n         0     0% 91.50%   116.56MB  2.32%  cmd/compile/internal/ssa.dse\r\n         0     0% 91.50%    96.28MB  1.91%  cmd/compile/internal/ssa.deadcode\r\n\r\n(pprof) top 30\r\n4.78GB of 4.91GB total (97.25%)\r\nDropped 233 nodes (cum \u003c= 0.02GB)\r\nShowing top 30 nodes out of 37 (cum \u003e= 3.17GB)\r\n      flat  flat%   sum%        cum   cum%\r\n    0.94GB 19.23% 19.23%     0.94GB 19.23%  cmd/compile/internal/ssa.(*Func).newValue\r\n    0.62GB 12.54% 31.77%     0.62GB 12.54%  cmd/compile/internal/ssa.(*Func).setHome\r\n    0.57GB 11.52% 43.30%     1.62GB 33.06%  cmd/compile/internal/gc.(*state).lookupVarOutgoing\r\n    0.35GB  7.10% 50.39%     0.35GB  7.12%  cmd/compile/internal/ssa.(*stackAllocState).stackalloc\r\n    0.34GB  6.97% 57.37%     0.58GB 11.85%  cmd/compile/internal/ssa.(*regAllocState).init\r\n    0.29GB  5.82% 63.19%     0.29GB  5.87%  cmd/compile/internal/ssa.cse\r\n    0.27GB  5.42% 68.61%     0.27GB  5.42%  cmd/compile/internal/ssa.schedule\r\n    0.24GB  4.86% 73.46%     0.24GB  4.88%  cmd/compile/internal/ssa.(*regAllocState).computeLive\r\n    0.23GB  4.63% 78.10%     0.48GB  9.85%  cmd/compile/internal/ssa.(*stackAllocState).init\r\n    0.20GB  4.00% 82.10%     0.20GB  4.00%  cmd/compile/internal/ssa.(*stackAllocState).buildInterferenceGraph\r\n    0.17GB  3.48% 85.58%     0.17GB  3.48%  cmd/compile/internal/ssa.(*Func).newSparseSet\r\n    0.17GB  3.46% 89.04%     1.66GB 33.75%  cmd/compile/internal/ssa.(*regAllocState).regalloc\r\n    0.12GB  2.46% 91.50%     0.12GB  2.46%  cmd/compile/internal/gc.(*state).addNamedValue\r\n    0.09GB  1.88% 93.38%     0.09GB  1.88%  cmd/compile/internal/ssa.tighten\r\n    0.06GB  1.18% 94.56%     0.06GB  1.21%  cmd/compile/internal/ssa.(*stackAllocState).computeLive\r\n    0.06GB  1.17% 95.73%     0.06GB  1.17%  cmd/compile/internal/ssa.critical\r\n    0.04GB  0.78% 96.50%     0.04GB  0.78%  cmd/compile/internal/ssa.(*edgeState).set\r\n    0.04GB  0.75% 97.25%     0.04GB  0.75%  cmd/compile/internal/ssa.liveValues\r\n         0     0% 97.25%     4.91GB 99.91%  cmd/compile/internal/amd64.Main\r\n         0     0% 97.25%     1.64GB 33.44%  cmd/compile/internal/gc.(*state).linkForwardReferences\r\n         0     0% 97.25%     1.64GB 33.44%  cmd/compile/internal/gc.(*state).resolveFwdRef\r\n         0     0% 97.25%     4.91GB 99.93%  cmd/compile/internal/gc.Main\r\n         0     0% 97.25%     4.84GB 98.52%  cmd/compile/internal/gc.buildssa\r\n         0     0% 97.25%     4.88GB 99.36%  cmd/compile/internal/gc.compile\r\n         0     0% 97.25%     4.88GB 99.38%  cmd/compile/internal/gc.funccompile\r\n         0     0% 97.25%     0.94GB 19.11%  cmd/compile/internal/ssa.(*Block).NewValue0A\r\n         0     0% 97.25%     0.04GB  0.78%  cmd/compile/internal/ssa.(*edgeState).setup\r\n         0     0% 97.25%     0.62GB 12.54%  cmd/compile/internal/ssa.(*regAllocState).assignReg\r\n         0     0% 97.25%     0.04GB  0.78%  cmd/compile/internal/ssa.(*regAllocState).shuffle\r\n         0     0% 97.25%     3.17GB 64.61%  cmd/compile/internal/ssa.Compile\r\n\r\n```\r\n",
	"user": {
		"login": "bradfitz",
		"id": 2621,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-03-23T22:24:31Z",
	"updated_at": "2016-03-23T22:24:31Z"
}
