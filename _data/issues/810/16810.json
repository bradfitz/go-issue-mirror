{
	"id": 172258596,
	"number": 16810,
	"state": "closed",
	"title": "cmd/compile: internal compiler error: out of fixed registers (on 386)",
	"body": "Go 1.7, compiling this package:\r\n\r\n```\r\npackage weakhash\r\n\r\ntype digest struct {\r\n\tbuf  []byte\r\n\tsize int\r\n\ta    uint16\r\n\tb    uint16\r\n\tj    int\r\n}\r\n\r\nfunc (d *digest) Write(data []byte) (int, error) {\r\n\tfor _, c := range data {\r\n\t\td.a = d.a - uint16(d.buf[d.j]) + uint16(c)\r\n\t\td.b = d.b - uint16(d.size)*uint16(d.buf[d.j]) + d.a\r\n\t\td.buf[d.j] = c\r\n\t\td.j = (d.j + 1) % d.size\r\n\t}\r\n\treturn len(data), nil\r\n}\r\n```\r\n\r\nresults in\r\n\r\n```\r\njb@syno:~/t/weakhash $ go version\r\ngo version go1.7rc6 darwin/amd64\r\njb@syno:~/t/weakhash $ GOARCH=386 go build\r\n# _/Users/jb/test/weakhash\r\nrun compiler with -v for register allocation sites\r\n./weakhash.go:13: internal compiler error: out of fixed registers\r\n\r\ngoroutine 1 [running]:\r\nruntime/debug.Stack(0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/debug/stack.go:24 +0x79\r\ncmd/compile/internal/gc.Fatalf(0x4ff9fa, 0x16, 0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/subr.go:165 +0x248\r\ncmd/compile/internal/gc.Regalloc(0xc42044b320, 0xc420014c30, 0xc42044b200)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/gsubr.go:749 +0x16b\r\ncmd/compile/internal/x86.ginscmp(0xc42042183e, 0xc420014c30, 0xc42044b0e0, 0xc42044b200, 0x1, 0x0)\r\n\t/usr/local/go/src/cmd/compile/internal/x86/gsubr.go:657 +0x364\r\ncmd/compile/internal/gc.Agenr(0xc4204219e0, 0xc42044aa20, 0xc42044a7e0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:1245 +0x20e8\r\ncmd/compile/internal/gc.Igen(0xc4204219e0, 0xc42044aa20, 0xc42044a7e0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:1718 +0x279\r\ncmd/compile/internal/gc.cgen_wb(0xc4204219e0, 0xc42044a7e0, 0xc42040ef00)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:523 +0x2281\r\ncmd/compile/internal/gc.Cgen(0xc4204219e0, 0xc42044a7e0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:19 +0x3a\r\ncmd/compile/internal/gc.Mgen(0xc4204219e0, 0xc42044a7e0, 0xc42044a750)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:906 +0xf7\r\ncmd/compile/internal/gc.cgen_wb(0xc420421a70, 0xc42044a750, 0x0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:460 +0x1c95\r\ncmd/compile/internal/gc.Cgen(0xc420421a70, 0xc42044a750)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:19 +0x3a\r\ncmd/compile/internal/gc.cgen_wb(0xc420421b00, 0xc42044a510, 0xc42040ef00)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:738 +0x1045\r\ncmd/compile/internal/gc.Cgen(0xc420421b00, 0xc42044a510)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:19 +0x3a\r\ncmd/compile/internal/gc.cgen_wb(0xc420421cb0, 0xc42044a360, 0x0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:725 +0xe4c\r\ncmd/compile/internal/gc.Cgen(0xc420421cb0, 0xc42044a360)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:19 +0x3a\r\ncmd/compile/internal/gc.cgen_wb(0xc420421cb0, 0xc420421710, 0x4ef400)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/cgen.go:102 +0x427d\r\ncmd/compile/internal/gc.Cgen_as_wb(0xc420421710, 0xc420421cb0, 0xd00000800)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/gen.go:1023 +0x17b\r\ncmd/compile/internal/gc.Cgen_as(0xc420421710, 0xc420421cb0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/gen.go:979 +0x3a\r\ncmd/compile/internal/gc.gen(0xc420421d40)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/gen.go:926 +0xd6c\r\ncmd/compile/internal/gc.Genlist(0xc4204244c0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/gen.go:311 +0x50\r\ncmd/compile/internal/gc.gen(0xc420421560)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/gen.go:860 +0x62f\r\ncmd/compile/internal/gc.Genlist(0xc420424400)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/gen.go:311 +0x50\r\ncmd/compile/internal/gc.genlegacy(0xc4200ec278, 0xc42042c8c0, 0xc42042c930)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/pgen.go:498 +0x4d\r\ncmd/compile/internal/gc.compile(0xc4204210e0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/pgen.go:485 +0x7a4\r\ncmd/compile/internal/gc.funccompile(0xc4204210e0)\r\n\t/usr/local/go/src/cmd/compile/internal/gc/dcl.go:1287 +0x186\r\ncmd/compile/internal/gc.Main()\r\n\t/usr/local/go/src/cmd/compile/internal/gc/main.go:467 +0x19f8\r\ncmd/compile/internal/x86.Main()\r\n\t/usr/local/go/src/cmd/compile/internal/x86/galign.go:80 +0x3ba\r\nmain.main()\r\n\t/usr/local/go/src/cmd/compile/main.go:31 +0x1d4\r\n```\r\n",
	"user": {
		"login": "calmh",
		"id": 125426,
		"type": "User",
		"site_admin": false
	},
	"comments": 4,
	"closed_at": "2016-08-20T11:50:04Z",
	"created_at": "2016-08-20T07:22:30Z",
	"updated_at": "2016-08-20T16:57:12Z"
}
