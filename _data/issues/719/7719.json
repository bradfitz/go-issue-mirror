{
	"id": 51287116,
	"number": 7719,
	"state": "closed",
	"title": "cmd/ld: -linkmode external -extldflags -static fails when using cgo",
	"body": "by **guillaume@charmes.net**:\n\n\u003cpre\u003eDocker works fine in go1.2.1.\n\nAny docker command stales in tip. Including docker --help, docker --version which do not\ncall the daemon nor do anything fancy.\n\nLooks like a deadlock with FUTEX_WAIT_PRIVATE\n\n$\u0026gt; go version\ngo version devel +b958fefe50a7 Sun Apr 06 12:18:01 2014 +1000 + linux/amd64\n$\u0026gt; hg parents                                                                        \n                                                                                        \n                                                                           changeset:  \n19647:b958fefe50a7\ntag:         tip\nuser:        Alex Brainman \u0026lt;alex.brainman@gmail.com\u0026gt;\ndate:        Sun Apr 06 12:18:01 2014 +1000\nsummary:     syscall: use unsafe.Pointer instead of uintptr on windows when possible\n\nstrace:\nexecve(\u0026quot;/home/guillaume/goroot/bin/docker\u0026quot;, [\u0026quot;docker\u0026quot;,\n\u0026quot;--version\u0026quot;], [/* 36 vars */]) = 0\nuname({sys=\u0026quot;Linux\u0026quot;, node=\u0026quot;ubuntu\u0026quot;, ...}) = 0\nbrk(0)                                  = 0x1d86000\nbrk(0x1d871c0)                          = 0x1d871c0\narch_prctl(ARCH_SET_FS, 0x1d86880)      = 0\nset_tid_address(0x1d86b50)              = 19657\nset_robust_list(0x1d86b60, 24)          = 0\nfutex(0x7fff8709b980, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 1, NULL, 1d86880)\n= -1 EAGAIN (Resource temporarily unavailable)\nrt_sigaction(SIGRTMIN, {0x8aa670, [], SA_RESTORER|SA_SIGINFO, 0x8aad30}, NULL, 8) = 0\nrt_sigaction(SIGRT_1, {0x8aa700, [], SA_RESTORER|SA_RESTART|SA_SIGINFO, 0x8aad30}, NULL,\n8) = 0\nrt_sigprocmask(SIG_UNBLOCK, [RTMIN RT_1], NULL, 8) = 0\ngetrlimit(RLIMIT_STACK, {rlim_cur=8192*1024, rlim_max=RLIM64_INFINITY}) = 0\nreadlink(\u0026quot;/proc/self/exe\u0026quot;, \u0026quot;/home/guillaume/goroot/bin/docke\u0026quot;...,\n4096) = 33\nbrk(0x1da81c0)                          = 0x1da81c0\nbrk(0x1da9000)                          = 0x1da9000\naccess(\u0026quot;/etc/ld.so.nohwcap\u0026quot;, F_OK)      = -1 ENOENT (No such file or directory)\nsched_getaffinity(0, 128, {f, 0, 0, 0}) = 32\nmmap(0xc000000000, 65536, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xc000000000\nmunmap(0xc000000000, 65536)             = 0\nmmap(NULL, 262144, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =\n0x7f02873f2000\nmmap(0xc208000000, 1048576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =\n0xc208000000\nmmap(0xc207ff0000, 65536, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =\n0xc207ff0000\nmmap(0xc000000000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =\n0xc000000000\nmmap(NULL, 65536, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =\n0x7f02873e2000\nclock_gettime(CLOCK_MONOTONIC, {63470, 302683882}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 303131146}) = 0\nmmap(NULL, 1439992, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =\n0x7f0287282000\nclock_gettime(CLOCK_MONOTONIC, {63470, 304240784}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 304739171}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 305423337}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 305951337}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 306457267}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 308338511}) = 0\nmmap(NULL, 65536, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =\n0x7f0287272000\nclock_gettime(CLOCK_MONOTONIC, {63470, 311245306}) = 0\nsigaltstack({ss_sp=0xc208004000, ss_flags=0, ss_size=32768}, NULL) = 0\nrt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0\nrt_sigaction(SIGHUP, NULL, {SIG_DFL, [], 0}, 8) = 0\nrt_sigaction(SIGHUP, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGINT, NULL, {SIG_DFL, [], 0}, 8) = 0\nrt_sigaction(SIGINT, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGQUIT, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGILL, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGTRAP, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGABRT, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGBUS, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGFPE, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGUSR1, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGSEGV, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGUSR2, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGPIPE, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGALRM, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGTERM, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGSTKFLT, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGCHLD, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGURG, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGXCPU, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGXFSZ, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGVTALRM, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGPROF, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGWINCH, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGIO, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGPWR, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGSYS, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_2, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_3, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_4, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_5, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_6, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_7, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_8, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_9, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_10, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_11, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_12, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_13, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_14, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_15, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_16, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_17, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_18, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_19, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_20, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_21, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_22, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_23, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_24, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_25, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_26, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_27, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_28, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_29, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_30, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_31, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nrt_sigaction(SIGRT_32, {0x437e70, ~[], SA_RESTORER|SA_STACK|SA_RESTART|SA_SIGINFO,\n0x437ee0}, NULL, 8) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 345952510}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 346522694}) = 0\nclock_gettime(CLOCK_MONOTONIC, {63470, 347298491}) = 0\nfutex(0x111dfc0, FUTEX_WAIT_PRIVATE, 2, NULL\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"assignee": {
		"login": "rsc",
		"id": 104030,
		"type": "User",
		"site_admin": false
	},
	"comments": 13,
	"closed_at": "2014-12-08T10:42:51Z",
	"created_at": "2014-04-06T14:28:25Z",
	"updated_at": "2016-06-25T01:31:36Z",
	"milestone": {
		"id": 1067211,
		"number": 17,
		"title": "Go1.3"
	}
}
