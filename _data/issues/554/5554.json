{
	"id": 51283822,
	"number": 5554,
	"state": "closed",
	"title": "possible GC-related panic",
	"body": "\u003cpre\u003ee570c2daeaca (release-branch.go1.1) go1.1/release\n\nTo reproduce (currently we haven't managed to narrow\nit down at all, sorry):\n\ncd $GOPATH/src\nmkdir -p launchpad.net\ncd launchpad.net\nbzr branch lp:~rogpeppe/juju-core/dimitern-041-provisioner-api-calls-GC-bug juju-core\n\n# use the Go-only version of goyaml to rule\n# out possible unsafe interactions.\nbzr branch lp:~niemeyer/goyaml/go-port goyaml\n\ngo get launchpad.net/juju-core/state/apiserver\nwhile true; do\n    go test launchpad.net/juju-core/state/apiserver\ndone\n\nThere are expected test failures (this problem was encountered\nduring development). But every so often we see a panic like this,\nwhich looks highly suspect.\n\nunexpected fault address 0xc200b00000\nfatal error: fault\n[signal 0xb code=0x1 addr=0xc200b00000 pc=0x40e1a4]\n\ngoroutine 3181 [running]:\n[fp=0xc200141608] runtime.throw(0xd02b37)\n\t/home/rog/go-release/src/pkg/runtime/panic.c:473 +0x67\n[fp=0xc200141620] runtime.sigpanic()\n\t/home/rog/go-release/src/pkg/runtime/os_linux.c:239 +0xe7\n[fp=0xc2001419c0] scanblock(0x7f2d2d5de000, 0x7f2d2d5dee88, 0x9a, 0xc200141900)\n\t/home/rog/go-release/src/pkg/runtime/mgc0.c:791 +0x534\n[fp=0xc200141a10] markroot(0xc2000fe480, 0x1000000029)\n\t/home/rog/go-release/src/pkg/runtime/mgc0.c:1269 +0xab\n[fp=0xc200141a88] runtime.parfordo(0xc2000fe480)\n\t/home/rog/go-release/src/pkg/runtime/parfor.c:105 +0x9b\n[fp=0xc200141bb8] gc(0x7f2d2d5c575c)\n\t/home/rog/go-release/src/pkg/runtime/mgc0.c:2000 +0x29d\n----- stack segment boundary -----\n[fp=0x7f2d2d5c5770] runtime.gc(0xc200000000)\n\t/home/rog/go-release/src/pkg/runtime/mgc0.c:1927 +0x11b\n[fp=0x7f2d2d5c57c8] runtime.mallocgc(0xc0, 0x100000000, 0xc200000001)\n\t/home/rog/go-release/src/pkg/runtime/zmalloc_linux_amd64.c:101 +0x1e4\n[fp=0x7f2d2d5c5800] makeslice1(0x7de1e0, 0x0, 0x8, 0x7f2d2d5c5848)\n\t/home/rog/go-release/src/pkg/runtime/slice.c:63 +0xb6\n[fp=0x7f2d2d5c5830] runtime.makeslice(0x7de1e0, 0x0, 0x8, 0x7f2d2d5c5800, 0x0, ...)\n\t/home/rog/go-release/src/pkg/runtime/slice.c:34 +0x9a\n[fp=0x7f2d2d5c5908] labix.org/v2/mgo/bson.(*decoder).readSliceDoc(0xc2008f6c30,\n0xc20012d000, 0x7dcfe0, 0xc20012d000, 0x7ede20, ...)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:282 +0x3e\n[fp=0x7f2d2d5c5c10] labix.org/v2/mgo/bson.(*decoder).readElemTo(0xc2008f6c30, 0x7ede20,\n0xc2002603d0, 0x146, 0xc200260304, ...)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:413 +0x24e6\n[fp=0x7f2d2d5c5ca8] labix.org/v2/mgo/bson.func·001(0xc2008f6c04, 0xc2007822d0, 0x1)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:329 +0x104\n[fp=0x7f2d2d5c5ce8] labix.org/v2/mgo/bson.(*decoder).readDocWith(0xc2008f6c30,\n0x7f2d2d5c5d40)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:350 +0x12f\n[fp=0x7f2d2d5c5d78] labix.org/v2/mgo/bson.(*decoder).readDocElems(0xc2008f6c30,\n0xc20012d000, 0x8b5920, 0x8d2e00, 0x8b5901, ...)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:332 +0xe9\n[fp=0x7f2d2d5c5f98] labix.org/v2/mgo/bson.(*decoder).readDocTo(0xc2008f6c30, 0x8b5920,\n0xc200260320, 0x176)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:190 +0x105a\n----- stack segment boundary -----\n[fp=0x7f2d2d6cf420] labix.org/v2/mgo/bson.(*decoder).readElemTo(0xc2008f6c30, 0x7ede20,\n0xc200260310, 0x146, 0xc200260303, ...)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:381 +0xda\n[fp=0x7f2d2d6cf4b8] labix.org/v2/mgo/bson.func·001(0xc2008f6c03, 0xc2007822c0, 0x5)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:329 +0x104\n[fp=0x7f2d2d6cf4f8] labix.org/v2/mgo/bson.(*decoder).readDocWith(0xc2008f6c30,\n0x7f2d2d6cf550)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:350 +0x12f\n[fp=0x7f2d2d6cf588] labix.org/v2/mgo/bson.(*decoder).readDocElems(0xc2008f6c30,\n0xc20012d000, 0x8b5920, 0x8d2e00, 0x101, ...)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:332 +0xe9\n[fp=0x7f2d2d6cf7a8] labix.org/v2/mgo/bson.(*decoder).readDocTo(0xc2008f6c30, 0x8b5920,\n0xc20026d500, 0x176)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/decode.go:190 +0x105a\n[fp=0x7f2d2d6cf838] labix.org/v2/mgo/bson.Unmarshal(0xc200305e60, 0x4a, 0x4a, 0x8a50c0,\n0xc20026d500, ...)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/bson/bson.go:459 +0x157\n[fp=0x7f2d2d6cfa58] labix.org/v2/mgo.(*Iter).Next(0xc200298a50, 0x8a50c0, 0xc20026d500,\n0x8)\n\t/home/rog/src/go-alt/src/labix.org/v2/mgo/session.go:2311 +0x5b2\n[fp=0x7f2d2d6cff18] launchpad.net/juju-core/state/watcher.(*Watcher).sync(0xc200424840,\n0xc200910000, 0x7f2d2d6cff70)\n\t/home/rog/src/go-alt/src/launchpad.net/juju-core/state/watcher/watcher.go:364 +0x17e\n[fp=0x7f2d2d6cff90] launchpad.net/juju-core/state/watcher.(*Watcher).loop(0xc200424840,\n0x943d40, 0xc20079bf28)\n\t/home/rog/src/go-alt/src/launchpad.net/juju-core/state/watcher/watcher.go:231 +0x16b\n[fp=0x7f2d2d6cffb8] launchpad.net/juju-core/state/watcher.func·001()\n\t/home/rog/src/go-alt/src/launchpad.net/juju-core/state/watcher/watcher.go:119 +0x2c\n[fp=0x7f2d2d6cffc0] runtime.goexit()\n\t/home/rog/go-release/src/pkg/runtime/proc.c:1223\ncreated by launchpad.net/juju-core/state/watcher.New\n\t/home/rog/src/go-alt/src/launchpad.net/juju-core/state/watcher/watcher.go:121 +0x100\u003c/pre\u003e",
	"user": {
		"login": "rogpeppe",
		"id": 66491,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 21,
	"closed_at": "2014-12-08T10:30:14Z",
	"created_at": "2013-05-24T08:13:16Z",
	"updated_at": "2016-06-24T22:41:00Z",
	"milestone": {
		"id": 1067200,
		"number": 12,
		"title": "Go1.1.1"
	}
}
