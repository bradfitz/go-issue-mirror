{
	"id": 51280290,
	"number": 3228,
	"state": "closed",
	"title": "cmd/go: can't build go subrepos and goprotobuf with gccgo",
	"body": "\u003cpre\u003eWhat steps will reproduce the problem?\n\nI have a deps directory with all the Go subrepos and goprotobuf:\n\n$ find ~/deps -type d | grep -v /.hg/\ndeps\ndeps/src\ndeps/src/code.google.com\ndeps/src/code.google.com/p\ndeps/src/code.google.com/p/go.crypto\ndeps/src/code.google.com/p/go.crypto/xtea\ndeps/src/code.google.com/p/go.crypto/.hg\ndeps/src/code.google.com/p/go.crypto/md4\ndeps/src/code.google.com/p/go.crypto/pbkdf2\ndeps/src/code.google.com/p/go.crypto/ripemd160\ndeps/src/code.google.com/p/go.crypto/ocsp\ndeps/src/code.google.com/p/go.crypto/bcrypt\ndeps/src/code.google.com/p/go.crypto/ssh\ndeps/src/code.google.com/p/go.crypto/cast5\ndeps/src/code.google.com/p/go.crypto/twofish\ndeps/src/code.google.com/p/go.crypto/blowfish\ndeps/src/code.google.com/p/go.crypto/openpgp\ndeps/src/code.google.com/p/go.crypto/openpgp/elgamal\ndeps/src/code.google.com/p/go.crypto/openpgp/errors\ndeps/src/code.google.com/p/go.crypto/openpgp/packet\ndeps/src/code.google.com/p/go.crypto/openpgp/armor\ndeps/src/code.google.com/p/go.crypto/openpgp/s2k\ndeps/src/code.google.com/p/go.crypto/openpgp/clearsign\ndeps/src/code.google.com/p/go.net\ndeps/src/code.google.com/p/go.net/.hg\ndeps/src/code.google.com/p/go.net/dict\ndeps/src/code.google.com/p/go.net/spdy\ndeps/src/code.google.com/p/go.net/websocket\ndeps/src/code.google.com/p/goprotobuf\ndeps/src/code.google.com/p/goprotobuf/lib\ndeps/src/code.google.com/p/goprotobuf/lib/codereview\ndeps/src/code.google.com/p/goprotobuf/.hg\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/testdata\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/testdata/my_test\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/plugin\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/generator\ndeps/src/code.google.com/p/goprotobuf/proto\ndeps/src/code.google.com/p/goprotobuf/proto/testdata\n\nWhat is the expected output?\n\nGOPATH=~/deps go install -v code.google.com/...\ncode.google.com/p/go.crypto/blowfish\ncode.google.com/p/go.crypto/cast5\ncode.google.com/p/go.crypto/md4\ncode.google.com/p/go.crypto/ocsp\ncode.google.com/p/go.crypto/openpgp/errors\ncode.google.com/p/go.crypto/openpgp/elgamal\ncode.google.com/p/go.crypto/pbkdf2\ncode.google.com/p/go.crypto/ripemd160\ncode.google.com/p/go.crypto/ssh\ncode.google.com/p/go.crypto/twofish\ncode.google.com/p/go.crypto/xtea\ncode.google.com/p/go.net/dict\ncode.google.com/p/go.net/spdy\ncode.google.com/p/go.net/websocket\ncode.google.com/p/goprotobuf/proto\ncode.google.com/p/go.crypto/openpgp/armor\ncode.google.com/p/go.crypto/openpgp/s2k\ncode.google.com/p/go.crypto/bcrypt\ncode.google.com/p/go.crypto/openpgp/packet\ncode.google.com/p/goprotobuf/protoc-gen-go/descriptor\ncode.google.com/p/go.crypto/openpgp\ncode.google.com/p/go.crypto/openpgp/clearsign\ncode.google.com/p/goprotobuf/protoc-gen-go/plugin\ncode.google.com/p/goprotobuf/protoc-gen-go/generator\ncode.google.com/p/goprotobuf/protoc-gen-go\n\nWhat do you see instead?\n\nGOPATH=~/deps go install -compiler=gccgo -v code.google.com/...\ncode.google.com/p/go.crypto/bcrypt\ncode.google.com/p/go.crypto/openpgp/armor\ncode.google.com/p/go.crypto/openpgp/s2k\ncode.google.com/p/goprotobuf/protoc-gen-go/descriptor\n# code.google.com/p/go.crypto/openpgp/s2k\ndeps/src/code.google.com/p/go.crypto/openpgp/s2k/s2k.go:10:44: error: import file\n‘code.google.com/p/go.crypto/openpgp/errors’ not found\ndeps/src/code.google.com/p/go.crypto/openpgp/s2k/s2k.go:92:15: error: reference to\nundefined name ‘errors’\ndeps/src/code.google.com/p/go.crypto/openpgp/s2k/s2k.go:96:15: error: reference to\nundefined name ‘errors’\ndeps/src/code.google.com/p/go.crypto/openpgp/s2k/s2k.go:126:14: error: reference to\nundefined name ‘errors’\n# code.google.com/p/go.crypto/bcrypt\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:11:38: error: import file\n‘code.google.com/p/go.crypto/blowfish’ not found\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:196:77: error: expected package\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:179:12: error: number of results\ndoes not match number of values\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:200:3: error: too many values in\nreturn statement\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:207:12: error: reference to\nundefined name ‘blowfish’\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:209:3: error: too many values in\nreturn statement\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:214:3: error: reference to\nundefined name ‘blowfish’\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:215:3: error: reference to\nundefined name ‘blowfish’\ndeps/src/code.google.com/p/go.crypto/bcrypt/bcrypt.go:218:2: error: too many values in\nreturn statement\n# code.google.com/p/go.crypto/openpgp/armor\ndeps/src/code.google.com/p/go.crypto/openpgp/armor/armor.go:12:44: error: import file\n‘code.google.com/p/go.crypto/openpgp/errors’ not found\ndeps/src/code.google.com/p/go.crypto/openpgp/armor/armor.go:38:26: error: reference to\nundefined name ‘errors’\n# code.google.com/p/goprotobuf/protoc-gen-go/descriptor\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:6:8:\nerror: import file ‘code.google.com/p/goprotobuf/proto’ not found\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:286:35:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:287:22:\nerror: expected ‘,’ or ‘}’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:290:50:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:317:38:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:318:22:\nerror: expected ‘,’ or ‘}’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:321:53:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:348:36:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:349:22:\nerror: expected ‘,’ or ‘}’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:352:51:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:376:35:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:377:22:\nerror: expected ‘,’ or ‘}’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:380:50:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:401:40:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:402:22:\nerror: expected ‘,’ or ‘}’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:405:55:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:424:38:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:425:22:\nerror: expected ‘,’ or ‘}’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:428:53:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:447:37:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:448:22:\nerror: expected ‘,’ or ‘}’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:451:52:\nerror: expected package\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:10:9:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:82:9:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:109:9:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:136:9:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:163:9:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:172:57:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:189:59:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:203:55:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:212:70:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:227:60:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:237:59:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:247:64:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:257:62:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:268:61:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:284:51:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:315:54:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:346:52:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:374:51:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:399:56:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:422:54:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:445:53:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:472:59:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:481:68:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:484:2:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:485:2:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:486:2:\nerror: reference to undefined name ‘proto’\ndeps/src/code.google.com/p/goprotobuf/protoc-gen-go/descriptor/descriptor.pb.go:487:2:\nerror: reference to undefined name ‘proto’\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n\ngccgo\n\nWhich operating system are you using?\n\nlinux\n\nWhich revision are you using?  (hg identify)\n\n4346881f5c9d tip\n\nalso tip of gccgo\u003c/pre\u003e",
	"user": {
		"login": "alberts",
		"id": 409689,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 5,
	"closed_at": "2014-12-08T10:16:48Z",
	"created_at": "2012-03-07T08:48:42Z",
	"updated_at": "2016-06-24T21:30:01Z",
	"milestone": {
		"id": 1061233,
		"number": 7,
		"title": "Go1"
	}
}
