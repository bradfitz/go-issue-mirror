{
	"id": 66094548,
	"body": "\u003ca id=\"c3\"\u003e\u003c/a\u003eComment 3 by **webluoye**:\n\n\u003cpre\u003eThanks all.\nbut use c language is success.\n        \nint main(int argc, char *argv[])\n{\n        int i,length,buf_len;\n        char buf_read[10240];\n        char buf_write[10240];\n        char domain[100];\n        SSL_CTX *ctx;\n        SSL *ssl;\n\n        memset(buf_read, '\\0', 10240);\n        memset(buf_write, '\\0', 10240);\n        memset(domain, '\\0', 100);\n\n        srand((unsigned)time(NULL));\n        \n        SSL_load_error_strings();\n        SSLeay_add_ssl_algorithms();\n        ctx = SSL_CTX_new(SSLv23_client_method());\n        CHK_NULL(ctx);\n\n        i = init_ctx(ctx);\n        if (0 == i)\n        {\n                printf(\"ctx success!\\n\");\n        }\n\n        ssl = SSL_new(ctx);\n        CHK_NULL(ssl);\n        i = sslConnect(ctx,ssl);\n        if (i)\n        {\n                printf(\"ssl connect success!\\n\");\n        }\n        else\n        {\n                printf(\"ssl error!\\n\");\n        }\n        i = readFromSSLSocket(ssl,\u0026buf_read,10240,10240);\n        if (i \u0026gt; 0)\n        {\n                printf(\"size = %d ssl_read:%s\\n\",i,buf_read);\n        }\n        else\n        {\n                printf(\"SSL_read error!\\n\");\n        }\n        ssl_error(ctx,ssl);\n        return 0;\n}\n\n\nint init_ctx(SSL_CTX *ctx)\n{\n        int err;\n        char *server_name,*pathname,*client_name,*client_key;\n        client_name = \"eeee.crt\";\n        client_key = \"eeee.pem\";\n\n        err = setClientVerification(ctx);\n        CHK_SSL(err);\n\n        err = setCertFile(ctx,client_name,SSL_FILETYPE_PEM);\n        CHK_SSL(err);\n\n        err = setPrivateKey(ctx,client_key,SSL_FILETYPE_PEM);\n        CHK_SSL(err);\n\n        err = checkPrivateKey(ctx);\n        CHK_SSL(err);\n\n        return 0;\n}\n\nint sslConnect(SSL_CTX *ctx,SSL *ssl)\n{\n        int sock,port;\n        char *host = \"sheep.cnnic.cn\";\n        port = 4121;\n\n        sock = openSocket(host,port);\n\n        return handShake(ssl,sock);\n}\n\nint writeToSSLSocket(SSL *ssl,char *request,int length)\n{\n        int bytesWritten;\n        bytesWritten = SSL_write(ssl,request,length);\n        return bytesWritten;\n}\n---------------------------------------------------------------\nthe Program result:\nctx success!\nssl connect success!\nsize = 1199 ssl_read:\u0026lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u0026gt;\n\u0026lt;epp xmlns=\"urn:iana:xml:ns:epp-1.0\"\nxmlns:xsi=\"\u003ca href=\"http://www.w3.org/2001/XMLSchema-instance\"\u003ehttp://www.w3.org/2001/XMLSchema-instance\u003c/a\u003e\"\nxsi:schemaLocation=\"urn:iana:xml:ns:epp-1.0 epp-1.0.xsd\"\u0026gt;\n \u0026lt;greeting\u0026gt;\n  \u0026lt;svID\u0026gt;CNNIC EPP Server\u0026lt;/svID\u0026gt;\n  \u0026lt;svDate\u0026gt;2014-05-09T01:19:14.0Z\u0026lt;/svDate\u0026gt;\n  \u0026lt;svcMenu\u0026gt;\n   \u0026lt;version\u0026gt;1.0\u0026lt;/version\u0026gt;\n   \u0026lt;lang\u0026gt;en-US\u0026lt;/lang\u0026gt;\n   \u0026lt;contact:svc xmlns:contact=\"urn:iana:xml:ns:contact-1.0\" xsi:schemaLocation=\"urn:iana:xml:ns:contact-1.0 contact-1.0.xsd\"/\u0026gt;\n   \u0026lt;host:svc xmlns:host=\"urn:iana:xml:ns:host-1.0\" xsi:schemaLocation=\"urn:iana:xml:ns:host-1.0 host-1.0.xsd\"/\u0026gt;\n   \u0026lt;domain:svc xmlns:domain=\"urn:iana:xml:ns:domain-1.0\" xsi:schemaLocation=\"urn:iana:xml:ns:domain-1.0 domain-1.0.xsd\"/\u0026gt;\n   \u0026lt;unspec\u0026gt;\n    \u0026lt;cnContact:svc xmlns:cnContact=\"urn:iana:xml:ns:cntld:contact-1.0\" xsi:schemaLocation=\"urn:iana:xml:ns:cntld:contact-1.0 cntld-contact-1.0.xsd\"/\u0026gt;\n    \u0026lt;cnDomain:svc xmlns:cnDomain=\"urn:iana:xml:ns:cntld:domain-1.0\" xsi:schemaLocation=\"urn:iana:xml:ns:cntld:domain-1.0 cntld-domain-1.0.xsd\"/\u0026gt;\n    \u0026lt;cnHost:svc xmlns:cnHost=\"urn:iana:xml:ns:cntld:host-1.0\" xsi:schemaLocation=\"urn:iana:xml:ns:cntld:host-1.0 cntld-host-1.0.xsd\"/\u0026gt;\n   \u0026lt;/unspec\u0026gt;\n  \u0026lt;/svcMenu\u0026gt;\n \u0026lt;/greeting\u0026gt;\n\u0026lt;/epp\u0026gt;\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2014-05-09T01:31:35Z",
	"updated_at": "2014-12-22T06:34:23Z"
}
