{
	"id": 153140192,
	"number": 15549,
	"state": "closed",
	"title": "gccgo with ld.gold: panic when running code that works with go 1.6.1",
	"body": "Please answer these questions before submitting your issue. Thanks!\r\n\r\n1. What version of Go are you using (`go version`)?\r\n```\r\n$ gccgo go version\r\ngo version go1.6.1 gccgo (GCC) 6.1.0 linux/amd64\r\n```\r\n\r\n2. What operating system and processor architecture are you using (`go env`)?\r\n```\r\n$ gccgo go env\r\nGOARCH=\"amd64\"\r\nGOBIN=\"\"\r\nGOEXE=\"\"\r\nGOHOSTARCH=\"amd64\"\r\nGOHOSTOS=\"linux\"\r\nGOOS=\"linux\"\r\nGOPATH=\"/home/tamird/src/go\"\r\nGORACE=\"\"\r\nGOROOT=\"/opt/gccgo\"\r\nGOTOOLDIR=\"/opt/gccgo/libexec/gcc/x86_64-pc-linux-gnu/6.1.0\"\r\nGO15VENDOREXPERIMENT=\"1\"\r\nCC=\"/opt/gccgo/bin/gcc\"\r\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\r\nCXX=\"/opt/gccgo/bin/g++\"\r\nCGO_ENABLED=\"1\"\r\n```\r\n\r\n3. What did you do?\r\n```\r\n$ gccgo go test github.com/cockroachdb/cockroach/sql -bench=BenchmarkBank2_Cockroach -benchmem -run=NONE -gccgoflags='-Xlinker --allow-multiple-definition'\r\n```\r\nNote I had to first delete `github.com/cockroachdb/cockroach/sql/{parallel,logic}_test.go` due to #15544.\r\nNote I had to use `-gccgoflags='-Xlinker --allow-multiple-definition` due to #15547.\r\n\r\n4. What did you expect to see?\r\n```\r\nBenchmarkBank2_Cockroach     5357452 ns/op          434579 B/op       6732 allocs/op\r\nPASS\r\nok      github.com/cockroachdb/cockroach/sql    2.082s\r\n```\r\n\r\n5. What did you see instead?\r\n```\r\nI160504 23:34:59.238068 rand.go:76  Random seed: 2750415068627718676\r\nPASS\r\nBenchmarkBank2_Cockroach        W160504 23:34:59.254597 gossip/gossip.go:892  not connected to cluster; use --join to specify a connected node\r\nI160504 23:34:59.262987 storage/engine/rocksdb.go:137  opening in memory rocksdb instance\r\nfatal error: unexpected signal during runtime execution\r\n[signal 0xb code=0x1 addr=0x0]\r\n\r\ngoroutine 26 [syscall]:\r\nruntime_dopanic\r\n        ../../../gcc-6.1.0/libgo/runtime/panic.c:131\r\nruntime_throw\r\n        ../../../gcc-6.1.0/libgo/runtime/panic.c:193\r\nsig_panic_leadin\r\n        ../../../gcc-6.1.0/libgo/runtime/go-signal.c:249\r\nsig_panic_info_handler\r\n        ../../../gcc-6.1.0/libgo/runtime/go-signal.c:283\r\n\r\n        :0\r\n_ZN6google8protobuf16RepeatedPtrFieldINS0_7MessageEED4Ev\r\n        internal/src/google/protobuf/repeated_field.h:1793\r\n_ZN6google8protobuf8internal21arena_destruct_objectINS0_16RepeatedPtrFieldINS0_7MessageEEEEEvPv\r\n        internal/src/google/protobuf/arena.h:74\r\ncreated by testing.run.pN9_testing.B\r\n        ../../../gcc-6.1.0/libgo/go/testing/benchmark.go:190\r\n\r\ngoroutine 16 [chan receive]:\r\nruntime_mcall\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:295\r\nchanrecv\r\n        ../../../gcc-6.1.0/libgo/runtime/chan.goc:269\r\ntesting.run.pN9_testing.B\r\n        ../../../gcc-6.1.0/libgo/go/testing/benchmark.go:191\r\ntesting.RunBenchmarks\r\n        ../../../gcc-6.1.0/libgo/go/testing/benchmark.go:343\r\ntesting.Run.pN9_testing.M\r\n        ../../../gcc-6.1.0/libgo/go/testing/testing.go:523\r\ngithub_com_cockroachdb_cockroach_sql_test.TestMain\r\n        /home/tamird/src/go/src/github.com/cockroachdb/cockroach/sql/main_test.go:238\r\nmain.main\r\n        /tmp/go-build987433693/github.com/cockroachdb/cockroach/sql/_test/_testmain.go:504\r\nruntime_main\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:626\r\ncreated by main\r\n        ../../../gcc-6.1.0/libgo/runtime/go-main.c:54\r\n\r\ngoroutine 17 [syscall]:\r\n        goroutine in C code; stack unavailable\r\ncreated by runtime_main\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:598\r\n\r\ngoroutine 18 [finalizer wait]:\r\nruntime_mcall\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:295\r\nrunfinq\r\n        ../../../gcc-6.1.0/libgo/runtime/mgc0.c:2512\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:235\r\ncreated by\r\n        ../../../gcc-6.1.0/libgcc/config/i386/morestack.S:544\r\n\r\ngoroutine 19 [syscall]:\r\n        goroutine in C code; stack unavailable\r\ncreated by\r\n        ../../../gcc-6.1.0/libgcc/config/i386/morestack.S:544\r\n\r\ngoroutine 24 [chan receive]:\r\nruntime_mcall\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:295\r\nchanrecv\r\n        ../../../gcc-6.1.0/libgo/runtime/chan.goc:299\r\nruntime.chanrecv2\r\n        ../../../gcc-6.1.0/libgo/runtime/chan.goc:384\r\ngithub_com_cockroachdb_cockroach_util_log.flushDaemon.pN50_github_com_cockroachdb_cockroach_util_log.loggingT\r\n        /home/tamird/src/go/src/github.com/cockroachdb/cockroach/util/log/clog.go:1011\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:235\r\ncreated by\r\n        ../../../gcc-6.1.0/libgcc/config/i386/morestack.S:544\r\n\r\ngoroutine 25 [GC sweep wait]:\r\nruntime_mcall\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:295\r\nbgsweep\r\n        ../../../gcc-6.1.0/libgo/runtime/mgc0.c:1844\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:235\r\ncreated by mgc\r\n        ../../../gcc-6.1.0/libgo/runtime/mgc0.c:2215\r\n\r\ngoroutine 27 [runnable]:\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:232\r\ncreated by github_com_cockroachdb_cockroach_util_stop.RunWorker.pN50_github_com_cockroachdb_cockroach_util_stop.Stopper\r\n        /home/tamird/src/go/src/github.com/cockroachdb/cockroach/util/stop/stopper.go:137\r\n\r\ngoroutine 28 [runnable]:\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:232\r\ncreated by github_com_cockroachdb_cockroach_util_stop.RunWorker.pN50_github_com_cockroachdb_cockroach_util_stop.Stopper\r\n        /home/tamird/src/go/src/github.com/cockroachdb/cockroach/util/stop/stopper.go:137\r\n\r\ngoroutine 29 [runnable]:\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:232\r\ncreated by github_com_cockroachdb_cockroach_util_stop.RunWorker.pN50_github_com_cockroachdb_cockroach_util_stop.Stopper\r\n        /home/tamird/src/go/src/github.com/cockroachdb/cockroach/util/stop/stopper.go:137\r\n\r\ngoroutine 30 [runnable]:\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:232\r\ncreated by github_com_cockroachdb_cockroach_util_stop.RunWorker.pN50_github_com_cockroachdb_cockroach_util_stop.Stopper\r\n        /home/tamird/src/go/src/github.com/cockroachdb/cockroach/util/stop/stopper.go:137\r\n\r\ngoroutine 31 [runnable]:\r\nkickoff\r\n        ../../../gcc-6.1.0/libgo/runtime/proc.c:232\r\ncreated by github_com_cockroachdb_cockroach_util_stop.RunWorker.pN50_github_com_cockroachdb_cockroach_util_stop.Stopper\r\n        /home/tamird/src/go/src/github.com/cockroachdb/cockroach/util/stop/stopper.go:137\r\nexit status 2\r\nFAIL    github.com/cockroachdb/cockroach/sql    0.250s\r\n```",
	"user": {
		"login": "tamird",
		"id": 1535036,
		"type": "User",
		"site_admin": false
	},
	"assignee": {
		"login": "thanm",
		"id": 12280172,
		"type": "User",
		"site_admin": false
	},
	"comments": 19,
	"closed_at": "2016-07-29T16:10:43Z",
	"created_at": "2016-05-04T23:40:29Z",
	"updated_at": "2016-07-29T16:10:43Z",
	"milestone": {
		"id": 1069171,
		"number": 23,
		"title": "Gccgo"
	}
}
