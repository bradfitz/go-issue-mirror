{
	"id": 63791615,
	"number": 10223,
	"state": "closed",
	"title": "runtime: writebarrierptr_nostore1 called with mp.p == nil",
	"body": "windows-amd64 just failed in runtime/pprof tests with:\r\n\r\nhttp://build.golang.org/log/15ccbe982c8df1a9416adcd42f773b2d812f2fc6\r\n```\r\nfatal error: writebarrierptr_nostore1 called with mp.p == nil\r\n\r\nruntime stack:\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:543 +0xa0\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f373b0)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f37610)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f37870)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f37ad0)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f37d30)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f37f90)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f381f0)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f38450)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\nruntime.writebarrierptr_nostore1.func1()\r\n\tC:/workdir/go/src/runtime/mbarrier.go:108 +0x119\r\nruntime.systemstack(0x3f386b0)\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:278 +0xb5\r\nruntime.writebarrierptr_nostore1(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:112 +0x57\r\nruntime.writebarrierptr(0xc082001368, 0xc082016fc0)\r\n\tC:/workdir/go/src/runtime/mbarrier.go:135 +0x9d\r\nruntime.stdcall(0x76dccba0, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:374 +0x51\r\nruntime.stdcall1(0x76dccba0, 0xfffffffffffffff4, 0x0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:398 +0x3d\r\nruntime.write(0x2, 0x713fb0, 0xd, 0x713fb0)\r\n\tC:/workdir/go/src/runtime/os1_windows.go:252 +0x9d\r\nruntime.writeErr(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1_write.go:12 +0x49\r\nruntime.gwrite(0x713fb0, 0xd, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:58 +0x179\r\nruntime.printstring(0x713fb0, 0xd)\r\n\tC:/workdir/go/src/runtime/print1.go:214 +0x18c\r\nruntime.throw(0x758190, 0x30)\r\n\tC:/workdir/go/src/runtime/panic.go:537 +0x27\r\n...additional frames elided...\r\n\r\ngoroutine 1 [chan receive]:\r\ntesting.RunTests(0x7848c8, 0x11fc0e0, 0xe, 0xe, 0x4afe01)\r\n\tC:/workdir/go/src/testing/testing.go:561 +0xce2\r\ntesting.(*M).Run(0xc08200c280, 0x12218c0)\r\n\tC:/workdir/go/src/testing/testing.go:490 +0xf5\r\nmain.main()\r\n\tC:/Users/WINGOP~1/AppData/Local/Temp/go-build545502822/runtime/pprof/_test/_testmain.go:82 +0x294\r\n\r\ngoroutine 17 [syscall, locked to thread]:\r\nruntime.goexit()\r\n\tC:/workdir/go/src/runtime/asm_amd64.s:2466 +0x1\r\n\r\ngoroutine 58 [garbage collection]:\r\nruntime.GC()\r\n\tC:/workdir/go/src/runtime/mgc.go:225 +0x2e\r\nruntime/pprof_test.TestTraceStress(0xc08204ea20)\r\n\tC:/workdir/go/src/runtime/pprof/trace_test.go:141 +0x4a7\r\ntesting.tRunner(0xc08204ea20, 0x11fc1e8)\r\n\tC:/workdir/go/src/testing/testing.go:452 +0x104\r\ncreated by testing.RunTests\r\n\tC:/workdir/go/src/testing/testing.go:560 +0xc8c\r\n\r\ngoroutine 61 [trace reader (blocked)]:\r\nruntime.ReadTrace(0x0, 0x0, 0x0)\r\n\tC:/workdir/go/src/runtime/trace.go:313 +0x244\r\nruntime/pprof.StartTrace.func1(0x2fe97d0, 0xc08202aa80)\r\n\tC:/workdir/go/src/runtime/pprof/pprof.go:629 +0x34\r\ncreated by runtime/pprof.StartTrace\r\n\tC:/workdir/go/src/runtime/pprof/pprof.go:635 +0x9a\r\n\r\ngoroutine 41 [select (no cases)]:\r\nruntime/pprof_test.TestTraceSymbolize.func1()\r\n\tC:/workdir/go/src/runtime/pprof/trace_stack_test.go:38 +0x34\r\ncreated by runtime/pprof_test.TestTraceSymbolize\r\n\tC:/workdir/go/src/runtime/pprof/trace_stack_test.go:39 +0x1f8\r\n\r\ngoroutine 42 [chan send (nil chan)]:\r\nruntime/pprof_test.TestTraceSymbolize.func2()\r\n\tC:/workdir/go/src/runtime/pprof/trace_stack_test.go:42 +0x59\r\ncreated by runtime/pprof_test.TestTraceSymbolize\r\n\tC:/workdir/go/src/runtime/pprof/trace_stack_test.go:43 +0x211\r\n\r\ngoroutine 43 [chan receive (nil chan)]:\r\nruntime/pprof_test.TestTraceSymbolize.func3()\r\n\tC:/workdir/go/src/runtime/pprof/trace_stack_test.go:46 +0x4f\r\ncreated by runtime/pprof_test.TestTraceSymbolize\r\n\tC:/workdir/go/src/runtime/pprof/trace_stack_test.go:47 +0x22a\r\n\r\ngoroutine 59 [chan receive]:\r\nruntime/pprof_test.TestTraceStress.func1(0xc0820d6c60, 0xc08214e980)\r\n\tC:/workdir/go/src/runtime/pprof/trace_test.go:99 +0x52\r\ncreated by runtime/pprof_test.TestTraceStress\r\n\tC:/workdir/go/src/runtime/pprof/trace_test.go:101 +0xea\r\n\r\ngoroutine 60 [syscall, locked to thread]:\r\nsyscall.Syscall6(0x76dc09c0, 0x5, 0x170, 0xc082145f20, 0x1, 0xc0820f9e6c, 0x0, 0x0, 0x0, 0x0, ...)\r\n\tC:/workdir/go/src/runtime/syscall_windows.go:139 +0x7b\r\nsyscall.ReadFile(0x170, 0xc082145f20, 0x1, 0x1, 0xc0820f9e6c, 0x0, 0x0, 0x0)\r\n\tC:/workdir/go/src/syscall/zsyscall_windows.go:283 +0xed\r\nsyscall.Read(0x170, 0xc082145f20, 0x1, 0x1, 0x1, 0x0, 0x0)\r\n\tC:/workdir/go/src/syscall/syscall_windows.go:286 +0x8d\r\nos.(*File).read(0xc0820201d8, 0xc082145f20, 0x1, 0x1, 0x0, 0x0, 0x0)\r\n\tC:/workdir/go/src/os/file_windows.go:299 +0x1de\r\nos.(*File).Read(0xc0820201d8, 0xc082145f20, 0x1, 0x1, 0x1, 0x0, 0x0)\r\n\tC:/workdir/go/src/os/file.go:95 +0xc7\r\nruntime/pprof_test.TestTraceStress.func3(0xc0820201d8, 0xc0820d6c60, 0xc08214e980)\r\n\tC:/workdir/go/src/runtime/pprof/trace_test.go:115 +0xa0\r\ncreated by runtime/pprof_test.TestTraceStress\r\n\tC:/workdir/go/src/runtime/pprof/trace_test.go:118 +0x2c0\r\n\r\ngoroutine 66 [runnable]:\r\nruntime/pprof_test.TestTraceStress.func4(0xc0820d6c60)\r\n\tC:/workdir/go/src/runtime/pprof/trace_test.go:129\r\ncreated by runtime/pprof_test.TestTraceStress\r\n\tC:/workdir/go/src/runtime/pprof/trace_test.go:139 +0x4a2\r\nFAIL\truntime/pprof\t12.237s\r\n```\r\n\r\n/cc @aclements @RLH @rsc @dvyukov ",
	"user": {
		"login": "bradfitz",
		"id": 2621,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 6,
	"closed_at": "2015-03-24T18:50:19Z",
	"created_at": "2015-03-23T18:04:02Z",
	"updated_at": "2016-06-25T02:03:48Z",
	"milestone": {
		"id": 905105,
		"number": 1,
		"title": "Go1.5"
	}
}
