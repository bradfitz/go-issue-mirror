{
	"id": 51278118,
	"number": 1650,
	"state": "closed",
	"title": "bufio crash on 386",
	"body": "\u003cpre\u003egodoc crashes with the stack trace below. I was able to reproduce it after few restarts.\n\n$ godoc -http=:6060\nthrow: malloc/free - deadlock\n\n[signal 0xb code=0x1 addr=0x0 pc=0x8065b3e]\n\nruntime.throw+0x43 /home/fhs/go/src/pkg/runtime/runtime.c:102\n\truntime.throw(0x8305fb0, 0x0)\nruntime.mallocgc+0x67 /home/fhs/go/src/pkg/runtime/malloc.c:36\n\truntime.mallocgc(0x8, 0x0, 0x1, 0x1, 0x1, ...)\nruntime.mal+0x43 /home/fhs/go/src/pkg/runtime/malloc.c:289\n\truntime.mal(0x8, 0x8070175)\ncopyin+0x64 /home/fhs/go/src/pkg/runtime/iface.c:160\n\tcopyin(0x816907c, 0x8776b780, 0x8776b78c, 0x8315d68)\nruntime.convT2E+0x46 /home/fhs/go/src/pkg/runtime/iface.c:209\n\truntime.convT2E(0x816907c, 0x83059ef)\nruntime.newErrorString+0x34 /home/fhs/go/src/pkg/runtime/error.go:107\n\truntime.newErrorString(0x83059ef, 0x31, 0x8776b7c0, 0x8718670)\nruntime.panicstring+0x81 /home/fhs/go/src/pkg/runtime/runtime.c:115\n\truntime.panicstring(0x83059ef, 0xb7777ff0)\nruntime.sigpanic+0x11b /home/fhs/go/src/pkg/runtime/linux/thread.c:292\n\truntime.sigpanic()\nruntime.MCache_Alloc+0x96 /home/fhs/go/src/pkg/runtime/mcache.c:29\n\truntime.MCache_Alloc(0x877a82f8, 0x2, 0x10, 0x1, 0x8776b890, ...)\nruntime.mallocgc+0xe1 /home/fhs/go/src/pkg/runtime/malloc.c:47\n\truntime.mallocgc(0x10, 0x1, 0x1, 0x1, 0x1, ...)\nmakeslice1+0x71 /home/fhs/go/src/pkg/runtime/slice.c:44\n\tmakeslice1(0x816fcf8, 0x0, 0x4, 0x8776b890, 0xe56902, ...)\nruntime.makeslice+0x95 /home/fhs/go/src/pkg/runtime/slice.c:24\n\truntime.makeslice(0x816fcf8, 0x0, 0x0, 0x4, 0x0, ...)\nindex/suffixarray.*suffixSortable·updateGroups+0x53\n/home/fhs/go/src/pkg/index/suffixarray/qsufsort.go:149\n\tindex/suffixarray.*suffixSortable·updateGroups(0x9d5821a0, 0x13324e, 0x9d5821a0)\nindex/suffixarray.qsufsort+0x285 /home/fhs/go/src/pkg/index/suffixarray/qsufsort.go:58\n\tindex/suffixarray.qsufsort(0x9c28b000, 0xf4bf3e, 0x11ffe00, 0x0, 0x806dd95, ...)\nindex/suffixarray.New+0x49 /home/fhs/go/src/pkg/index/suffixarray/suffixarray.go:36\n\tindex/suffixarray.New(0x9c28b000, 0xf4bf3e, 0x11ffe00, 0x11ffe00, 0x0, ...)\nmain.NewIndex+0x5b7 /home/fhs/go/src/cmd/godoc/index.go:863\n\tmain.NewIndex(0x97d6e000, 0x120fa001, 0x0, 0x0)\nmain.indexer+0xcf /home/fhs/go/src/cmd/godoc/godoc.go:1268\n\tmain.indexer()\nruntime.goexit /home/fhs/go/src/pkg/runtime/proc.c:178\n\truntime.goexit()\n----- goroutine created by -----\nmain.main+0x608 /home/fhs/go/src/cmd/godoc/main.go:287\n\ngoroutine 191 [4]:\nruntime.gosched+0x6d /home/fhs/go/src/pkg/runtime/proc.c:600\n\truntime.gosched()\nrunfinq+0x4e /home/fhs/go/src/pkg/runtime/mgc0.c:639\n\trunfinq()\nruntime.goexit /home/fhs/go/src/pkg/runtime/proc.c:178\n\truntime.goexit()\n----- goroutine created by -----\nruntime.gc /home/fhs/go/src/pkg/runtime/mgc0.c:515\n\ngoroutine 5 [3]:\nruntime.entersyscall+0x18 /home/fhs/go/src/pkg/runtime/proc.c:620\n\truntime.entersyscall()\nsyscall.Syscall6+0x5 /home/fhs/go/src/pkg/syscall/asm_linux_386.s:39\n\tsyscall.Syscall6()\nsyscall.EpollWait+0x74 /home/fhs/go/src/pkg/syscall/zsyscall_linux_386.go:200\n\tsyscall.EpollWait(0x7, 0x977fbf08, 0xa, 0xa, 0xffffffff, ...)\nnet.*pollster·WaitFD+0x147 /home/fhs/go/src/pkg/net/fd_linux.go:130\n\tnet.*pollster·WaitFD(0x977fbf00, 0x97815660, 0x0, 0x0, 0x0, ...)\nnet.*pollServer·Run+0x10a /home/fhs/go/src/pkg/net/fd.go:226\n\tnet.*pollServer·Run(0x97815660, 0x0)\nruntime.goexit /home/fhs/go/src/pkg/runtime/proc.c:178\n\truntime.goexit()\n----- goroutine created by -----\nnet.newPollServer+0x344 /home/fhs/go/src/pkg/net/newpollserver.go:39\n\ngoroutine 1 [4]:\nruntime.gosched+0x6d /home/fhs/go/src/pkg/runtime/proc.c:600\n\truntime.gosched()\nruntime.chanrecv+0x153 /home/fhs/go/src/pkg/runtime/chan.c:377\n\truntime.chanrecv(0x97866ec0, 0x87768620, 0x0, 0x0, 0x8308b64, ...)\nruntime.chanrecv1+0x3f /home/fhs/go/src/pkg/runtime/chan.c:439\n\truntime.chanrecv1(0x97866ec0, 0x9789d000)\nnet.*pollServer·WaitRead+0x4a /home/fhs/go/src/pkg/net/fd.go:255\n\tnet.*pollServer·WaitRead(0x97815660, 0x9789d000, 0x0)\nnet.*netFD·accept+0x2fe /home/fhs/go/src/pkg/net/fd.go:586\n\tnet.*netFD·accept(0x9789d000, 0x8118f09, 0x0, 0x0, 0x0, ...)\nnet.*TCPListener·AcceptTCP+0x56 /home/fhs/go/src/pkg/net/tcpsock.go:261\n\tnet.*TCPListener·AcceptTCP(0x97811268, 0x8065078, 0x0, 0x0)\nnet.*TCPListener·Accept+0x39 /home/fhs/go/src/pkg/net/tcpsock.go:271\n\tnet.*TCPListener·Accept(0x97811268, 0x0, 0x0, 0x0, 0x0, ...)\nhttp.*Server·Serve+0xb5 /home/fhs/go/src/pkg/http/server.go:761\n\thttp.*Server·Serve(0x97870220, 0x978900a0, 0x97811268, 0x0, 0x0, ...)\nhttp.*Server·ListenAndServe+0xb5 /home/fhs/go/src/pkg/http/server.go:748\n\thttp.*Server·ListenAndServe(0x97870220, 0x97870220, 0x0)\nhttp.ListenAndServe+0x55 /home/fhs/go/src/pkg/http/server.go:809\n\thttp.ListenAndServe(0xbfce390f, 0x5, 0x97820d80, 0x977c82e0, 0x977c82e0, ...)\nmain.main+0x629 /home/fhs/go/src/cmd/godoc/main.go:290\n\tmain.main()\nruntime.mainstart+0xf /home/fhs/go/src/pkg/runtime/386/asm.s:93\n\truntime.mainstart()\nruntime.goexit /home/fhs/go/src/pkg/runtime/proc.c:178\n\truntime.goexit()\n----- goroutine created by -----\n_rt0_386+0xc1 /home/fhs/go/src/pkg/runtime/386/asm.s:80\n$\n\n\nWhich compiler are you using (5g, 6g, 8g, gccgo)?\n\n8g\n\nWhich operating system are you using?\n\nLinux\n\nWhich revision are you using?  (hg identify)\n\nb84e614e2516+ weekly/weekly.2011-03-28\u003c/pre\u003e",
	"user": {
		"login": "fhs",
		"id": 183501,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"assignee": {
		"login": "rsc",
		"id": 104030,
		"type": "User",
		"site_admin": false
	},
	"comments": 15,
	"closed_at": "2014-12-08T10:09:16Z",
	"created_at": "2011-03-29T22:06:35Z",
	"updated_at": "2016-06-24T19:27:01Z"
}
