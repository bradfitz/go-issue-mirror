{
	"id": 66064507,
	"body": "\u003ca id=\"c3\"\u003e\u003c/a\u003eComment 3:\n\n\u003cpre\u003eFound a way to get the static linked object files names:\ngcc -Wl,-t popcnt.c (based on gccbuiltin.go)\n\nSample output on Linux:\n/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crt1.o\n/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crti.o\n/usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtbegin.o\n/tmp/ccybkK4V.o\n(/usr/lib/gcc/x86_64-redhat-linux/4.1.2/libgcc.a)_popcountsi2.o\n(/usr/lib/gcc/x86_64-redhat-linux/4.1.2/libgcc.a)_popcount_tab.o\n-lgcc_s (/usr/lib/gcc/x86_64-redhat-linux/4.1.2/libgcc_s.so)\n/lib64/libc.so.6\n(/usr/lib64/libc_nonshared.a)elf-init.oS\n/lib64/ld-linux-x86-64.so.2\n-lgcc_s (/usr/lib/gcc/x86_64-redhat-linux/4.1.2/libgcc_s.so)\n/usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtend.o\n/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crtn.o\n\nSample output on FreeBSD:\n/usr/bin/ld: mode elf_x86_64_fbsd\n/usr/lib/crt1.o\n/usr/lib/crti.o\n/usr/lib/crtbegin.o\n/var/tmp//cpXjI9Cv.o\n(/usr/lib/libgcc.a)popcountdi2.o\n-lgcc_s (/usr/lib/libgcc_s.so)\n-lc (/usr/lib/libc.so)\n-lgcc_s (/usr/lib/libgcc_s.so)\n/usr/lib/crtend.o\n/usr/lib/crtn.o\n\nSample output on Windows:\nc:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../../mingw32/bin/ld.exe: mode i386pe\nc:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../crt2.o\nc:/mingw/bin/../lib/gcc/mingw32/4.6.2/crtbegin.o\nC:\\Users\\minux\\AppData\\Local\\Temp\\ccM49pK1.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)tlssup.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)CRTglob.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)CRTfmode.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)txtmode.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)cpu_features.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)CRT_fp10.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)pseudo-reloc.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)gccmain.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)crtst.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)tlsthrd.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmingw32.a)pseudo-reloc-list.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/libgcc.a)_popcountsi2.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/libgcc.a)_ctors.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/libgcc.a)_popcount_tab.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmsvcrt.a)dcfls00266.o\n[ snip ]\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libmsvcrt.a)dcflt.o\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libkernel32.a)dchds01140.o\n[ snip ]\n(c:/mingw/bin/../lib/gcc/mingw32/4.6.2/../../../libkernel32.a)dchdt.o\nc:/mingw/bin/../lib/gcc/mingw32/4.6.2/crtend.o\n\n\nThis works on Linux, FreeBSD and Windows (on Mac OS X, libgcc is contained in libSystem,\nso it worked out of the box). The only complication is, well, how to filter out objects\nthat\nwe don't want, esp. on Windows. I think we can use a library whitelist for now.\n(although these file are static linked, we require them to be compiled -fPIC, so this\nlimits\nthe generality of this approach. But I think it is OK for now.)\n\nStill need to diagnose why after I manually pack the required object files into\nruntime/cgo.a,\nthe link still fails.\u003c/pre\u003e",
	"user": {
		"login": "minux",
		"id": 135652,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2012-03-10T18:33:48Z",
	"updated_at": "2014-12-08T10:16:58Z"
}
