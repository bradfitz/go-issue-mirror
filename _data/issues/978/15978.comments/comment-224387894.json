{
	"id": 224387894,
	"body": "Here is a sample of what fsutil reparsepoint query shows on Windows Server 2016 TP4 : \r\n\r\nWindows PowerShell\r\nCopyright (C) 2015 Microsoft Corporation. All rights reserved.\r\n\r\nPS C:\\Windows\\system32\u003e dir c:\\tools\r\n\r\n\r\n    Directory: C:\\tools\r\n\r\n\r\nMode                LastWriteTime         Length Name\r\n----                -------------         ------ ----\r\nd-----         6/2/2016   5:02 PM                src\r\n\r\n\r\nPS C:\\Windows\\system32\u003e fsutil reparsepoint query c:\\tools\r\nReparse Tag Value : 0xa000000c\r\nTag value: Microsoft\r\nTag value: Name Surrogate\r\nTag value: Symbolic Link\r\n\r\nReparse Data Length: 0x00000116\r\nReparse Data:\r\n0000:  00 00 80 00 82 00 86 00  00 00 00 00 5c 00 43 00  ............\\.C.\r\n0010:  6f 00 6e 00 74 00 61 00  69 00 6e 00 65 00 72 00  o.n.t.a.i.n.e.r.\r\n0020:  4d 00 61 00 70 00 70 00  65 00 64 00 44 00 69 00  M.a.p.p.e.d.D.i.\r\n0030:  72 00 65 00 63 00 74 00  6f 00 72 00 69 00 65 00  r.e.c.t.o.r.i.e.\r\n0040:  73 00 5c 00 45 00 36 00  44 00 35 00 46 00 45 00  s.\\.E.6.D.5.F.E.\r\n0050:  44 00 46 00 2d 00 32 00  46 00 37 00 30 00 2d 00  D.F.-.2.F.7.0.-.\r\n0060:  34 00 42 00 35 00 43 00  2d 00 41 00 31 00 43 00  4.B.5.C.-.A.1.C.\r\n0070:  37 00 2d 00 33 00 37 00  44 00 33 00 30 00 46 00  7.-.3.7.D.3.0.F.\r\n0080:  38 00 45 00 38 00 45 00  43 00 45 00 00 00 5c 00  8.E.8.E.C.E...\\.\r\n0090:  5c 00 3f 00 5c 00 43 00  6f 00 6e 00 74 00 61 00  \\.?.\\.C.o.n.t.a.\r\n00a0:  69 00 6e 00 65 00 72 00  4d 00 61 00 70 00 70 00  i.n.e.r.M.a.p.p.\r\n00b0:  65 00 64 00 44 00 69 00  72 00 65 00 63 00 74 00  e.d.D.i.r.e.c.t.\r\n00c0:  6f 00 72 00 69 00 65 00  73 00 5c 00 45 00 36 00  o.r.i.e.s.\\.E.6.\r\n00d0:  44 00 35 00 46 00 45 00  44 00 46 00 2d 00 32 00  D.5.F.E.D.F.-.2.\r\n00e0:  46 00 37 00 30 00 2d 00  34 00 42 00 35 00 43 00  F.7.0.-.4.B.5.C.\r\n00f0:  2d 00 41 00 31 00 43 00  37 00 2d 00 33 00 37 00  -.A.1.C.7.-.3.7.\r\n0100:  44 00 33 00 30 00 46 00  38 00 45 00 38 00 45 00  D.3.0.F.8.E.8.E.\r\n0110:  43 00 45 00 00 00                                 C.E...\r\nPS C:\\Windows\\system32\u003e\r\n\r\n\r\nHere is a different symbolic link on Windows 10 : \r\n\r\n\r\nPS E:\\temp\u003e fsutil reparsepoint query t1\r\nReparse Tag Value : 0xa000000c\r\nTag value: Microsoft\r\nTag value: Name Surrogate\r\nTag value: Symbolic Link\r\n\r\nReparse Data Length: 0x00000060\r\nReparse Data:\r\n0000:  2a 00 2a 00 00 00 2a 00  00 00 00 00 5c 00 5c 00  *.*...*.....\\.\\.\r\n0010:  3f 00 5c 00 65 00 3a 00  5c 00 74 00 65 00 6d 00  ?.\\.e.:.\\.t.e.m.\r\n0020:  70 00 5c 00 73 00 6f 00  6d 00 65 00 77 00 68 00  p.\\.s.o.m.e.w.h.\r\n0030:  65 00 72 00 65 00 5c 00  3f 00 3f 00 5c 00 65 00  e.r.e.\\.?.?.\\.e.\r\n0040:  3a 00 5c 00 74 00 65 00  6d 00 70 00 5c 00 73 00  :.\\.t.e.m.p.\\.s.\r\n0050:  6f 00 6d 00 65 00 77 00  68 00 65 00 72 00 65 00  o.m.e.w.h.e.r.e.\r\n\r\n\r\nThe Problem is demonstrated in the first 16 bytes from each Operating System : \r\nWS 2016 :  0000:  00 00 80 00 82 00 86 00  00 00 00 00 5c 00 43 00  ............\\.C.\r\nWindows 10:  0000:  2a 00 2a 00 00 00 2a 00  00 00 00 00 5c 00 5c 00  *.*...*.....\\.\\.\r\n\r\nWhat has happened is that the 'PrintName' and 'SubstituteName' in the dynamic portion of the result have swapped positions, so now PrintNameOffset is non-zero on Windows Server 2016.   This exposes the substraction result producing a bogus slice.  My guess is in all other operating systems, (i.e. Windows 10) the PrintName field was placed first, meaning that PrintNameOffset was always zero, concealing the bug.\r\n\r\n",
	"user": {
		"login": "nkaethler",
		"id": 16143726,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-06-07T19:28:11Z",
	"updated_at": "2016-06-07T19:28:11Z"
}
