{
	"id": 181284033,
	"body": "@alexbrainman Thanks for the feedback. And please excuse the confusion I produced, I'll try to be more systematic.\r\n\r\nI think the Go code itself is **okay** and **works** **properly**.\r\n\r\nBut the test code executes `netstat` and `getmac` commands and parses their output and I believe this to be not robust enough. Actually these are two different non-robust tests; sorry for mixing these up in one issue.\r\n\r\nI verified the following on go1.6rc1 and go1.6rc2 with a clean Go source tree and a (halfway freshly booted Windows 7 Enterprise Service Pack 1 with VMware Player 7.1.2 build-2780323 installed).\r\n\r\n### TestInterfaceAddrsWithNetsh\r\n\r\n    --- FAIL: TestInterfaceAddrsWithNetsh (13.02s)\r\n        net_windows_test.go:446: VMware Network Adapter VMnet8: unexpected addresses list [\"192.168.209.1/24\" \"fe80::1587:c020:5827:b719\"], want []\r\n\r\nbut the problem is not the Go code as \"192.168.209.1/24\" is fine as it **is** the proper address as can be seen by running:\r\n\r\n    $ netsh interface ipv4 show address | grep -A 4 \"VMware Network Adapter VMnet8\"\r\n    Configuration for interface \"VMware Network Adapter VMnet8\"\r\n        DHCP enabled:                         No\r\n        IP Address:                           192.168.209.1\r\n        Subnet Prefix:                        192.168.209.0/24 (mask 255.255.255.0)\r\n        InterfaceMetric:                      20\r\n\r\nUnfortunately the test code tries to get the address by executing\r\n\r\n    $ netsh interface ipv4 show address name=\"VMware Network Adapter VMnet8\"\r\n\r\nwhich returns 0 but prints just one blank line:\r\n\r\n    $ netsh interface ipv4 show address name=\"VMware Network Adapter VMnet8\" | od -ta\r\n    0000000  cr  nl\r\n    0000002\r\n\r\nThis is strange and clearly a Windows-only, maybe even a \"my-computer-only\" problem.\r\n\r\nThe test code relies on the fact that `netsh name=\"_the-name_\"` really returns sensible data which is not the case for my VMware Network Adapter VMnet8\r\n\r\nMaybe parsing the whole output of `netsh interface ipv4 show address` could make the test more robust.\r\n\r\n### TestInterfaceHardwareAddrWithGetmac\r\n\r\nIf I disable (through Control Panel\\Network and Internet\\Network Connections) \"VMware Network Adapter VMnet8\" and have the wireless network turned off via the hardware switch then:\r\n\r\n    --- FAIL: TestInterfaceHardwareAddrWithGetmac (3.17s)\r\n        net_windows_test.go:515: getmac lists \"Bluetooth Network Connection\", but it could not be found among Go interfaces map[VirtualBox Host-Only Network #2:08:00:27:00:60:5e VirtualBox Host-Only Network #5:08:00:27:00:30:d5 VirtualBox Host-Only Network #6:08:00:27:00:54:f8 Teredo Tunneling Pseudo-Interface:00:00:00:00:00:00:00:e0 isatap.{7F1E7FEE-3396-49AD-B22F-9B6A81EB3729}:00:00:00:00:00:00:00:e0 Wireless Network Connection 2:82:86:f2:8e:55:a8 Local Area Connection 2:00:ad:e1:ac:1c:1a Local Area Connection:ec:f4:bb:35:28:68 isatap.{E4154231-E9E3-45E0-8275-1AF043445EC0}:00:00:00:00:00:00:00:e0 isatap.{A7C3755F-5CE1-4695-A67D-67C085D99088}:00:00:00:00:00:00:00:e0 isatap.{DD0440CD-133C-46D3-92ED-F6CE20D50AD4}:00:00:00:00:00:00:00:e0 VirtualBox Host-Only Network:08:00:27:00:10:b7 VMware Network Adapter VMnet1:00:50:56:c0:00:01 isatap.{FB7C9315-676D-4EAE-B550-CB8F59586F86}:00:00:00:00:00:00:00:e0 isatap.{9C819DC3-C04B-4D4C-904E-081E478C9765}:00:00:00:00:00:00:00:e0 isatap.{954555DC-152A-4369-8EA8-6CE0F48ACBE3}:00:00:00:00:00:00:00:e0 isatap.{6E13A897-4E51-4F7A-8809-1D5B29E0CDF6}:00:00:00:00:00:00:00:e0 isatap.{4A074996-3924-459F-BFCD-5970475AE151}:00:00:00:00:00:00:00:e0 Mobile Broadband Connection:00:a0:c6:00:00:12 VirtualBox Host-Only Network #3:08:00:27:00:fc:ba isatap.corp.unic.com:00:00:00:00:00:00:00:e0 isatap.{3160AADB-41E4-4A1A-B73F-D3FDBF455AE2}:00:00:00:00:00:00:00:e0 Wireless Network Connection:80:86:f2:8e:55:a8 VirtualBox Host-Only Network #4:08:00:27:00:8c:64 isatap.{4A17C321-4472-4A7C-A305-82158B608E7F}:00:00:00:00:00:00:00:e0]\r\n        net_windows_test.go:515: getmac lists \"VMware Network Adapter VMnet8\", but it could not be found among Go interfaces map[Mobile Broadband Connection:00:a0:c6:00:00:12 VirtualBox Host-Only Network #3:08:00:27:00:fc:ba isatap.corp.unic.com:00:00:00:00:00:00:00:e0 isatap.{9C819DC3-C04B-4D4C-904E-081E478C9765}:00:00:00:00:00:00:00:e0 isatap.{954555DC-152A-4369-8EA8-6CE0F48ACBE3}:00:00:00:00:00:00:00:e0 isatap.{6E13A897-4E51-4F7A-8809-1D5B29E0CDF6}:00:00:00:00:00:00:00:e0 isatap.{4A074996-3924-459F-BFCD-5970475AE151}:00:00:00:00:00:00:00:e0 Wireless Network Connection:80:86:f2:8e:55:a8 VirtualBox Host-Only Network #4:08:00:27:00:8c:64 isatap.{4A17C321-4472-4A7C-A305-82158B608E7F}:00:00:00:00:00:00:00:e0 isatap.{3160AADB-41E4-4A1A-B73F-D3FDBF455AE2}:00:00:00:00:00:00:00:e0 isatap.{7F1E7FEE-3396-49AD-B22F-9B6A81EB3729}:00:00:00:00:00:00:00:e0 Wireless Network Connection 2:82:86:f2:8e:55:a8 Local Area Connection 2:00:ad:e1:ac:1c:1a Local Area Connection:ec:f4:bb:35:28:68 VirtualBox Host-Only Network #2:08:00:27:00:60:5e VirtualBox Host-Only Network #5:08:00:27:00:30:d5 VirtualBox Host-Only Network #6:08:00:27:00:54:f8 Teredo Tunneling Pseudo-Interface:00:00:00:00:00:00:00:e0 VirtualBox Host-Only Network:08:00:27:00:10:b7 VMware Network Adapter VMnet1:00:50:56:c0:00:01 isatap.{FB7C9315-676D-4EAE-B550-CB8F59586F86}:00:00:00:00:00:00:00:e0 isatap.{E4154231-E9E3-45E0-8275-1AF043445EC0}:00:00:00:00:00:00:00:e0 isatap.{A7C3755F-5CE1-4695-A67D-67C085D99088}:00:00:00:00:00:00:00:e0 isatap.{DD0440CD-133C-46D3-92ED-F6CE20D50AD4}:00:00:00:00:00:00:00:e0]\r\n    FAIL\r\n       \r\nRunning getmac:\r\n\r\n    $ getmac /fo list /v | grep -A 3 -E \"VMnet8|Blue\"\r\n    Connection Name:  Bluetooth Network Connection\r\n    Network Adapter:  Bluetooth Device (Personal Area Network)\r\n    Physical Address: N/A\r\n    Transport Name:   Hardware not present\r\n    \r\n    --\r\n    Connection Name:  VMware Network Adapter VMnet8\r\n    Network Adapter:  VMware Virtual Ethernet Adapter for VMnet8\r\n    Physical Address: Disabled\r\n    Transport Name:   Disconnected\r\n\r\nIf I peek at  TestInterfaceHardwareAddrWithGetmac around line 507 there is no code to test for the string \"Disabled\" or \"N/A\" as a value for \"Physical Address\" which explains the failed test.\r\n\r\nA simple fix would be (I could prepare a complete CL):\r\n\r\n    diff --git a/src/net/net_windows_test.go b/src/net/net_windows_test.go\r\n    index 095a339..b9f116c 100644\r\n    --- a/src/net/net_windows_test.go\r\n    +++ b/src/net/net_windows_test.go\r\n    @@ -516,6 +516,9 @@ func TestInterfaceHardwareAddrWithGetmac(t *testing.T) {\r\n                            if addr == \"\" {\r\n                                    t.Fatal(\"empty address on \\\"Physical Address\\\" line: %q\", line)\r\n                            }\r\n    +                       if addr == \"disabled\" || addr == \"n/a\" {\r\n    +                               continue\r\n    +                       }\r\n                            addr = strings.Replace(addr, \"-\", \":\", -1)\r\n                            want[name] = addr\r\n                            name = \"\"",
	"user": {
		"login": "vdobler",
		"id": 701382,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-02-08T09:59:31Z",
	"updated_at": "2016-02-08T09:59:51Z"
}
