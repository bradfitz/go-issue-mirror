{
	"id": 66092266,
	"body": "\u003ca id=\"c7\"\u003e\u003c/a\u003eComment 7:\n\n\u003cpre\u003eThis program also deadlocks:\n\n    package main\n    \n    import (\n    \t\"fmt\"\n    \t\"runtime\"\n    )\n    \n    \n    \n    func test(name string) {\n    \tdefer func() {\n    \t\tif x := recover(); x != nil {\n    \t\t\tfmt.Printf(\" recovered\")\n    \t\t}\n    \t\tfmt.Printf(\" done\\n\")\n    \t}()\n    \tfmt.Printf(\"%s:\", name)\n    \tvar s *string\n    \t_ = *s\n    \tfmt.Print(\"SHOULD NOT BE HERE\")\n    }\n    \n    func testInNewThread(name string) {\n    \tc := make(chan bool)\n    \tgo func() {\n    \t\truntime.LockOSThread()\n    \t\ttest(name)\n    \t\tc \u0026lt;- true\n    \t}()\n    \t\u0026lt;-c\n    }\n    \n    func main() {\n    \truntime.LockOSThread()\n    \ttest(\"main\")\n    \ttestInNewThread(\"new-thread\")\n    \ttestInNewThread(\"second-new-thread\")\n    \ttest(\"main-again\")\n    }\n\nThis is the crashdump (actually two):\n\n    === RUN TestCrashHandler-2\n    --- FAIL: TestCrashHandler-2 (44.57 seconds)\n    \tcrash_test.go:80: output:\n    \t\tSIGABRT: used by abort, replace SIGIOT in the future\n    \t\tPC=0xfffffd7fff2da63a\n    \t\tsignal arrived during cgo execution\n    \t\t\n    \t\tgoroutine 22 [syscall]:\n    \t\truntime.cgocall(0x4849f0, 0xc2081a8c98)\n    \t\t\t/home/aram/go/src/pkg/runtime/cgocall.c:152 +0x10a fp=0xc2081a8c88\n    \t\tsyscall.sysvicall6(0xfffffd7fff2c2d00, 0x3, 0x6, 0xc2081a8db0, 0x8, ...)\n    \t\t\t/home/aram/go/src/pkg/runtime/syscall_solaris.goc:65 +0x54 fp=0xc2081a8cd0\n    \t\tsyscall.readlen(0x6, 0xc2081a8db0, 0x8, 0x9, 0x0, ...)\n    \t\t\t/home/aram/go/src/pkg/syscall/syscall_solaris.go:517 +0xaa fp=0xc2081a8d38\n    \t\tsyscall.forkExec(0xc208111f50, 0x27, 0xc2081a6480, 0x8, 0x8, ...)\n    \t\t\t/home/aram/go/src/pkg/syscall/exec_unix.go:200 +0x5b8 fp=0xc2081a8e68\n    \t\tsyscall.StartProcess(0xc208111f50, 0x27, 0xc2081a6480, 0x8, 0x8, ...)\n    \t\t\t/home/aram/go/src/pkg/syscall/exec_unix.go:238 +0x8e fp=0xc2081a8eb8\n    \t\tos.startProcess(0xc208111f50, 0x27, 0xc2081a6480, 0x8, 0x8, ...)\n    \t\t\t/home/aram/go/src/pkg/os/exec_posix.go:45 +0x38b fp=0xc2081a8fe0\n    \t\tos.StartProcess(0xc208111f50, 0x27, 0xc2081a6480, 0x8, 0x8, ...)\n    \t\t\t/home/aram/go/src/pkg/os/doc.go:24 +0x76 fp=0xc2081a9030\n    \t\tos/exec.(*Cmd).Start(0xc2080d9cc0, 0x0, 0x0)\n    \t\t\t/home/aram/go/src/pkg/os/exec/exec.go:272 +0x727 fp=0xc2081a91d0\n    \t\tos/exec.(*Cmd).Run(0xc2080d9cc0, 0x0, 0x0)\n    \t\t\t/home/aram/go/src/pkg/os/exec/exec.go:234 +0x4b fp=0xc2081a9200\n    \t\tmain.(*builder).runOut(0xc208100000, 0x825df0, 0x1, 0x865b50, 0x16, ...)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:1374 +0x298 fp=0xc2081a9318\n    \t\tmain.(*builder).run(0xc208100000, 0x825df0, 0x1, 0x865b50, 0x16, ...)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:1325 +0xe6 fp=0xc2081a9410\n    \t\tmain.gcToolchain.ld(0xc208100000, 0xc20806e000, 0xc2080999c0, 0x3b, 0xc2081a6300, ...)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:1775 +0x1091 fp=0xc2081a96b0\n    \t\tmain.gcToolchain.ld·i(0x0, 0xc208100000, 0xc20806e000, 0xc2080999c0, 0x3b, ...)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:1 +0xe3 fp=0xc2081a9728\n    \t\tmain.(*builder).build(0xc208100000, 0xc2080001a0, 0x0, 0x0)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:999 +0x3825 fp=0xc2081a9ea8\n    \t\tmain.func·005(0xc2080001a0)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:682 +0x377 fp=0xc2081a9f50\n    \t\tmain.func·006()\n    \t\t\t/home/aram/go/src/cmd/go/build.go:739 +0x135 fp=0xc2081a9fa8\n    \t\truntime.goexit()\n    \t\t\t/home/aram/go/src/pkg/runtime/proc.c:1448 fp=0xc2081a9fb0\n    \t\tcreated by main.(*builder).do\n    \t\t\t/home/aram/go/src/cmd/go/build.go:745 +0x416\n    \t\t\n    \t\tgoroutine 16 [semacquire]:\n    \t\tsync.runtime_Semacquire(0xc2080fdf00)\n    \t\t\t/home/aram/go/src/pkg/runtime/sema.goc:199 +0x30\n    \t\tsync.(*WaitGroup).Wait(0xc20811ae20)\n    \t\t\t/home/aram/go/src/pkg/sync/waitgroup.go:127 +0x15d\n    \t\tmain.(*builder).do(0xc208100000, 0xc208001ee0)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:748 +0x440\n    \t\tmain.runRun(0xb098c0, 0xc20800c020, 0x1, 0x1)\n    \t\t\t/home/aram/go/src/cmd/go/run.go:115 +0x84f\n    \t\tmain.main()\n    \t\t\t/home/aram/go/src/cmd/go/main.go:161 +0x4fa\n    \t\t\n    \t\tgoroutine 19 [syscall]:\n    \t\tos/signal.loop()\n    \t\t\t/home/aram/go/src/pkg/os/signal/signal_unix.go:21 +0x1e\n    \t\tcreated by os/signal.init·1\n    \t\t\t/home/aram/go/src/pkg/os/signal/signal_unix.go:27 +0x32\n    \t\t\n    \t\tgoroutine 21 [select]:\n    \t\tmain.func·006()\n    \t\t\t/home/aram/go/src/cmd/go/build.go:729 +0x1a7\n    \t\tcreated by main.(*builder).do\n    \t\t\t/home/aram/go/src/cmd/go/build.go:745 +0x416\n    \t\t\n    \t\tgoroutine 32 [finalizer wait]:\n    \t\truntime.park(0x46cb70, 0xb10ec0, 0xb0e6b5)\n    \t\t\t/home/aram/go/src/pkg/runtime/proc.c:1372 +0x89\n    \t\truntime.parkunlock(0xb10ec0, 0xb0e6b5)\n    \t\t\t/home/aram/go/src/pkg/runtime/proc.c:1388 +0x3b\n    \t\trunfinq()\n    \t\t\t/home/aram/go/src/pkg/runtime/mgc0.c:2555 +0xc2\n    \t\truntime.goexit()\n    \t\t\t/home/aram/go/src/pkg/runtime/proc.c:1448\n    \t\t\n    \t\trax     0x5b\n    \t\trbx     0xfffffd7fff192a40\n    \t\trcx     0x0\n    \t\trdx     0x8\n    \t\trdi     0x6\n    \t\trsi     0xc2081a8db0\n    \t\trbp     0xfffffd7fffdff020\n    \t\trsp     0xfffffd7fffdfefe8\n    \t\tr8      0x0\n    \t\tr9      0x0\n    \t\tr10     0x0\n    \t\tr11     0xb14cf0\n    \t\tr12     0x811a40\n    \t\tr13     0x717020\n    \t\tr14     0x0\n    \t\tr15     0x10\n    \t\trip     0xfffffd7fff2da63a\n    \t\trflags  0x247\n    \t\tcs      0x53\n    \t\tfs      0x0\n    \t\tgs      0x0\n    \t\tSIGABRT: used by abort, replace SIGIOT in the future\n    \t\tPC=0xfffffd7fff2d37a7\n    \t\tsignal arrived during cgo execution\n    \t\t\n    \t\tgoroutine 22 [runnable]:\n    \t\tcreated by main.(*builder).do\n    \t\t\t/home/aram/go/src/cmd/go/build.go:745 +0x416\n    \t\t\n    \t\tgoroutine 16 [semacquire]:\n    \t\tsync.runtime_Semacquire(0xc2080fdf00)\n    \t\t\t/home/aram/go/src/pkg/runtime/sema.goc:199 +0x30\n    \t\tsync.(*WaitGroup).Wait(0xc20811ae20)\n    \t\t\t/home/aram/go/src/pkg/sync/waitgroup.go:127 +0x15d\n    \t\tmain.(*builder).do(0xc208100000, 0xc208001ee0)\n    \t\t\t/home/aram/go/src/cmd/go/build.go:748 +0x440\n    \t\tmain.runRun(0xb098c0, 0xc20800c020, 0x1, 0x1)\n    \t\t\t/home/aram/go/src/cmd/go/run.go:115 +0x84f\n    \t\tmain.main()\n    \t\t\t/home/aram/go/src/cmd/go/main.go:161 +0x4fa\n    \t\t\n    \t\tgoroutine 19 [syscall]:\n    \t\tos/signal.loop()\n    \t\t\t/home/aram/go/src/pkg/os/signal/signal_unix.go:21 +0x1e\n    \t\tcreated by os/signal.init·1\n    \t\t\t/home/aram/go/src/pkg/os/signal/signal_unix.go:27 +0x32\n    \t\t\n    \t\tgoroutine 21 [select]:\n    \t\tmain.func·006()\n    \t\t\t/home/aram/go/src/cmd/go/build.go:729 +0x1a7\n    \t\tcreated by main.(*builder).do\n    \t\t\t/home/aram/go/src/cmd/go/build.go:745 +0x416\n    \t\t\n    \t\tgoroutine 32 [running]:\n    \t\t\tgoroutine running on other thread; stack unavailable\n    \t\t\n    \t\trax     0x5b\n    \t\trbx     0xfffffd7fff192a40\n    \t\trcx     0xfffffd7ffee08000\n    \t\trdx     0x0\n    \t\trdi     0x0\n    \t\trsi     0x0\n    \t\trbp     0xfffffd7fffdfef50\n    \t\trsp     0xfffffd7fffdfeee8\n    \t\tr8      0xfffffd7ffef99140\n    \t\tr9      0x40\n    \t\tr10     0xfffffd7ffee08000\n    \t\tr11     0x286\n    \t\tr12     0xb32280\n    \t\tr13     0xfffffd7fff34ca00\n    \t\tr14     0x0\n    \t\tr15     0x0\n    \t\trip     0xfffffd7fff2d37a7\n    \t\trflags  0x247\n    \t\tcs      0x53\n    \t\tfs      0x0\n    \t\tgs      0x0\n    \t\t\n    \t\t\n    \t\twanted:\n    \t\tmain: recovered done\n    \t\tnew-thread: recovered done\n    \t\tsecond-new-thread: recovered done\n    \t\tmain-again: recovered done\u003c/pre\u003e",
	"user": {
		"login": "4ad",
		"id": 1331747,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2014-03-12T09:14:28Z",
	"updated_at": "2014-12-22T06:33:13Z"
}
