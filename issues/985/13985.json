{
	"id": 127086199,
	"number": 13985,
	"state": "closed",
	"title": "net/http: Proto when set is not used properly. ",
	"body": "For example even after setting request ``Proto`` has no affect on how http.Client sends request, it always defaults to. 'HTTP/1.1' \r\n\r\n```\r\n$ cat http-test.go\r\npackage main\r\n\r\nimport (\r\n\t\"fmt\"\r\n\t\"log\"\r\n\t\"net/http\"\r\n\t\"net/http/httputil\"\r\n)\r\n\r\nfunc main() {\r\n\treq, err := http.NewRequest(\"GET\", \"https://www.google.com\", nil)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\treq.Proto = \"HTTP/1.0\"\r\n\tclient := \u0026http.Client{}\r\n\tresp, err := client.Do(req)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\treqTrace, err := httputil.DumpRequestOut(req, false)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\trespTrace, err := httputil.DumpResponse(resp, false)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\tfmt.Println(string(reqTrace))\r\n\tfmt.Println(string(respTrace))\r\n}\r\n```\r\n\r\n```\r\n$ go run http-test.go\r\nGET / HTTP/1.1\r\nHost: www.google.com\r\nUser-Agent: Go-http-client/1.1\r\nAccept-Encoding: gzip\r\n\r\n\r\nHTTP/1.1 200 OK\r\nTransfer-Encoding: chunked\r\nAlt-Svc: quic=\"www.google.com:443\"; ma=600; v=\"30,29,28,27,26,25\",quic=\":443\"; ma=600; v=\"30,29,28,27,26,25\"\r\nAlternate-Protocol: 443:quic,p=1\r\nCache-Control: private, max-age=0\r\nContent-Type: text/html; charset=ISO-8859-1\r\nDate: Sun, 17 Jan 2016 10:08:59 GMT\r\nExpires: -1\r\nP3p: CP=\"This is not a P3P policy! See https://www.google.com/support/accounts/answer/151657?hl=en for more info.\"\r\nServer: gws\r\nSet-Cookie: NID=75=OeIomPif8UPzAt2QI2qzIOeqiJo4jvQRmsKjBHWDpaXwDGizQB5lAxi0Lb3Dw_5sCeWvZmccGoZER2Pj3zuvY2PI982WCxDQBhU62CW1cZUmMqUNeT5vv5tDA1g_646320jRqqcKxFSuQCg; expires=Mon, 18-Jul-2016 10:08:59 GMT; path=/; domain=.google.com; HttpOnly\r\nX-Frame-Options: SAMEORIGIN\r\nX-Xss-Protection: 1; mode=block\r\n```\r\n\r\nNow testing with ``.Proto`` as 'HTTP/2.0' defaults to 'HTTP/1.1' \r\n\r\n```\r\n$ cat http-test.go\r\npackage main\r\n\r\nimport (\r\n\t\"fmt\"\r\n\t\"log\"\r\n\t\"net/http\"\r\n\t\"net/http/httputil\"\r\n)\r\n\r\nfunc main() {\r\n\treq, err := http.NewRequest(\"GET\", \"https://www.google.com\", nil)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\treq.Proto = \"HTTP/2.0\"\r\n\tclient := \u0026http.Client{}\r\n\tresp, err := client.Do(req)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\treqTrace, err := httputil.DumpRequestOut(req, false)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\trespTrace, err := httputil.DumpResponse(resp, false)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\tfmt.Println(string(reqTrace))\r\n\tfmt.Println(string(respTrace))\r\n}\r\n```\r\n\r\n```\r\n$ go run http-test.go\r\nGET / HTTP/1.1\r\nHost: www.google.com\r\nUser-Agent: Go-http-client/1.1\r\nAccept-Encoding: gzip\r\n\r\n\r\nHTTP/1.1 200 OK\r\nTransfer-Encoding: chunked\r\nAlt-Svc: quic=\"www.google.com:443\"; ma=600; v=\"30,29,28,27,26,25\",quic=\":443\"; ma=600; v=\"30,29,28,27,26,25\"\r\nAlternate-Protocol: 443:quic,p=1\r\nCache-Control: private, max-age=0\r\nContent-Type: text/html; charset=ISO-8859-1\r\nDate: Sun, 17 Jan 2016 10:11:35 GMT\r\nExpires: -1\r\nP3p: CP=\"This is not a P3P policy! See https://www.google.com/support/accounts/answer/151657?hl=en for more info.\"\r\nServer: gws\r\nSet-Cookie: NID=75=zVFTFbi8WLNy04TQUSBVFJ6ioFJs-YUrYLI3Js2dZ8cIoiBLLcxAnOOd4REY9Lns3TPZtPjXE5Cdb7C40vqk4HnbDWdSkSp3j0mMc1Z83pFWR22KMvJcofKJJjOVeKv9GZsJ66MRF1vlxGQ; expires=Mon, 18-Jul-2016 10:11:35 GMT; path=/; domain=.google.com; HttpOnly\r\nX-Frame-Options: SAMEORIGIN\r\nX-Xss-Protection: 1; mode=block\r\n```",
	"user": {
		"login": "harshavardhana",
		"id": 622699,
		"type": "User",
		"site_admin": false
	},
	"comments": 17,
	"closed_at": "2016-01-17T16:07:23Z",
	"created_at": "2016-01-17T10:12:43Z",
	"updated_at": "2016-01-18T15:05:52Z"
}
