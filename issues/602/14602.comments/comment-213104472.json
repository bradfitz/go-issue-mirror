{
	"id": 213104472,
	"body": "Joining the 'bug report', even though most of the problem has been identified. \r\n\r\n## TL;DR\r\n* Using the newest version of clang available, brings up another (different) error. \r\n* Using an old `clang` the test is skipped, so no errors are thrown.\r\n* Using `CGO_ENABLED=0` also disables those tests. \r\n* Using no `clang` reports the error described in this issue. \r\n\r\n## Longer version\r\n\r\n* Without `clang` installed (but with `gcc 5.3.1`): \u003cbr\u003e\r\nthe error as described\r\n* With `clang-3.6`, env `CC=clang`, linux `4.3`: \u003cbr\u003e\r\nthe installation skipped those tests (needed clang 3.8+)\r\n* With `clang-3.8`, env `CC=clang-3.8`, linux `4.3`: \u003cbr\u003e\r\n`TestCgoConsistentResults: \tgo_test.go:2775: building cgotest twice did not produce the same output`\r\n* With `clang-3.8`, env `CC=clang`, linux `4.3` and a symlink from `/usr/local/bin/clang` to `/usr/bin/clang-3.8`: \u003cbr\u003e\r\n`TestCgoConsistentResults: \tgo_test.go:2775: building cgotest twice did not produce the same output` (same)\r\n\r\n```\r\n--- FAIL: TestCgoConsistentResults (1.10s)\r\n\tgo_test.go:244: running testgo [build -o /tmp/gotest260338695/cgotest1 cgotest]\r\n\tgo_test.go:244: running testgo [build -x -o /tmp/gotest260338695/cgotest2 cgotest]\r\n\tgo_test.go:263: standard error:\r\n\tgo_test.go:264: WORK=/tmp/go-build737947577\r\n\t\tmkdir -p $WORK/cgotest/_obj/\r\n\t\tmkdir -p $WORK/\r\n\t\tcd /home/etiennebruines/workspaces/go-master/src/cmd/go/testdata/src/cgotest\r\n\t\tCGO_LDFLAGS=\"-g\" \"-O2\" /home/etiennebruines/workspaces/go-master/pkg/tool/linux_amd64/cgo -objdir $WORK/cgotest/_obj/ -importpath cgotest -- -I $WORK/cgotest/_obj/ m.go\r\n\t\tcd $WORK\r\n\t\tclang-3.8 -fdebug-prefix-map=a=b -c trivial.c\r\n\t\tclang-3.8 -gno-record-gcc-switches -c trivial.c\r\n\t\tcd /home/etiennebruines/workspaces/go-master/src/cmd/go/testdata/src/cgotest\r\n\t\tclang-3.8 -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=$WORK=/tmp/go-build -gno-record-gcc-switches -I $WORK/cgotest/_obj/ -g -O2 -o $WORK/cgotest/_obj/_cgo_main.o -c $WORK/cgotest/_obj/_cgo_main.c\r\n\t\tclang-3.8 -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=$WORK=/tmp/go-build -gno-record-gcc-switches -I $WORK/cgotest/_obj/ -g -O2 -o $WORK/cgotest/_obj/_cgo_export.o -c $WORK/cgotest/_obj/_cgo_export.c\r\n\t\tclang-3.8 -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=$WORK=/tmp/go-build -gno-record-gcc-switches -I $WORK/cgotest/_obj/ -g -O2 -o $WORK/cgotest/_obj/m.cgo2.o -c $WORK/cgotest/_obj/m.cgo2.c\r\n\t\tclang-3.8 -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=$WORK=/tmp/go-build -gno-record-gcc-switches -o $WORK/cgotest/_obj/_cgo_.o $WORK/cgotest/_obj/_cgo_main.o $WORK/cgotest/_obj/_cgo_export.o $WORK/cgotest/_obj/m.cgo2.o -g -O2\r\n\t\t/home/etiennebruines/workspaces/go-master/pkg/tool/linux_amd64/cgo -objdir $WORK/cgotest/_obj/ -dynpackage cgotest -dynimport $WORK/cgotest/_obj/_cgo_.o -dynout $WORK/cgotest/_obj/_cgo_import.go\r\n\t\tcd $WORK\r\n\t\tclang-3.8 -no-pie -c trivial.c\r\n\t\tcd /home/etiennebruines/workspaces/go-master/src/cmd/go/testdata/src/cgotest\r\n\t\tclang-3.8 -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=$WORK=/tmp/go-build -gno-record-gcc-switches -o $WORK/cgotest/_obj/_all.o $WORK/cgotest/_obj/_cgo_export.o $WORK/cgotest/_obj/m.cgo2.o -g -O2 -Wl,-r -nostdlib -Wl,--build-id=none\r\n\t\t/home/etiennebruines/workspaces/go-master/pkg/tool/linux_amd64/compile -o $WORK/cgotest.a -trimpath $WORK -p cgotest -buildid 1491fc40a2d4f2376923084c60120b2fd293fe0e -D _/home/etiennebruines/workspaces/go-master/src/cmd/go/testdata/src/cgotest -I $WORK -pack $WORK/cgotest/_obj/_cgo_gotypes.go $WORK/cgotest/_obj/m.cgo1.go $WORK/cgotest/_obj/_cgo_import.go\r\n\t\tpack r $WORK/cgotest.a $WORK/cgotest/_obj/_all.o # internal\r\n\t\tmkdir -p /tmp/gotest260338695/\r\n\t\tmv $WORK/cgotest.a /tmp/gotest260338695/cgotest2\r\n\t\t\r\n\tgo_test.go:2775: building cgotest twice did not produce the same output\r\nFAIL\r\nFAIL\tcmd/go\t29.068s\r\n```\r\n\r\nDo you want me to open up a separate issue for the new error? Or is it related to this one? ",
	"user": {
		"login": "EtienneBruines",
		"id": 3962174,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-04-21T20:37:52Z",
	"updated_at": "2016-04-21T20:43:00Z"
}
