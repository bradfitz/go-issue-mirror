{
	"id": 249334665,
	"body": "Thanks @randall77 - yes, the current tip seems to be optimizing that. However if I change function signature from\r\n`func empty(_ interface{}, _ interface{}) {}`\r\nto\r\n`func empty(_ ...interface{}) {}`\r\n\r\nhttps://play.golang.org/p/KYp1jVhTvj\r\n\r\nresults become less appealing (compiled using current tip):\r\n```\r\nTEXT main.main(SB) C:/Dmitriy/Coding/Go/src/github.com/DmitriyMV/ssa_test/main.go\r\n\tmain.go:5\t0x401050\t65488b0c2528000000\tGS MOVQ GS:0x28, CX\t\t\t\r\n\tmain.go:5\t0x401059\t488b8900000000\t\tMOVQ 0(CX), CX\t\t\t\t\r\n\tmain.go:5\t0x401060\t483b6110\t\tCMPQ 0x10(CX), SP\t\t\t\r\n\tmain.go:5\t0x401064\t0f8615010000\t\tJBE 0x40117f\t\t\t\t\r\n\tmain.go:5\t0x40106a\t4883ec48\t\tSUBQ $0x48, SP\t\t\t\t\r\n\tmain.go:5\t0x40106e\t48896c2440\t\tMOVQ BP, 0x40(SP)\t\t\t\r\n\tmain.go:5\t0x401073\t488d6c2440\t\tLEAQ 0x40(SP), BP\t\t\t\r\n\tmain.go:6\t0x401078\t48c74424200a000000\tMOVQ $0xa, 0x20(SP)\t\t\t\r\n\tmain.go:6\t0x401081\t488d05be4e0900\t\tLEAQ 0x94ebe(IP), AX\t\t\t\r\n\tmain.go:6\t0x401088\t4889442430\t\tMOVQ AX, 0x30(SP)\t\t\t\r\n\tmain.go:6\t0x40108d\t48c744243805000000\tMOVQ $0x5, 0x38(SP)\t\t\t\r\n\tmain.go:6\t0x401096\t488d0523d30700\t\tLEAQ 0x7d323(IP), AX\t\t\t\r\n\tmain.go:6\t0x40109d\t48890424\t\tMOVQ AX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x4010a1\te88abc0000\t\tCALL runtime.newobject(SB)\t\t\r\n\tmain.go:6\t0x4010a6\t488b442408\t\tMOVQ 0x8(SP), AX\t\t\t\r\n\tmain.go:6\t0x4010ab\t4889442428\t\tMOVQ AX, 0x28(SP)\t\t\t\r\n\tmain.go:6\t0x4010b0\t488d0da9b70700\t\tLEAQ 0x7b7a9(IP), CX\t\t\t\r\n\tmain.go:6\t0x4010b7\t48890c24\t\tMOVQ CX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x4010bb\t488d4c2420\t\tLEAQ 0x20(SP), CX\t\t\t\r\n\tmain.go:6\t0x4010c0\t48894c2408\t\tMOVQ CX, 0x8(SP)\t\t\t\r\n\tmain.go:6\t0x4010c5\te8c68e0000\t\tCALL runtime.convT2E(SB)\t\t\r\n\tmain.go:6\t0x4010ca\t488b442418\t\tMOVQ 0x18(SP), AX\t\t\t\r\n\tmain.go:6\t0x4010cf\t488b4c2410\t\tMOVQ 0x10(SP), CX\t\t\t\r\n\tmain.go:6\t0x4010d4\t488b542428\t\tMOVQ 0x28(SP), DX\t\t\t\r\n\tmain.go:6\t0x4010d9\t48890a\t\t\tMOVQ CX, 0(DX)\t\t\t\t\r\n\tmain.go:6\t0x4010dc\t8b0dceb70f00\t\tMOVL 0xfb7ce(IP), CX\t\t\t\r\n\tmain.go:6\t0x4010e2\t85c9\t\t\tTESTL CX, CX\t\t\t\t\r\n\tmain.go:6\t0x4010e4\t757d\t\t\tJNE 0x401163\t\t\t\t\r\n\tmain.go:6\t0x4010e6\t48894208\t\tMOVQ AX, 0x8(DX)\t\t\t\r\n\tmain.go:6\t0x4010ea\t488d052fbc0700\t\tLEAQ 0x7bc2f(IP), AX\t\t\t\r\n\tmain.go:6\t0x4010f1\t48890424\t\tMOVQ AX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x4010f5\t488d442430\t\tLEAQ 0x30(SP), AX\t\t\t\r\n\tmain.go:6\t0x4010fa\t4889442408\t\tMOVQ AX, 0x8(SP)\t\t\t\r\n\tmain.go:6\t0x4010ff\te88c8e0000\t\tCALL runtime.convT2E(SB)\t\t\r\n\tmain.go:6\t0x401104\t488b442418\t\tMOVQ 0x18(SP), AX\t\t\t\r\n\tmain.go:6\t0x401109\t488b4c2410\t\tMOVQ 0x10(SP), CX\t\t\t\r\n\tmain.go:6\t0x40110e\t488b542428\t\tMOVQ 0x28(SP), DX\t\t\t\r\n\tmain.go:6\t0x401113\t48894a10\t\tMOVQ CX, 0x10(DX)\t\t\t\r\n\tmain.go:6\t0x401117\t8b0d93b70f00\t\tMOVL 0xfb793(IP), CX\t\t\t\r\n\tmain.go:6\t0x40111d\t85c9\t\t\tTESTL CX, CX\t\t\t\t\r\n\tmain.go:6\t0x40111f\t7529\t\t\tJNE 0x40114a\t\t\t\t\r\n\tmain.go:6\t0x401121\t48894218\t\tMOVQ AX, 0x18(DX)\t\t\t\r\n\tmain.go:6\t0x401125\t48891424\t\tMOVQ DX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x401129\t48c744240802000000\tMOVQ $0x2, 0x8(SP)\t\t\t\r\n\tmain.go:6\t0x401132\t48c744241002000000\tMOVQ $0x2, 0x10(SP)\t\t\t\r\n\tmain.go:6\t0x40113b\te800ffffff\t\tCALL main.empty(SB)\t\t\t\r\n\tmain.go:7\t0x401140\t488b6c2440\t\tMOVQ 0x40(SP), BP\t\t\t\r\n\tmain.go:7\t0x401145\t4883c448\t\tADDQ $0x48, SP\t\t\t\t\r\n\tmain.go:7\t0x401149\tc3\t\t\tRET\t\t\t\t\t\r\n\tmain.go:6\t0x40114a\t488d4a18\t\tLEAQ 0x18(DX), CX\t\t\t\r\n\tmain.go:6\t0x40114e\t48890c24\t\tMOVQ CX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x401152\t4889442408\t\tMOVQ AX, 0x8(SP)\t\t\t\r\n\tmain.go:6\t0x401157\te824c50000\t\tCALL runtime.writebarrierptr(SB)\t\r\n\tmain.go:6\t0x40115c\t488b542428\t\tMOVQ 0x28(SP), DX\t\t\t\r\n\tmain.go:6\t0x401161\tebc2\t\t\tJMP 0x401125\t\t\t\t\r\n\tmain.go:6\t0x401163\t488d4a08\t\tLEAQ 0x8(DX), CX\t\t\t\r\n\tmain.go:6\t0x401167\t48890c24\t\tMOVQ CX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x40116b\t4889442408\t\tMOVQ AX, 0x8(SP)\t\t\t\r\n\tmain.go:6\t0x401170\te80bc50000\t\tCALL runtime.writebarrierptr(SB)\t\r\n\tmain.go:6\t0x401175\t488b542428\t\tMOVQ 0x28(SP), DX\t\t\t\r\n\tmain.go:6\t0x40117a\te96bffffff\t\tJMP 0x4010ea\t\t\t\t\r\n\tmain.go:5\t0x40117f\te8bcae0400\t\tCALL runtime.morestack_noctxt(SB)\t\r\n\tmain.go:5\t0x401184\te9c7feffff\t\tJMP main.main(SB)\t\t\t\r\n\t:-1\t\t0x401189\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40118a\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40118b\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40118c\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40118d\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40118e\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40118f\tcc\t\t\tINT $0x3\t\t\t\t\r\n```\r\n\r\nAnd there is also map[type]type case (also compiled using current tip):\r\nhttps://play.golang.org/p/xfgG21QBeC\r\n```\r\nTEXT main.main(SB) C:/Dmitriy/Coding/Go/src/github.com/DmitriyMV/ssa_test/main.go\r\n\tmain.go:5\t0x401040\t65488b0c2528000000\tGS MOVQ GS:0x28, CX\t\t\t\r\n\tmain.go:5\t0x401049\t488b8900000000\t\tMOVQ 0(CX), CX\t\t\t\t\r\n\tmain.go:5\t0x401050\t483b6110\t\tCMPQ 0x10(CX), SP\t\t\t\r\n\tmain.go:5\t0x401054\t0f86ae000000\t\tJBE 0x401108\t\t\t\t\r\n\tmain.go:5\t0x40105a\t4883ec40\t\tSUBQ $0x40, SP\t\t\t\t\r\n\tmain.go:5\t0x40105e\t48896c2438\t\tMOVQ BP, 0x38(SP)\t\t\t\r\n\tmain.go:5\t0x401063\t488d6c2438\t\tLEAQ 0x38(SP), BP\t\t\t\r\n\tmain.go:6\t0x401068\t488d05d1060800\t\tLEAQ 0x806d1(IP), AX\t\t\t\r\n\tmain.go:6\t0x40106f\t48890424\t\tMOVQ AX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x401073\t48c744240801000000\tMOVQ $0x1, 0x8(SP)\t\t\t\r\n\tmain.go:6\t0x40107c\t48c744241000000000\tMOVQ $0x0, 0x10(SP)\t\t\t\r\n\tmain.go:6\t0x401085\t48c744241800000000\tMOVQ $0x0, 0x18(SP)\t\t\t\r\n\tmain.go:6\t0x40108e\te82d580000\t\tCALL runtime.makemap(SB)\t\t\r\n\tmain.go:6\t0x401093\t488b442420\t\tMOVQ 0x20(SP), AX\t\t\t\r\n\tmain.go:6\t0x401098\t4889442430\t\tMOVQ AX, 0x30(SP)\t\t\t\r\n\tmain.go:6\t0x40109d\t31c9\t\t\tXORL CX, CX\t\t\t\t\r\n\tmain.go:6\t0x40109f\t48894c2428\t\tMOVQ CX, 0x28(SP)\t\t\t\r\n\tmain.go:6\t0x4010a4\t4883f901\t\tCMPQ $0x1, CX\t\t\t\t\r\n\tmain.go:6\t0x4010a8\t7d54\t\t\tJGE 0x4010fe\t\t\t\t\r\n\tmain.go:6\t0x4010aa\t488d158f060800\t\tLEAQ 0x8068f(IP), DX\t\t\t\r\n\tmain.go:6\t0x4010b1\t48891424\t\tMOVQ DX, 0(SP)\t\t\t\t\r\n\tmain.go:6\t0x4010b5\t4889442408\t\tMOVQ AX, 0x8(SP)\t\t\t\r\n\tmain.go:6\t0x4010ba\t4889cb\t\t\tMOVQ CX, BX\t\t\t\t\r\n\tmain.go:6\t0x4010bd\t48c1e104\t\tSHLQ $0x4, CX\t\t\t\t\r\n\tmain.go:6\t0x4010c1\t488d3538090a00\t\tLEAQ 0xa0938(IP), SI\t\t\t\r\n\tmain.go:6\t0x4010c8\t488d3c0e\t\tLEAQ 0(SI)(CX*1), DI\t\t\t\r\n\tmain.go:6\t0x4010cc\t48897c2410\t\tMOVQ DI, 0x10(SP)\t\t\t\r\n\tmain.go:6\t0x4010d1\t488d3d38090a00\t\tLEAQ 0xa0938(IP), DI\t\t\t\r\n\tmain.go:6\t0x4010d8\t4801f9\t\t\tADDQ DI, CX\t\t\t\t\r\n\tmain.go:6\t0x4010db\t48894c2418\t\tMOVQ CX, 0x18(SP)\t\t\t\r\n\tmain.go:6\t0x4010e0\te83b5f0000\t\tCALL runtime.mapassign1(SB)\t\t\r\n\tmain.go:6\t0x4010e5\t488b442428\t\tMOVQ 0x28(SP), AX\t\t\t\r\n\tmain.go:6\t0x4010ea\t488d4801\t\tLEAQ 0x1(AX), CX\t\t\t\r\n\tmain.go:6\t0x4010ee\t488b442430\t\tMOVQ 0x30(SP), AX\t\t\t\r\n\tmain.go:6\t0x4010f3\t48894c2428\t\tMOVQ CX, 0x28(SP)\t\t\t\r\n\tmain.go:6\t0x4010f8\t4883f901\t\tCMPQ $0x1, CX\t\t\t\t\r\n\tmain.go:6\t0x4010fc\t7cac\t\t\tJL 0x4010aa\t\t\t\t\r\n\tmain.go:7\t0x4010fe\t488b6c2438\t\tMOVQ 0x38(SP), BP\t\t\t\r\n\tmain.go:7\t0x401103\t4883c440\t\tADDQ $0x40, SP\t\t\t\t\r\n\tmain.go:7\t0x401107\tc3\t\t\tRET\t\t\t\t\t\r\n\tmain.go:5\t0x401108\te873ad0400\t\tCALL runtime.morestack_noctxt(SB)\t\r\n\tmain.go:5\t0x40110d\te92effffff\t\tJMP main.main(SB)\t\t\t\r\n\t:-1\t\t0x401112\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x401113\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x401114\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x401115\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x401116\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x401117\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x401118\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x401119\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40111a\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40111b\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40111c\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40111d\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40111e\tcc\t\t\tINT $0x3\t\t\t\t\r\n\t:-1\t\t0x40111f\tcc\t\t\tINT $0x3\t\t\r\n```\r\n\r\nAs far as I could tell - map doesn't have any \"side effects\" with user code (it's not truly side effect free tho), so if map is unused, it's creation can be eliminated if no functions were called during map creation. Same goes for `...type`.\r\n\r\nOr am I missing something here? Should I open another issue, btw?\r\n\r\n",
	"user": {
		"login": "DmitriyMV",
		"id": 6999905,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-09-24T00:56:29Z",
	"updated_at": "2016-09-24T01:07:13Z"
}
