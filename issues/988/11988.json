{
	"id": 98662031,
	"number": 11988,
	"state": "closed",
	"title": "cmd/go: `go test -i` doesn't grok vendored dependencies",
	"body": "```\r\n% go version\r\ngo version devel +a33b522 Sun Aug 2 23:47:00 2015 +0000 darwin/amd64\r\n\r\n% go env | grep VENDOR\r\nGO15VENDOREXPERIMENT=\"1\"\r\n```\r\n\r\nIt seems `go build -i` and `go test -i` treat vendored dependencies differently, which seems unintended. Set up as follows to reproduce:\r\n\r\n```\r\nrm -rf $GOPATH/{src,pkg}\r\nmkdir -p $GOPATH/src/github.com/googlecloudplatform\r\ngit clone https://github.com/GoogleCloudPlatform/gcsfuse.git $GOPATH/src/github.com/googlecloudplatform/gcsfuse\r\ncd $GOPATH/src/github.com/googlecloudplatform/gcsfuse\r\ngit checkout 818d87d98848695a1f30e1710b6d3f8182b7329e\r\n```\r\n\r\n`go build` is totally happy to install vendored dependencies:\r\n\r\n```\r\n% go build -i -v\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/codegangsta/cli\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/golang.org/x/net/context\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/oglematchers\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/fuse/fsutil\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/google.golang.org/api/googleapi/internal/uritemplates\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/fuse/internal/fusekernel\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/fuse/internal/freelist\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/util/lrucache\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/golang.org/x/sys/unix\r\ngithub.com/googlecloudplatform/gcsfuse/mount\r\ngithub.com/googlecloudplatform/gcsfuse/perms\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/golang.org/x/oauth2/jws\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/syncutil\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/gcloud/httputil\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/reqtrace\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/golang.org/x/oauth2/internal\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/google.golang.org/cloud/internal\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/google.golang.org/api/googleapi\r\ngithub.com/googlecloudplatform/gcsfuse/lease\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/fuse/fuseops\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/fuse/internal/buffer\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/google.golang.org/cloud/compute/metadata\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/golang.org/x/oauth2\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/fuse\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/google.golang.org/api/storage/v1\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/timeutil\r\ngithub.com/googlecloudplatform/gcsfuse/mutable\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/golang.org/x/oauth2/jwt\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/golang.org/x/oauth2/google\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/fuse/fuseutil\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/gcloud/gcs\r\ngithub.com/googlecloudplatform/gcsfuse/gcsproxy\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/gcloud/gcs/gcsutil\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/gcloud/gcs/gcscaching\r\ngithub.com/googlecloudplatform/gcsfuse/vendor/github.com/jacobsa/ratelimit\r\ngithub.com/googlecloudplatform/gcsfuse/fs/inode\r\ngithub.com/googlecloudplatform/gcsfuse/fs\r\ngithub.com/googlecloudplatform/gcsfuse\r\n```\r\n\r\nBut `go test` is not:\r\n\r\n```\r\n% go test -i -v\r\ncan't load package: package github.com/codegangsta/cli: cannot find package \"github.com/codegangsta/cli\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/codegangsta/cli (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/codegangsta/cli (from $GOPATH)\r\ncan't load package: package github.com/jacobsa/fuse: cannot find package \"github.com/jacobsa/fuse\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/jacobsa/fuse (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/jacobsa/fuse (from $GOPATH)\r\ncan't load package: package github.com/jacobsa/gcloud/gcs: cannot find package \"github.com/jacobsa/gcloud/gcs\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/jacobsa/gcloud/gcs (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/jacobsa/gcloud/gcs (from $GOPATH)\r\ncan't load package: package github.com/jacobsa/gcloud/gcs/gcsfake: cannot find package \"github.com/jacobsa/gcloud/gcs/gcsfake\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/jacobsa/gcloud/gcs/gcsfake (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/jacobsa/gcloud/gcs/gcsfake (from $GOPATH)\r\ncan't load package: package github.com/jacobsa/gcloud/gcs/gcsutil: cannot find package \"github.com/jacobsa/gcloud/gcs/gcsutil\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/jacobsa/gcloud/gcs/gcsutil (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/jacobsa/gcloud/gcs/gcsutil (from $GOPATH)\r\ncan't load package: package github.com/jacobsa/oglematchers: cannot find package \"github.com/jacobsa/oglematchers\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/jacobsa/oglematchers (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/jacobsa/oglematchers (from $GOPATH)\r\ncan't load package: package github.com/jacobsa/ogletest: cannot find package \"github.com/jacobsa/ogletest\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/jacobsa/ogletest (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/jacobsa/ogletest (from $GOPATH)\r\ncan't load package: package github.com/jacobsa/timeutil: cannot find package \"github.com/jacobsa/timeutil\" in any of:\r\n        /Users/jacobsa/clients/go/src/github.com/jacobsa/timeutil (from $GOROOT)\r\n        /Users/jacobsa/go/src/github.com/jacobsa/timeutil (from $GOPATH)\r\ncan't load package: package golang.org/x/net/context: cannot find package \"golang.org/x/net/context\" in any of:\r\n        /Users/jacobsa/clients/go/src/golang.org/x/net/context (from $GOROOT)\r\n        /Users/jacobsa/go/src/golang.org/x/net/context (from $GOPATH)\r\n```\r\n\r\nI would prefer both to have the behavior of `go build -i`, since I regularly use `go test -i` to reduce the time taken for each `go test` invocation when repeatedly running the tests.",
	"user": {
		"login": "jacobsa",
		"id": 202895,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 1,
	"closed_at": "2015-08-05T23:13:36Z",
	"created_at": "2015-08-03T03:03:15Z",
	"updated_at": "2016-08-05T16:12:01Z",
	"milestone": {
		"id": 905105,
		"number": 1,
		"title": "Go1.5"
	}
}
