{
	"id": 236984215,
	"body": "I just tried building on beta 4 with the patch above and it fails at the following test. \r\n```\r\n$ GOROOT_BOOTSTRAP=/Users/matt/go-darwin-amd64-bootstrap ./all.bash\r\n...\r\n--- FAIL: TestNetpollDeadlock (60.48s)\r\n\tcrash_test.go:105: testprognet NetpollDeadlock exit status: exit status 2\r\n\tcrash_test.go:407: output does not start with \"done\\n\":\r\n\t\tdialing\r\n\t\tSIGQUIT: quit\r\n\t\tPC=0x597db m=0\r\n\r\n\t\tgoroutine 0 [idle]:\r\n\t\truntime.mach_semaphore_wait(0xc400000f03, 0x0, 0x18f7c0, 0xf0cb, 0x7fff5fbff5d0, 0x18f240, 0x7fff5fbff5f0, 0x4ff93, 0xffffffffffffffff, 0xc420032c00, ...)\r\n\t\t\t/Users/matt/go/src/runtime/sys_darwin_amd64.s:418 +0xb\r\n\t\truntime.semasleep1(0xffffffffffffffff, 0xc420032c00)\r\n\t\t\t/Users/matt/go/src/runtime/os_darwin.go:435 +0x4b\r\n\t\truntime.semasleep.func1()\r\n\t\t\t/Users/matt/go/src/runtime/os_darwin.go:451 +0x33\r\n\t\truntime.systemstack(0x7fff5fbff618)\r\n\t\t\t/Users/matt/go/src/runtime/asm_amd64.s:314 +0xab\r\n\t\truntime.semasleep(0xffffffffffffffff, 0x0)\r\n\t\t\t/Users/matt/go/src/runtime/os_darwin.go:452 +0x44\r\n\t\truntime.notesleep(0x18f8d0)\r\n\t\t\t/Users/matt/go/src/runtime/lock_sema.go:166 +0x9f\r\n\t\truntime.stoplockedm()\r\n\t\t\t/Users/matt/go/src/runtime/proc.go:1740 +0x8a\r\n\t\truntime.schedule()\r\n\t\t\t/Users/matt/go/src/runtime/proc.go:2077 +0x2fa\r\n\t\truntime.park_m(0xc4200001a0)\r\n\t\t\t/Users/matt/go/src/runtime/proc.go:2182 +0x123\r\n\t\truntime.mcall(0x7fff5fbff760)\r\n\t\t\t/Users/matt/go/src/runtime/asm_amd64.s:240 +0x5b\r\n\r\n\t\tgoroutine 1 [IO wait, locked to thread]:\r\n\t\tnet.runtime_pollWait(0x268f00, 0x77, 0xc420051501)\r\n\t\t\t/Users/matt/go/src/runtime/netpoll.go:160 +0x59\r\n\t\tnet.(*pollDesc).wait(0xc42005c1b0, 0x77, 0x0, 0x0)\r\n\t\t\t/Users/matt/go/src/net/fd_poll_runtime.go:73 +0x38\r\n\t\tnet.(*pollDesc).waitWrite(0xc42005c1b0, 0xc420010320, 0x1891e0)\r\n\t\t\t/Users/matt/go/src/net/fd_poll_runtime.go:82 +0x34\r\n\t\tnet.(*netFD).connect(0xc42005c150, 0x1891e0, 0xc420010320, 0x0, 0x0, 0x188660, 0xc420012380, 0x0, 0x0)\r\n\t\t\t/Users/matt/go/src/net/fd_unix.go:152 +0x26d\r\n\t\tnet.(*netFD).dial(0xc42005c150, 0x1891e0, 0xc420010320, 0x189340, 0x0, 0x189340, 0xc4200165d0, 0x10, 0x10)\r\n\t\t\t/Users/matt/go/src/net/sock_posix.go:137 +0x137\r\n\t\tnet.socket(0x1891e0, 0xc420010320, 0x10db07, 0x3, 0x1e, 0x1, 0x0, 0x0, 0x189340, 0x0, ...)\r\n\t\t\t/Users/matt/go/src/net/sock_posix.go:89 +0x209\r\n\t\tnet.internetSocket(0x1891e0, 0xc420010320, 0x10db07, 0x3, 0x189340, 0x0, 0x189340, 0xc4200165d0, 0x1, 0x0, ...)\r\n\t\t\t/Users/matt/go/src/net/ipsock_posix.go:158 +0x129\r\n\t\tnet.doDialTCP(0x1891e0, 0xc420010320, 0x10db07, 0x3, 0x0, 0xc4200165d0, 0xecd20, 0x1a95b0, 0xc420051a30)\r\n\t\t\t/Users/matt/go/src/net/tcpsock_posix.go:58 +0xb9\r\n\t\tnet.dialTCP(0x1891e0, 0xc420010320, 0x10db07, 0x3, 0x0, 0xc4200165d0, 0x0, 0x1885a0, 0xc42000c340)\r\n\t\t\t/Users/matt/go/src/net/tcpsock_posix.go:54 +0xe4\r\n\t\tnet.dialSingle(0x1891e0, 0xc420010320, 0xc42005c070, 0x188be0, 0xc4200165d0, 0x0, 0x0, 0x0, 0x0)\r\n\t\t\t/Users/matt/go/src/net/dial.go:501 +0x479\r\n\t\tnet.dialSerial(0x1891e0, 0xc420010320, 0xc42005c070, 0xc42000c300, 0x2, 0x2, 0x0, 0x0, 0x0, 0x0)\r\n\t\t\t/Users/matt/go/src/net/dial.go:469 +0x223\r\n\t\tnet.(*Dialer).DialContext(0xc420051da0, 0x1891e0, 0xc420010320, 0x10db07, 0x3, 0x10f0fd, 0xf, 0x0, 0x0, 0x0, ...)\r\n\t\t\t/Users/matt/go/src/net/dial.go:351 +0x657\r\n\t\tnet.(*Dialer).Dial(0xc420051da0, 0x10db07, 0x3, 0x10f0fd, 0xf, 0x8, 0xc4200180c0, 0x0, 0x0)\r\n\t\t\t/Users/matt/go/src/net/dial.go:282 +0x75\r\n\t\tnet.Dial(0x10db07, 0x3, 0x10f0fd, 0xf, 0x0, 0x0, 0x18f7c0, 0x0)\r\n\t\t\t/Users/matt/go/src/net/dial.go:261 +0x90\r\n\t\tmain.NetpollDeadlockInit()\r\n\t\t\t/Users/matt/go/src/runtime/testdata/testprognet/net.go:19 +0xdb\r\n\t\tmain.registerInit(0x10f076, 0xf, 0x11b8f8)\r\n\t\t\t/Users/matt/go/src/runtime/testdata/testprognet/main.go:20 +0x7f\r\n\t\tmain.init.1()\r\n\t\t\t/Users/matt/go/src/runtime/testdata/testprognet/net.go:13 +0x42\r\n\t\tmain.init()\r\n\t\t\t/Users/matt/go/src/runtime/testdata/testprognet/signal.go:27 +0xa3\r\n\r\n\t\tgoroutine 17 [syscall, locked to thread]:\r\n\t\truntime.goexit()\r\n\t\t\t/Users/matt/go/src/runtime/asm_amd64.s:2086 +0x1\r\n\r\n\t\tgoroutine 5 [syscall]:\r\n\t\tos/signal.signal_recv(0x0)\r\n\t\t\t/Users/matt/go/src/runtime/sigqueue.go:116 +0x157\r\n\t\tos/signal.loop()\r\n\t\t\t/Users/matt/go/src/os/signal/signal_unix.go:22 +0x22\r\n\t\tcreated by os/signal.init.1\r\n\t\t\t/Users/matt/go/src/os/signal/signal_unix.go:28 +0x41\r\n\r\n\t\trax    0xe\r\n\t\trbx    0x18f7c0\r\n\t\trcx    0x7fff5fbff590\r\n\t\trdx    0x7fff5fbff618\r\n\t\trdi    0xf03\r\n\t\trsi    0x18f7c0\r\n\t\trbp    0x7fff5fbff5c8\r\n\t\trsp    0x7fff5fbff590\r\n\t\tr8     0x0\r\n\t\tr9     0x0\r\n\t\tr10    0x0\r\n\t\tr11    0x286\r\n\t\tr12    0x40\r\n\t\tr13    0x380\r\n\t\tr14    0xf\r\n\t\tr15    0x3\r\n\t\trip    0x597db\r\n\t\trflags 0x286\r\n\t\tcs     0x7\r\n\t\tfs     0x0\r\n\t\tgs     0x0\r\nFAIL\r\nFAIL\truntime\t70.881s\r\n```\r\n\r\n`go-darwin-amd64-bootstrap` came from a linux machine and was built with the following command. (with patch applied)\r\n```\r\n$ GOROOT_BOOTSTRAP=/usr/lib/go GOOS=darwin GOARCH=amd64 ./bootstrap.bash\r\n```",
	"user": {
		"login": "mattaitchison",
		"id": 770790,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-08-02T17:46:38Z",
	"updated_at": "2016-08-02T17:46:38Z"
}
