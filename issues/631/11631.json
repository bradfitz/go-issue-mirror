{
	"id": 93860980,
	"number": 11631,
	"state": "closed",
	"title": "cmd/compile: go1.x.x.linux-386: crashes with older 32-bit processors",
	"body": "Background: I tried to compile gdrive since the provided 386-binary crashed on my embedded platform.\r\nWhen I tried with go from any go1.x.x.linux-386.tar.gz archives I found that this already crashes exactly the same way; then tried same go1.x.x.linux-386.tar.gz on same 32-bit Linux distro but with a 64-bit-capable processor (Pentium D Dualcore) and it works without crash. 1st I thought it might be an issue with AMD processors, but  just also tested a Pentium 3 which is classified as i686 but crashes too:\r\n\r\nroot@voyage:~# go\r\nSIGILL: illegal instruction\r\nPC=0x81f4ea9\r\n\r\ngoroutine 1 [running, locked to thread]:\r\nmath.initÂ·1()\r\n        /usr/local/go/src/math/pow10.go:34 +0x19 fp=0x1872df4c sp=0x1872df48\r\nmath.init()\r\n        /usr/local/go/src/math/unsafe.go:21 +0x3f fp=0x1872df50 sp=0x1872df4c\r\nstrconv.init()\r\n        /usr/local/go/src/strconv/quote.go:455 +0x45 fp=0x1872df6c sp=0x1872df50\r\ngo/parser.init()\r\n        /usr/local/go/src/go/parser/parser.go:2462 +0x4a fp=0x1872df78 sp=0x1872df6c\r\nmain.init()\r\n        /usr/local/go/src/cmd/go/zdefaultcc.go:6 +0x45 fp=0x1872dfcc sp=0x1872df78\r\nruntime.main()\r\n        /usr/local/go/src/runtime/proc.go:58 +0xbd fp=0x1872dff0 sp=0x1872dfcc\r\nruntime.goexit()\r\n        /usr/local/go/src/runtime/asm_386.s:2287 +0x1 fp=0x1872dff4 sp=0x1872dff0\r\n\r\ngoroutine 2 [runnable]:\r\nruntime.forcegchelper()\r\n        /usr/local/go/src/runtime/proc.go:90\r\nruntime.goexit()\r\n        /usr/local/go/src/runtime/asm_386.s:2287 +0x1\r\n\r\ngoroutine 3 [runnable]:\r\nruntime.bgsweep()\r\n        /usr/local/go/src/runtime/mgc0.go:82\r\nruntime.goexit()\r\n        /usr/local/go/src/runtime/asm_386.s:2287 +0x1\r\n\r\neax     0x187360a0\r\nebx     0x8570650\r\necx     0x187000a0\r\nedx     0x42ba5bf3\r\nedi     0x7\r\nesi     0x2af0\r\nebp     0x187360a0\r\nesp     0x1872df48\r\neip     0x81f4ea9\r\neflags  0x10206\r\ncs      0x73\r\nfs      0x0\r\ngs      0x33\r\n\r\nroot@voyage:~# uname -a\r\nLinux voyage 3.16.7-ckt9-voyage #1 SMP Thu Apr 23 11:10:44 HKT 2015 i686 GNU/Linux\r\nroot@voyage:~# cat /proc/cpuinfo\r\nprocessor       : 0\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 8\r\nmodel name      : Pentium III (Coppermine)\r\nstepping        : 3\r\ncpu MHz         : 701.588\r\ncache size      : 256 KB\r\nphysical id     : 0\r\nsiblings        : 1\r\ncore id         : 0\r\ncpu cores       : 1\r\napicid          : 0\r\ninitial apicid  : 0\r\nfdiv_bug        : no\r\nf00f_bug        : no\r\ncoma_bug        : no\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 2\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 sep mtrr pge mca cmov pse36 mmx fxsr sse\r\nbogomips        : 1403.17\r\nclflush size    : 32\r\ncache_alignment : 32\r\naddress sizes   : 36 bits physical, 32 bits virtual\r\npower management:\r\n\r\nroot@voyage:~# uname -a\r\nLinux voyage 3.16.7-ckt9-voyage #1 SMP Thu Apr 23 11:10:44 HKT 2015 i586 GNU/Linux\r\nroot@voyage:~# cat /proc/cpuinfo\r\nprocessor       : 0\r\nvendor_id       : AuthenticAMD\r\ncpu family      : 5\r\nmodel           : 8\r\nmodel name      : AMD-K6(tm) 3D processor\r\nstepping        : 12\r\ncpu MHz         : 400.907\r\ncache size      : 64 KB\r\nphysical id     : 0\r\nsiblings        : 1\r\ncore id         : 0\r\ncpu cores       : 1\r\napicid          : 0\r\ninitial apicid  : 0\r\nfdiv_bug        : no\r\nf00f_bug        : no\r\ncoma_bug        : no\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 1\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr cx8 pge mmx syscall 3dnow k6_mtrr vmmcall\r\nbogomips        : 801.81\r\nclflush size    : 32\r\ncache_alignment : 32\r\naddress sizes   : 32 bits physical, 32 bits virtual\r\npower management:\r\n\r\nroot@voyage:~# uname -a\r\nLinux voyage 3.16.7-ckt9-voyage #1 SMP Thu Apr 23 11:10:44 HKT 2015 i586 GNU/Linux\r\nroot@voyage:~# cat /proc/cpuinfo\r\nprocessor       : 0\r\nvendor_id       : AuthenticAMD\r\ncpu family      : 5\r\nmodel           : 10\r\nmodel name      : Geode(TM) Integrated Processor by AMD PCS\r\nstepping        : 2\r\ncpu MHz         : 498.061\r\ncache size      : 128 KB\r\nphysical id     : 0\r\nsiblings        : 1\r\ncore id         : 0\r\ncpu cores       : 1\r\napicid          : 0\r\ninitial apicid  : 0\r\nfdiv_bug        : no\r\nf00f_bug        : no\r\ncoma_bug        : no\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 1\r\nwp              : yes\r\nflags           : fpu de pse tsc msr cx8 sep pge cmov clflush mmx mmxext 3dnowext 3dnow vmmcall\r\nbogomips        : 996.12\r\nclflush size    : 32\r\ncache_alignment : 32\r\naddress sizes   : 32 bits physical, 32 bits virtual\r\npower management:\r\n\r\nFinally I was able to create a gdrive binary which works with all 3 processors above when I use gccgo (on the Pentium D box):\r\ngo build -compiler gccgo -gccgoflags '-static-libgo' drive.go\r\n\r\nIt seems to me that probably something with the toolchain wrongly uses 64-bit instructions (asm stuff?) when using gc ...\r\n",
	"user": {
		"login": "gknauf",
		"id": 231773,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 2,
	"closed_at": "2015-07-08T21:55:32Z",
	"created_at": "2015-07-08T18:40:59Z",
	"updated_at": "2016-07-11T22:38:35Z"
}
