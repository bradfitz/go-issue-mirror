{
	"id": 121980365,
	"number": 13605,
	"state": "open",
	"title": "x/crypto/openpgp: handle \"gnu-dummy\" S2K",
	"body": "GPG added a \"gnu-dummy\" S2K type for keyrings that contain only subkey secret data ([like in this guide](https://alexcabal.com/creating-the-perfect-gpg-keypair/)). `openpgp.ReadKeyRing` returns an `unsupported feature: S2K function` error. Value `101` for a \"gnu-dummy\" S2K which `x/crypto/openpgp/s2k.Parse` doesn't recognize. Although [RFC 4880](https://tools.ietf.org/html/rfc4880#section-3.7) does not include this S2K, it does reserve `100` through `110` for extensions like this. These keys could be handled by adding `Dummy bool` field to encrypted keys and updating the S2K parser to recognize \"gnu-dummy\" type.\r\n\r\n``` go\r\npackage main\r\n\r\nimport (\r\n\t\"bytes\"\r\n\t\"encoding/base64\"\r\n\r\n\t\"golang.org/x/crypto/openpgp\"\r\n)\r\n\r\nfunc main() {\r\n\tdata, err := base64.StdEncoding.DecodeString(secring)\r\n\tif err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\r\n\tif _, err = openpgp.ReadKeyRing(bytes.NewBuffer(data)); err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n}\r\n\r\nvar secring = `lQCVBFZuSwwBBAC04VdUUq2REb7+IF/x21yOV3kIn798XRl7A7RiGcE9VpBjT5xMxtghWhH1mxyT+nrS36OJxdvtgJb3NB6hhh3qBQC6DmCGbWe61tT6TfyFbN6OvzZKMEa6RMunyd+2ErX4RLOcO+9X7a0weVASH5wRYjjqQtvPvt1/k25sloPnZQARAQAB/gNlAkdOVQG0EyA8dGVzdEBleGFtcGxlLmNvbT6IuAQTAQIAIgUCVm5LDAIbLwYLCQgHAwIGFQgCCQoLBBYCAwECHgECF4AACgkQwaXYFkPfLEVROQP/RF4GXi/yGm6yQoDNXFkFiwNhJndayfZxf5Qa+JWz1ltLyal7Dm1c+U6/R/7D25gmEslI+5YrHpbExWXyfG8DbX/5Ef9Be04e9IvjoZboeRpxmyb8IflEw90tJGL8YAK2xWohvayigPnjjhycZQPMuMK9X35o89oJs+p1MxcC9EOwAgAAnQH9BFZuSwwBBADBDfq8oUK8Jr8IVkQEEEZzQ7AWh03oTVodROebMz4vAk34HkrebZuxT4U/8yFIP+kJ3Yie3T8V6F8jF3a3ZUHNj2ghgxMbPH+kRKwBphvX8Fb5GtoFVbJq1tNMDaLhVRIkDLBTqQp/20spcuU5+OMzQRUt+Z6GxMaUwt5zLHPUgwARAQAB/gMDAvozhXZdexxPYMKrp7yC2FNNpVAC61hD0VQKvFeeeXZIGOBx57F1wVBNjuPyglji0kaX0m9yYI+I1V546END4aV/hXlZve3r6qYVE9W+T1imwx1NXPSb0j/nMmdiFYFXuyz70yEO+cDwHONzmRLdBZlP1DKYBcjF7rwF0gWuIoWgDYdfECo/aANSRQtKw5Q6UowQLzpHTV+X6iL/CbjIL5f81KXPMO1AubxzAW+iatzI7jfL0MvA1FxRpMjpHc1uyT8oIfic17PklbjcnLe5GH782AEGhXwn4bY1H+ss0bxmkJV9HkcMokJUVMQxKw+a6+/IuLXdFtcA5z4CDeIbt9rv+b8s0bfq9aW4kDxG3PDcyoMTrTuJLBd6/XwJgdtrmLSCtlU4fLzZEoAd2FVyWbS6Nys3eXgIBkRRokzKANknne78LpvIiamzinb0iJk2X+AYnRKoy1pUsC+unqaXm9YHfdpxv/OXLe13zhSJAT0EGAECAAkFAlZuSwwCGy4AqAkQwaXYFkPfLEWdIAQZAQIABgUCVm5LDAAKCRBv1XiTGF5T/qsmA/9LOUNetM1QtsJ71OVdXE3dutUZULE/27DTrA/vvSfhzSFj3U3FnyI7AVsiiiwmnJnthf0zaa2HYBL844Bm7drtzGBNVvddgIJZKBE0x2vUlTVc661e2FBhtLh6xX2nhEy9owc+C7PR9OXvGiET8tTRnUDUO3PgPkyALkHfQMWMR11sA/0YQl4wf3knjk83DVVhFK5fT2lW4hmSO74tuCAA4V71C8B5rJzVq2vy1L2bGHAroe+LtX30LtZM5qWKzZzK7jjo1/eaXimOkJcnnpg6jmUP7TMkWpU7hlOQ3ZHjS2K5xJYJqBwP86TWPtDLxYD3mTlYtp2dDT8ogV/sEPPd44yWlrACAAA=`\r\n```\r\n\r\nThe base64 encoded `secring` in the above contains a `gnu-dummy` S2K (notice the `gnu-dummy S2K` in the output):\r\n\r\n``` sh\r\n$ gpg --list-packets secring.gpg\r\n:secret key packet:\r\n\tversion 4, algo 1, created 1450068748, expires 0\r\n\tskey[0]: [1024 bits]\r\n\tskey[1]: [17 bits]\r\n\tgnu-dummy S2K, algo: 3, SHA1 protection, hash: 2\r\n\tprotect IV:\r\n\tkeyid: C1A5D81643DF2C45\r\n:user ID packet: \" \u003ctest@example.com\u003e\"\r\n:signature packet: algo 1, keyid C1A5D81643DF2C45\r\n\tversion 4, created 1450068748, md5len 0, sigclass 0x13\r\n\tdigest algo 2, begin of digest 51 39\r\n\thashed subpkt 2 len 4 (sig created 2015-12-14)\r\n\thashed subpkt 27 len 1 (key flags: 2F)\r\n\thashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)\r\n\thashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)\r\n\thashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)\r\n\thashed subpkt 30 len 1 (features: 01)\r\n\thashed subpkt 23 len 1 (key server preferences: 80)\r\n\tsubpkt 16 len 8 (issuer key ID C1A5D81643DF2C45)\r\n\tdata: [1023 bits]\r\n:trust packet: flag=00 sigcache=00\r\n:secret sub key packet:\r\n\tversion 4, algo 1, created 1450068748, expires 0\r\n\tskey[0]: [1024 bits]\r\n\tskey[1]: [17 bits]\r\n\titer+salt S2K, algo: 3, SHA1 protection, hash: 2, salt: fa3385765d7b1c4f\r\n\tprotect count: 65536 (96)\r\n\tprotect IV:  c2 ab a7 bc 82 d8 53 4d\r\n\tencrypted stuff follows\r\n\tkeyid: 6FD57893185E53FE\r\n:signature packet: algo 1, keyid C1A5D81643DF2C45\r\n\tversion 4, created 1450068748, md5len 0, sigclass 0x18\r\n\tdigest algo 2, begin of digest 5d 6c\r\n\thashed subpkt 2 len 4 (sig created 2015-12-14)\r\n\thashed subpkt 27 len 1 (key flags: 2E)\r\n\tsubpkt 16 len 8 (issuer key ID C1A5D81643DF2C45)\r\n\tsubpkt 32 len 156 (signature: v4, class 0x19, algo 1, digest algo 2)\r\n\tdata: [1021 bits]\r\n:trust packet: flag=00 sigcache=00\r\n```",
	"user": {
		"login": "benburkert",
		"id": 77,
		"type": "User",
		"site_admin": false
	},
	"comments": 11,
	"created_at": "2015-12-14T06:07:10Z",
	"updated_at": "2016-04-06T14:11:32Z",
	"milestone": {
		"id": 1067491,
		"number": 22,
		"title": "Unreleased"
	}
}
