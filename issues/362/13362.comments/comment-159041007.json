{
	"id": 159041007,
	"body": "Reproduced with somewhat more detailed stack barrier debugging. The @@@ in the stack barrier list indicates stkbarPos and the ==\u003e indicates the mismatched stack barrier. The fact that we failed this far in to the stack barrier list suggests to me that we did a stack copy while *in the middle* of `gentraceback`. This is further supported by the fact that the panic itself was able to traceback without hitting this same panic. Based on the sp's in the panic and the stack barrier positions of the stack barriers we've hit (before the @@@), we're tracing the pre-copy stack (at 0xc280199\\*) and the stack has been moved to 0xc8200ef\\*.\r\n\r\nStack barrier list:\r\n\r\n```\r\n*0xc820199070=0x41a62c\r\n*0xc8201990f0=0x40eb64\r\n*0xc8201991c8=0x40f709\r\n*0xc820199208=0x43ec25\r\n*0xc820199258=0x48d542\r\n@@@\r\n*0xc8200ef290=0x48d580\r\n*0xc8200ef2c8=0x48d580\r\n*0xc8200ef300=0x48d580\r\n*0xc8200ef338=0x48d580\r\n*0xc8200ef370=0x48d580\r\n*0xc8200ef3a8=0x48d580\r\n*0xc8200ef3e0=0x48d580\r\n*0xc8200ef418=0x48d580\r\n*0xc8200ef450=0x48d580\r\n*0xc8200ef488=0x48d580\r\n*0xc8200ef4c0=0x48d580\r\n*0xc8200ef4f8=0x48d580\r\n*0xc8200ef530=0x48d580\r\n*0xc8200ef568=0x48d580\r\n*0xc8200ef5a0=0x48d580\r\n*0xc8200ef5d8=0x48d580\r\n*0xc8200ef610=0x48d580\r\n*0xc8200ef648=0x48d580\r\n*0xc8200ef680=0x48d580\r\n*0xc8200ef6b8=0x48d580\r\n*0xc8200ef6f0=0x48d580\r\n==\u003e\r\n*0xc8200ef728=0x48d580\r\n*0xc8200ef760=0x48d580\r\n*0xc8200ef798=0x48d580\r\n*0xc8200ef7d0=0x48d580\r\n*0xc8200ef808=0x48d580\r\n*0xc8200ef840=0x48d580\r\n*0xc8200ef878=0x48d580\r\n*0xc8200ef8b0=0x48d580\r\n*0xc8200ef8e8=0x48d580\r\n*0xc8200ef920=0x48d580\r\n*0xc8200ef958=0x48d580\r\n*0xc8200ef990=0x48d580\r\n*0xc8200ef9c8=0x48d580\r\n*0xc8200efa00=0x48d580\r\n*0xc8200efa38=0x48d580\r\n*0xc8200efa70=0x48d580\r\n*0xc8200efaa8=0x48d580\r\n*0xc8200efae0=0x48d580\r\n*0xc8200efb18=0x48d580\r\n*0xc8200efb50=0x48d580\r\n*0xc8200efb88=0x48d580\r\n*0xc8200efbc0=0x48f524\r\n*0xc8200efbf0=0x48bad3\r\n*0xc8200efe48=0x48d4db\r\n*0xc8200eff90=0x47c018\r\n*0xc8200effc8=0x45bb31\r\n```\r\n\r\nTraceback:\r\n\r\n```\r\n--- FAIL: TestStackBarrierProfiling (2.30s)\r\n        pprof_test.go:338: subprocess failed with exit status 2:\r\n                found next stack barrier at 0xc820199728; expected [*0xc820199070=0x41a62c *0xc8201990f0=0x40eb64 *0xc8201991c8=0x40f709 *0xc820199208=0x43ec25 *0xc820199258=0x48d542 @@@ *0xc8200ef290=0x48d580 *0xc8200ef2c8=0x48d580 *0xc8200ef300=0x48d580 *0xc8200ef338=0x48d580 *0xc8200ef370=0x48d580 *0xc8200ef3a8=0x48d580 *0xc8200ef3e0=0x48d580 *0xc8200ef418=0x48d580 *0xc8200ef450=0x48d580 *0xc8200ef488=0x48d580 *0xc8200ef4c0=0x48d580 *0xc8200ef4f8=0x48d580 *0xc8200ef530=0x48d580 *0xc8200ef568=0x48d580 *0xc8200ef5a0=0x48d580 *0xc8200ef5d8=0x48d580 *0xc8200ef610=0x48d580 *0xc8200ef648=0x48d580 *0xc8200ef680=0x48d580 *0xc8200ef6b8=0x48d580 *0xc8200ef6f0=0x48d580 ==\u003e *0xc8200ef728=0x48d580 *0xc8200ef760=0x48d580 *0xc8200ef798=0x48d580 *0xc8200ef7d0=0x48d580 *0xc8200ef808=0x48d580 *0xc8200ef840=0x48d580 *0xc8200ef878=0x48d580 *0xc8200ef8b0=0x48d580 *0xc8200ef8e8=0x48d580 *0xc8200ef920=0x48d580 *0xc8200ef958=0x48d580 *0xc8200ef990=0x48d580 *0xc8200ef9c8=0x48d580 *0xc8200efa00=0x48d580 *0xc8200efa38=0x48d580 *0xc8200efa70=0x48d580 *0xc8200efaa8=0x48d580 *0xc8200efae0=0x48d580 *0xc8200efb18=0x48d580 *0xc8200efb50=0x48d580 *0xc8200efb88=0x48d580 *0xc8200efbc0=0x48f524 *0xc8200efbf0=0x48bad3 *0xc8200efe48=0x48d4db *0xc8200eff90=0x47c018 *0xc8200effc8=0x45bb31]\r\n                fatal error: missed stack barrier\r\n                \r\n                goroutine 0 [idle]:\r\n                runtime.throw(0x5f0c40, 0x14)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/panic.go:530 +0x90 fp=0xc8200fb4b0 sp=0xc8200fb498\r\n                runtime.gentraceback(0x45c9c3, 0xc820084ea0, 0x0, 0xc82008a600, 0x0, 0xc8200fb778, 0x40, 0x0, 0x0, 0x6, ...)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/traceback.go:295 +0x1587 fp=0xc8200fb708 sp=0xc8200fb4b0\r\n                runtime.sigprof(0x45c9c3, 0xc820084ea0, 0x0, 0xc82008a600, 0xc820078c00)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/proc.go:2937 +0x533 fp=0xc8200fb9d8 sp=0xc8200fb708\r\n                runtime.sighandler(0xc80000001b, 0xc8200fbbf0, 0xc8200fbac0, 0xc82008a600)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/signal_amd64x.go:48 +0xbe fp=0xc8200fba70 sp=0xc8200fb9d8\r\n                runtime.sigtrampgo(0x1b, 0xc8200fbbf0, 0xc8200fbac0)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/signal_linux.go:21 +0x95 fp=0xc8200fbaa0 sp=0xc8200fba70\r\n                runtime.sigtramp(0x1, 0x0, 0xc8200f8000, 0x0, 0x4000, 0x0, 0x0, 0x0, 0x212, 0x1400, ...)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/sys_linux_amd64.s:234 +0x1b fp=0xc8200fbac0 sp=0xc8200fbaa0\r\n                runtime.sigreturn(0x0, 0xc8200f8000, 0x0, 0x4000, 0x0, 0x0, 0x0, 0x212, 0x1400, 0x400, ...)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/sys_linux_amd64.s:238 fp=0xc8200fbac8 sp=0xc8200fbac0\r\n                \r\n                goroutine 13 [garbage collection]:\r\n                runtime.systemstack_switch()\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/asm_amd64.s:245 fp=0xc8200eedd0 sp=0xc8200eedc8\r\n                runtime.gcMarkTermination()\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/mgc.go:1173 +0x136 fp=0xc8200ef020 sp=0xc8200eedd0\r\n                runtime.gcMarkDone()\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/mgc.go:1137 +0x286 fp=0xc8200ef040 sp=0xc8200ef020\r\n                runtime.gcAssistAlloc(0xc8200d8000)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/mgcmark.go:428 +0x18c fp=0xc8200ef0c0 sp=0xc8200ef040\r\n                runtime.mallocgc(0x400, 0x553360, 0xc800000001, 0x0)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/malloc.go:533 +0x184 fp=0xc8200ef198 sp=0xc8200ef0c0\r\n                runtime.newarray(0x553360, 0x400, 0xc820116400)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/malloc.go:795 +0xc9 fp=0xc8200ef1d8 sp=0xc8200ef198\r\n                runtime.makeslice(0x54a6c0, 0x400, 0x400, 0x0, 0x0, 0x0)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/slice.go:32 +0x165 fp=0xc8200ef228 sp=0xc8200ef1d8\r\n                runtime/pprof_test.deepStack(0x3bd, 0xc820116400)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/pprof/pprof_test.go:368 +0x52 fp=0xc8200ef260 sp=0xc8200ef228\r\n                runtime/pprof_test.deepStack(0x3be, 0xc820116000)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/pprof/pprof_test.go:369 +0x90 fp=0xc8200ef298 sp=0xc8200ef260\r\n                runtime/pprof_test.deepStack(0x3bf, 0x400)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/pprof/pprof_test.go:369 +0x90 fp=0xc8200ef2d0 sp=0xc8200ef298\r\n                runtime/pprof_test.deepStack(0x3c0, 0x400)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/pprof/pprof_test.go:369 +0x90 fp=0xc8200ef308 sp=0xc8200ef2d0\r\n                runtime/pprof_test.deepStack(0x3c1, 0x400)\r\n                        /usr/local/google/home/austin/go.dev/src/runtime/pprof/pprof_test.go:369 +0x90 fp=0xc8200ef340 sp=0xc8200ef308\r\n...\r\n```",
	"user": {
		"login": "aclements",
		"id": 2688315,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2015-11-23T19:41:23Z",
	"updated_at": "2015-11-23T19:41:23Z"
}
