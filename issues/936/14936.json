{
	"id": 143085606,
	"number": 14936,
	"state": "closed",
	"title": "image/png: decoding of trailing IDAT chunks",
	"body": "Decoding of some PNG files generated by GDAL2Tiles (raster map tile generator) fails with the error message \"not enough pixel data\". Most other decoders can read these files without any issues.\r\n\r\nEven though the error message suggests otherwise, the problematic files actually contain too much data. Following the expected IDAT chunks containing all of the image data, there is an additional zero-length IDAT chunk.\r\n\r\nAccording to the [PNG specification](https://www.w3.org/TR/PNG/#12Compression), zero-length IDAT chunks are valid. Trailing garbage may not be valid, but the spec explicitly allows ignoring of errors that have no effect on the processing of the image.\r\n\r\nThe error message \"not enough pixel data\" is generated after the decoder successfully decodes the image: it then encounters the trailing zero-length IDAT chunk and attempts to decode it as if it were the first IDAT chunk in the image.\r\n\r\nNo error is generated when the decoder encounters trailing IDAT chunks that contain actual image data, as long as that image data can be decoded with the PNG header (and palette) already seen. This allows users to craft images that trick the decoder into decoding a second image appended after the first. \r\n\r\nSee the image below, which most decoders will show as plain white, while image/png will happily reveal the gopher hidden within:\r\n![hiddengopher](https://cloud.githubusercontent.com/assets/8324390/14001485/6313fb8c-f146-11e5-8896-f49fee7ce6d4.png)\r\n\r\nCL with proposed fix following.",
	"user": {
		"login": "tdilo",
		"id": 8324390,
		"type": "User",
		"site_admin": false
	},
	"comments": 1,
	"closed_at": "2016-03-24T10:57:19Z",
	"created_at": "2016-03-23T21:33:35Z",
	"updated_at": "2016-03-24T10:57:19Z"
}
