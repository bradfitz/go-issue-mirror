{
	"id": 249249230,
	"body": "@sisoftrg thanks for the reproducer.\r\nI can reproduce this on tip.\r\n\r\nThere are 2 bugs. First is that race detector incorrectly subtracts 1 (or maybe somebody forgot to add 1) to a PC, so it asks to symbolize off by one PC:\r\n\r\n```\r\n  438a5b:       e8 f0 6e 02 00          callq  45f950 \u003cruntime.write\u003e\r\n  438a60:       c7 04 24 01 00 00 00    movl   $0x1,(%rsp)\r\n  438a67:       e8 84 6e 02 00          callq  45f8f0 \u003cruntime.exit\u003e\r\n  438a6c:       e9 e7 fe ff ff          jmpq   438958 \u003cruntime.needm+0x28\u003e\r\n  438a71:       e8 6a 9a ff ff          callq  4324e0 \u003cruntime.panicindex\u003e\r\n  438a76:       0f 0b                   ud2    \r\n  438a78:       cc                      int3   \r\n  438a79:       cc                      int3   \r\n  438a7a:       cc                      int3   \r\n  438a7b:       cc                      int3   \r\n  438a7c:       cc                      int3   \r\n  438a7d:       cc                      int3   \r\n  438a7e:       cc                      int3   \r\n  438a7f:       cc                      int3     /// \u003c\u003c\u003c\u003c\u003c\u003c THIS ONE (most likely must be the next byte)\r\n\r\n0000000000438a80 \u003cruntime.newextram\u003e:\r\n  438a80:       64 48 8b 0c 25 f8 ff    mov    %fs:0xfffffffffffffff8,%rcx\r\n  438a87:       ff ff \r\n  438a89:       48 3b 61 10             cmp    0x10(%rcx),%rsp\r\n  438a8d:       76 7c                   jbe    438b0b \u003cruntime.newextram+0x8b\u003e\r\n  438a8f:       48 83 ec 28             sub    $0x28,%rsp\r\n  438a93:       48 89 6c 24 20          mov    %rbp,0x20(%rsp)\r\n```\r\n\r\nSecond is that gentraceback crashes on this (I guess user can trigger this crash by calling one of public runtime functions as well):\r\n```\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n[Switching to Thread 0x7ffff6ff5700 (LWP 144105)]\r\n0x0000000000450645 in runtime.gentraceback () at /usr/local/google/home/dvyukov/src/go/src/runtime/traceback.go:295\r\n295\t\t\t\t\t\tframe.lr = uintptr(*(*sys.Uintreg)(unsafe.Pointer(lrPtr)))\r\n(gdb) bt\r\n#0  0x0000000000450645 in runtime.gentraceback () at /usr/local/google/home/dvyukov/src/go/src/runtime/traceback.go:295\r\n#1  0x00000000004514c1 in runtime.traceback1 () at /usr/local/google/home/dvyukov/src/go/src/runtime/traceback.go:661\r\n#2  0x0000000000451312 in runtime.traceback () at /usr/local/google/home/dvyukov/src/go/src/runtime/traceback.go:622\r\n#3  0x0000000000451fe2 in runtime.tracebackothers () at /usr/local/google/home/dvyukov/src/go/src/runtime/traceback.go:767\r\n#4  0x0000000000434633 in runtime.dopanic_m () at /usr/local/google/home/dvyukov/src/go/src/runtime/panic.go:659\r\n#5  0x000000000045718c in runtime.dopanic.func1 () at /usr/local/google/home/dvyukov/src/go/src/runtime/panic.go:543\r\n#6  0x000000000045c10b in runtime.systemstack () at /usr/local/google/home/dvyukov/src/go/src/runtime/asm_amd64.s:314\r\n#7  0x0000000000434050 in runtime.dopanic () at /usr/local/google/home/dvyukov/src/go/src/runtime/panic.go:544\r\n#8  0x0000000000434105 in runtime.throw () at /usr/local/google/home/dvyukov/src/go/src/runtime/panic.go:556\r\n#9  0x000000000044bbfa in runtime.pcvalue () at /usr/local/google/home/dvyukov/src/go/src/runtime/symtab.go:494\r\n#10 0x000000000044beb6 in runtime.funcline1 () at /usr/local/google/home/dvyukov/src/go/src/runtime/symtab.go:518\r\n#11 0x000000000044c00a in runtime.funcline () at /usr/local/google/home/dvyukov/src/go/src/runtime/symtab.go:529\r\n#12 0x0000000000440e81 in runtime.raceSymbolizeCode () at /usr/local/google/home/dvyukov/src/go/src/runtime/race.go:106\r\n#13 0x0000000000440d88 in runtime.racecallback () at /usr/local/google/home/dvyukov/src/go/src/runtime/race.go:85\r\n#14 0x000000000045f886 in runtime.racecallbackthunk () at /usr/local/google/home/dvyukov/src/go/src/runtime/race_amd64.s:424\r\n#15 0x0000000000464194 in __tsan::SymbolizeCode(unsigned long) ()\r\n```",
	"user": {
		"login": "dvyukov",
		"id": 1095328,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-09-23T17:11:09Z",
	"updated_at": "2016-09-23T17:11:09Z"
}
