{
	"id": 66099987,
	"body": "\u003ca id=\"c9\"\u003e\u003c/a\u003eComment 9 by **ronee.9**:\n\n\u003cpre\u003eFollowing is the code, it sends 3 http request and it generate three chan receive blocks\nas the profile shown after the code\n\npackage main\n\nimport (\n\t\"fmt\"\n\t\"net/http\"\n\t//\"encoding/xml\"\n\t\"bytes\"\n\t\"io/ioutil\"\n\t//\"log\"\n\t\"net\"\n\t\"net/http/httputil\"\n\t_ \"net/http/pprof\"\n\t\"strconv\"\n\t\"time\"\n)\n\nconst (\n\tCONNECTION_TIMEOUT      = 20\n\tRESPONSE_HEADER_TIMEOUT = 60\n\tHTTP_TIMEOUT            = 90\n)\n\nfunc TimeoutDialer(connectTimeout time.Duration) func(net, addr string) (net.Conn,\nerror) {\n\treturn func(network, address string) (net.Conn, error) {\n\t\tconn, err := net.DialTimeout(network, address, connectTimeout)\n\t\treturn conn, err\n\t}\n}\n\nfunc NewDefaultTimeoutClient() *http.Client {\n\treturn NewTimeoutClient(CONNECTION_TIMEOUT*time.Second, RESPONSE_HEADER_TIMEOUT*time.Second)\n}\n\nfunc NewTimeoutClient(connectTimeout time.Duration, responseHeaderTimeout time.Duration)\n*http.Client {\n\treturn \u0026http.Client{\n\t\tTransport: \u0026http.Transport{\n\t\t\tDial: TimeoutDialer(connectTimeout),\n\t\t\tResponseHeaderTimeout: responseHeaderTimeout,\n\t\t},\n\t\tTimeout: HTTP_TIMEOUT * time.Second,\n\t}\n}\n\nfunc main() {\n\tgo http.ListenAndServe(\":6168\", nil) //profiling\n\tclient := NewDefaultTimeoutClient()\n\tfor i := 0; i \u0026lt; 3; i++ {\n\t\tfmt.Println(\"Test \", i)\n\t\tcontent := fmt.Sprintf(\"api_key=%s\u0026api_secret=%s\u0026from=%s\u0026to=%s\u0026text=test%d\u0026status-report-req=1\",\n\t\t\t\"xxx\", \"xxx\", \"xxx\", \"1234\", i)\n\t\tbuf := bytes.NewBufferString(content)\n\t\treq, err := http.NewRequest(\"POST\", \"\u003ca href=\"http://xxx\"\u003ehttp://xxx\u003c/a\u003e\", buf)\n\t\tif err == nil {\n\t\t\treq.Header.Add(\"Content-type\", \"application/x-www-form-urlencoded\")\n\t\t\treq.Header.Add(\"Content-Length\", strconv.Itoa(len(content)))\n\t\t\toutput, _ := httputil.DumpRequestOut(req, true)\n\t\t\tfmt.Println(\"DEBUG: \", string(output))\n\t\t\tresp, err := client.Do(req)\n\t\t\tif err == nil {\n\t\t\t\trespStr, err := ioutil.ReadAll(resp.Body)\n\t\t\t\tif err == nil {\n\t\t\t\t\tfmt.Println(\"resp: \", string(respStr))\n\t\t\t\t} else {\n\t\t\t\t\tfmt.Println(\"ERROR: \", err)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfmt.Println(\"ERROR: \", err)\n\t\t\t}\n\t\t\tresp.Body.Close()\n\t\t} else {\n\t\t\tfmt.Println(\"ERROR: \", err)\n\t\t}\n\t\ttime.Sleep(30 * time.Second)\n\t}\n\ttime.Sleep(600 * time.Second)\n}\n\n\ngoroutine 35 [running]:\nruntime/pprof.writeGoroutineStacks(0x382178, 0xc08203a140, 0x0, 0x0)\n\tD:/Go/src/pkg/runtime/pprof/pprof.go:511 +0x93\nruntime/pprof.writeGoroutine(0x382178, 0xc08203a140, 0x2, 0x0, 0x0)\n\tD:/Go/src/pkg/runtime/pprof/pprof.go:500 +0x55\nruntime/pprof.(*Profile).WriteTo(0x904e80, 0x382178, 0xc08203a140, 0x2, 0x0, 0x0)\n\tD:/Go/src/pkg/runtime/pprof/pprof.go:229 +0xda\nnet/http/pprof.handler.ServeHTTP(0xc08201ae51, 0x9, 0x3820f0, 0xc08203a140, 0xc08201edd0)\n\tD:/Go/src/pkg/net/http/pprof/pprof.go:165 +0x277\nnet/http/pprof.Index(0x3820f0, 0xc08203a140, 0xc08201edd0)\n\tD:/Go/src/pkg/net/http/pprof/pprof.go:177 +0x167\nnet/http.HandlerFunc.ServeHTTP(0x7e6368, 0x3820f0, 0xc08203a140, 0xc08201edd0)\n\tD:/Go/src/pkg/net/http/server.go:1235 +0x47\nnet/http.(*ServeMux).ServeHTTP(0xc08201a090, 0x3820f0, 0xc08203a140, 0xc08201edd0)\n\tD:/Go/src/pkg/net/http/server.go:1511 +0x1aa\nnet/http.serverHandler.ServeHTTP(0xc08200e5a0, 0x3820f0, 0xc08203a140, 0xc08201edd0)\n\tD:/Go/src/pkg/net/http/server.go:1673 +0x1a6\nnet/http.(*conn).serve(0xc082048600)\n\tD:/Go/src/pkg/net/http/server.go:1174 +0xa85\ncreated by net/http.(*Server).Serve\n\tD:/Go/src/pkg/net/http/server.go:1721 +0x31a\n\ngoroutine 16 [sleep, 3 minutes]:\ntime.Sleep(0x8bb2c97000)\n\tC:/Users/ADMINI~1/AppData/Local/Temp/2/makerelease686069423/go/src/pkg/runtime/time.goc:39 +0x38\nmain.main()\n\tD:/workspace/beetalk_server/go_projects/src/garena.com/TestSMS/TestSMS.go:75 +0x89c\n\ngoroutine 19 [finalizer wait, 7 minutes]:\nruntime.park(0x4160d0, 0x910c78, 0x90e609)\n\tD:/Go/src/pkg/runtime/proc.c:1369 +0xac\nruntime.parkunlock(0x910c78, 0x90e609)\n\tD:/Go/src/pkg/runtime/proc.c:1385 +0x42\nrunfinq()\n\tD:/Go/src/pkg/runtime/mgc0.c:2644 +0xdd\nruntime.goexit()\n\tD:/Go/src/pkg/runtime/proc.c:1445\n\ngoroutine 24 [chan receive, 6 minutes]:\nnet/http.(*persistConn).readLoop(0xc08203e160)\n\tD:/Go/src/pkg/net/http/transport.go:798 +0x312\ncreated by net/http.(*Transport).dialConn\n\tD:/Go/src/pkg/net/http/transport.go:600 +0x946\n\ngoroutine 21 [IO wait]:\nnet.runtime_pollWait(0x381dc0, 0x72, 0x0)\n\tC:/Users/ADMINI~1/AppData/Local/Temp/2/makerelease686069423/go/src/pkg/runtime/netpoll.goc:146 +0x6d\nnet.(*pollDesc).Wait(0xc082080170, 0x72, 0x0, 0x0)\n\tD:/Go/src/pkg/net/fd_poll_runtime.go:84 +0x4d\nnet.(*ioSrv).ExecIO(0xc082038078, 0xc082080060, 0x750910, 0x8, 0xc082000980,\n0xc082080480, 0x0, 0x0)\n\tD:/Go/src/pkg/net/fd_windows.go:188 +0x242\nnet.(*netFD).acceptOne(0xc082080000, 0x7e6298, 0xc08205a1c0, 0x2, 0x2, 0xc082080060,\n0x7167a0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/fd_windows.go:539 +0x3c7\nnet.(*netFD).accept(0xc082080000, 0x7e6298, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/fd_windows.go:566 +0x187\nnet.(*TCPListener).AcceptTCP(0xc0820380d8, 0x45e0ca, 0x0, 0x0)\n\tD:/Go/src/pkg/net/tcpsock_posix.go:234 +0x64\nnet/http.tcpKeepAliveListener.Accept(0xc0820380d8, 0x0, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/http/server.go:1947 +0x52\nnet/http.(*Server).Serve(0xc08200e5a0, 0x381f48, 0xc0820380d8, 0x0, 0x0)\n\tD:/Go/src/pkg/net/http/server.go:1698 +0x98\nnet/http.(*Server).ListenAndServe(0xc08200e5a0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/http/server.go:1688 +0x154\nnet/http.ListenAndServe(0x7325f0, 0x5, 0x0, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/http/server.go:1778 +0x80\ncreated by main.main\n\tD:/workspace/beetalk_server/go_projects/src/garena.com/TestSMS/TestSMS.go:45 +0x59\n\ngoroutine 45 [IO wait]:\nnet.runtime_pollWait(0x381e70, 0x72, 0x0)\n\tC:/Users/ADMINI~1/AppData/Local/Temp/2/makerelease686069423/go/src/pkg/runtime/netpoll.goc:146 +0x6d\nnet.(*pollDesc).Wait(0xc0820802f0, 0x72, 0x0, 0x0)\n\tD:/Go/src/pkg/net/fd_poll_runtime.go:84 +0x4d\nnet.(*ioSrv).ExecIO(0xc082038078, 0xc0820801e0, 0x73ab90, 0x7, 0x7e6228, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/fd_windows.go:188 +0x242\nnet.(*netFD).Read(0xc082080180, 0xc082070000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/fd_windows.go:451 +0x156\nnet.(*conn).Read(0xc082038060, 0xc082070000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/net.go:122 +0xee\nnet/http.(*liveSwitchReader).Read(0xc0820482a8, 0xc082070000, 0x1000, 0x1000, 0x0, 0x0,\n0x0)\n\tD:/Go/src/pkg/net/http/server.go:206 +0xb6\nio.(*LimitedReader).Read(0xc0820053a0, 0xc082070000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/io/io.go:399 +0xd7\nbufio.(*Reader).fill(0xc08200ee40)\n\tD:/Go/src/pkg/bufio/bufio.go:97 +0x1ba\nbufio.(*Reader).ReadSlice(0xc08200ee40, 0xc08203e00a, 0x0, 0x0, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/bufio/bufio.go:298 +0x233\nbufio.(*Reader).ReadLine(0xc08200ee40, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/bufio/bufio.go:326 +0x70\nnet/textproto.(*Reader).readLineSlice(0xc08201ae10, 0x0, 0x0, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/textproto/reader.go:55 +0xa4\nnet/textproto.(*Reader).ReadLine(0xc08201ae10, 0x0, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/textproto/reader.go:36 +0x55\nnet/http.ReadRequest(0xc08200ee40, 0xc08201ef70, 0x0, 0x0)\n\tD:/Go/src/pkg/net/http/request.go:556 +0xce\nnet/http.(*conn).readRequest(0xc082048280, 0x0, 0x0, 0x0)\n\tD:/Go/src/pkg/net/http/server.go:577 +0x27d\nnet/http.(*conn).serve(0xc082048280)\n\tD:/Go/src/pkg/net/http/server.go:1132 +0x625\ncreated by net/http.(*Server).Serve\n\tD:/Go/src/pkg/net/http/server.go:1721 +0x31a\n\ngoroutine 33 [chan receive, 6 minutes]:\nnet/http.(*persistConn).readLoop(0xc08203e420)\n\tD:/Go/src/pkg/net/http/transport.go:798 +0x312\ncreated by net/http.(*Transport).dialConn\n\tD:/Go/src/pkg/net/http/transport.go:600 +0x946\n\ngoroutine 39 [chan receive, 3 minutes]:\nnet/http.(*persistConn).readLoop(0xc08203e6e0)\n\tD:/Go/src/pkg/net/http/transport.go:798 +0x312\ncreated by net/http.(*Transport).dialConn\n\tD:/Go/src/pkg/net/http/transport.go:600 +0x946\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2014-12-03T06:27:23Z",
	"updated_at": "2014-12-22T06:38:01Z"
}
