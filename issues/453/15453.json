{
	"id": 151200064,
	"number": 15453,
	"state": "open",
	"title": "cmd/compile: unusual line numbers associated with generated code",
	"body": "The assembly listing of go/internal/gcimporter shows some unusual (wrong?) line numbers associated with the generated code. In the code for the method `importer.obj` we see references to gcimporter.go, even though there is no code here that should be coming from that file (also no inlining).\r\nHere a snippet compiled with -ssa=0:\r\n```\r\n\t0x01d1 00465 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:193)\tCMPB\truntime.writeBarrier(SB), $0\r\n\t0x01d8 00472 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:193)\tJNE\t$0, 551\r\n\t0x01da 00474 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:193)\tMOVQ\tBP, 48(AX)\r\n\t0x01de 00478 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:935)\tNOP\r\n\t0x01de 00478 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:935)\tMOVL\t$0, 56(AX)\r\n\t0x01e5 00485 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:935)\tNOP\r\n\t0x01e5 00485 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:935)\tMOVQ\t$0, 64(AX)\r\n\t0x01ed 00493 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:193)\tMOVQ\t\"\".p+488(FP), BX\r\n\t0x01f5 00501 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:193)\tMOVQ\tBX, (SP)\r\n\t0x01f9 00505 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:193)\tLEAQ\tgo.itab.*go/types.Func,go/types.\r\n```\r\nHere a snippet compiled with ssa enabled:\r\n```\r\n\t0x0154 00340 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tMOVQ\t\"\".typ·5.data+176(SP), CX\r\n\t0x015c 00348 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tMOVQ\tCX, 48(AX)\r\n\t0x0160 00352 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVL\t$0, 56(AX)\r\n\t0x0167 00359 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t$0, 64(AX)\r\n\t0x016f 00367 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tMOVQ\t\"\".p+280(FP), CX\r\n\t0x0177 00375 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tMOVQ\tCX, (SP)\r\n```\r\nAnd here a snippet compiled using the binary export format:\r\n```\r\n\t0x00e2 00226 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tXORPS\tX0, X0\r\n\t0x00e5 00229 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tDUFFZERO\t$277\r\n\t0x00ea 00234 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t$0, (AX)\r\n\t0x00f1 00241 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t$0, 8(AX)\r\n\t0x00f9 00249 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVL\truntime.writeBarrier(SB), CX\r\n\t0x00ff 00255 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tLEAQ\t16(AX), DX\r\n\t0x0103 00259 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tTESTB\tCL, CL\r\n\t0x0105 00261 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tJNE\t$0, 474\r\n\t0x010b 00267 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\tgo/types.pkg·3+200(SP), CX\r\n\t0x0113 00275 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\tCX, 16(AX)\r\n\t0x0117 00279 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t\"\".name·4.len+80(SP), CX\r\n\t0x011c 00284 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\tCX, 32(AX)\r\n\t0x0120 00288 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVL\truntime.writeBarrier(SB), CX\r\n\t0x0126 00294 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tLEAQ\t24(AX), DX\r\n\t0x012a 00298 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tTESTB\tCL, CL\r\n\t0x012c 00300 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tJNE\t$0, 442\r\n\t0x0132 00306 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t\"\".name·4.ptr+232(SP), CX\r\n\t0x013a 00314 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\tCX, 24(AX)\r\n\t0x013e 00318 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t\"\".typ·5.itab+152(SP), CX\r\n\t0x0146 00326 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\tCX, 40(AX)\r\n\t0x014a 00330 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVL\truntime.writeBarrier(SB), CX\r\n\t0x0150 00336 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tTESTB\tCL, CL\r\n\t0x0152 00338 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tJNE\t$0, 409\r\n\t0x0154 00340 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t\"\".typ·5.data+176(SP), CX\r\n\t0x015c 00348 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\tCX, 48(AX)\r\n\t0x0160 00352 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVL\t$0, 56(AX)\r\n\t0x0167 00359 (/Users/gri/go/src/go/internal/gcimporter/gcimporter.go:882)\tMOVQ\t$0, 64(AX)\r\n\t0x016f 00367 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tMOVQ\t\"\".p+280(FP), CX\r\n\t0x0177 00375 (/Users/gri/go/src/go/internal/gcimporter/bimport.go:185)\tMOVQ\tCX, (SP)\r\n```\r\nThe issue appears independent of ssa and independent of the export format chosen, but it somewhat affected by both. This may be all correct but needs an explanation, or there may be an issue and we should fix it.",
	"user": {
		"login": "griesemer",
		"id": 8528975,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "NeedsFix"
		}
	],
	"comments": 8,
	"created_at": "2016-04-26T18:01:43Z",
	"updated_at": "2016-10-21T04:44:49Z",
	"milestone": {
		"id": 2053058,
		"number": 49,
		"title": "Go1.9"
	}
}
