{
	"id": 140077071,
	"number": 14766,
	"state": "closed",
	"title": "runtime: TestCgoCCodeSIGPROF hangs",
	"body": "go version devel +31d13f4 Fri Mar 11 00:56:04 2016 +0000 linux/386\r\n\r\nRunning\r\n```\r\ngo test -run=TestCgoCCodeSIGPROF runtime\r\n```\r\nhangs forever.\r\n\r\nPressing ctrl+\\ prints:\r\n```\r\nSIGQUIT: quit\r\nPC=0x809c88d m=0\r\n\r\ngoroutine 0 [idle]:\r\nruntime.futex(0x831d4e4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x831d190, ...)\r\n\t/root/go/src/runtime/sys_linux_386.s:289 +0x1d fp=0xbfcca62c sp=0xbfcca628\r\nruntime.futexsleep(0x831d4e4, 0x0, 0xffffffff, 0xffffffff)\r\n\t/root/go/src/runtime/os1_linux.go:40 +0x55 fp=0xbfcca658 sp=0xbfcca62c\r\nruntime.notesleep(0x831d4e4)\r\n\t/root/go/src/runtime/lock_futex.go:145 +0x9e fp=0xbfcca670 sp=0xbfcca658\r\nruntime.stoplockedm()\r\n\t/root/go/src/runtime/proc.go:1664 +0x9e fp=0xbfcca680 sp=0xbfcca670\r\nruntime.schedule()\r\n\t/root/go/src/runtime/proc.go:2012 +0x66 fp=0xbfcca6a0 sp=0xbfcca680\r\nruntime.park_m(0x185000d0)\r\n\t/root/go/src/runtime/proc.go:2117 +0x154 fp=0xbfcca6b4 sp=0xbfcca6a0\r\nruntime.mcall(0xbfcca6c8)\r\n\t/root/go/src/runtime/asm_386.s:255 +0x47 fp=0xbfcca6bc sp=0xbfcca6b4\r\n\r\ngoroutine 1 [chan receive, locked to thread]:\r\nruntime.gopark(0x826dd0c, 0x1854a3f0, 0x8231b0a, 0xc, 0xb753a017, 0x3)\r\n\t/root/go/src/runtime/proc.go:262 +0x130 fp=0x18547d70 sp=0x18547d5c\r\nruntime.goparkunlock(0x1854a3f0, 0x8231b0a, 0xc, 0x831d417, 0x3)\r\n\t/root/go/src/runtime/proc.go:268 +0x4b fp=0x18547d8c sp=0x18547d70\r\nruntime.chanrecv(0x81d1560, 0x1854a3c0, 0x18547e80, 0x18547d01, 0x80a0000)\r\n\t/root/go/src/runtime/chan.go:474 +0x3d4 fp=0x18547dd4 sp=0x18547d8c\r\nruntime.chanrecv1(0x81d1560, 0x1854a3c0, 0x18547e80)\r\n\t/root/go/src/runtime/chan.go:357 +0x24 fp=0x18547dec sp=0x18547dd4\r\ntesting.RunTests(0x826da08, 0x831b280, 0xb4, 0xb4, 0x80f5501)\r\n\t/root/go/src/testing/testing.go:582 +0x724 fp=0x18547eac sp=0x18547dec\r\ntesting.(*M).Run(0x18547f7c, 0x82c07dc)\r\n\t/root/go/src/testing/testing.go:515 +0x79 fp=0x18547ef0 sp=0x18547eac\r\nruntime_test.TestMain(0x18547f7c)\r\n\t/root/go/src/runtime/crash_test.go:24 +0x25 fp=0x18547f30 sp=0x18547ef0\r\nmain.main()\r\n\truntime/_test/_testmain.go:960 +0x100 fp=0x18547fa8 sp=0x18547f30\r\nruntime.main()\r\n\t/root/go/src/runtime/proc.go:188 +0x276 fp=0x18547fd0 sp=0x18547fa8\r\nruntime.goexit()\r\n\t/root/go/src/runtime/asm_386.s:1591 +0x1 fp=0x18547fd4 sp=0x18547fd0\r\n\r\ngoroutine 17 [syscall, locked to thread]:\r\nruntime.goexit()\r\n\t/root/go/src/runtime/asm_386.s:1591 +0x1 fp=0x18536fdc sp=0x18536fd8\r\n\r\ngoroutine 2 [force gc (idle)]:\r\nruntime.gopark(0x826dd0c, 0x831cc90, 0x8234422, 0xf, 0x13bdf14, 0x1)\r\n\t/root/go/src/runtime/proc.go:262 +0x130 fp=0x185227ac sp=0x18522798\r\nruntime.goparkunlock(0x831cc90, 0x8234422, 0xf, 0x18500014, 0x1)\r\n\t/root/go/src/runtime/proc.go:268 +0x4b fp=0x185227c8 sp=0x185227ac\r\nruntime.forcegchelper()\r\n\t/root/go/src/runtime/proc.go:229 +0xaa fp=0x185227e0 sp=0x185227c8\r\nruntime.goexit()\r\n\t/root/go/src/runtime/asm_386.s:1591 +0x1 fp=0x185227e4 sp=0x185227e0\r\ncreated by runtime.init.4\r\n\t/root/go/src/runtime/proc.go:218 +0x2a\r\n\r\ngoroutine 3 [GC sweep wait]:\r\nruntime.gopark(0x826dd0c, 0x831cde0, 0x82325a6, 0xd, 0x8064814, 0x1)\r\n\t/root/go/src/runtime/proc.go:262 +0x130 fp=0x18522fa0 sp=0x18522f8c\r\nruntime.goparkunlock(0x831cde0, 0x82325a6, 0xd, 0x14, 0x1)\r\n\t/root/go/src/runtime/proc.go:268 +0x4b fp=0x18522fbc sp=0x18522fa0\r\nruntime.bgsweep(0x1854a000)\r\n\t/root/go/src/runtime/mgcsweep.go:63 +0xa0 fp=0x18522fd8 sp=0x18522fbc\r\nruntime.goexit()\r\n\t/root/go/src/runtime/asm_386.s:1591 +0x1 fp=0x18522fdc sp=0x18522fd8\r\ncreated by runtime.gcenable\r\n\t/root/go/src/runtime/mgc.go:191 +0x52\r\n\r\ngoroutine 4 [finalizer wait]:\r\nruntime.gopark(0x826dd0c, 0x832d6cc, 0x8233616, 0xe, 0x14, 0x1)\r\n\t/root/go/src/runtime/proc.go:262 +0x130 fp=0x1852378c sp=0x18523778\r\nruntime.goparkunlock(0x832d6cc, 0x8233616, 0xe, 0x14, 0x1)\r\n\t/root/go/src/runtime/proc.go:268 +0x4b fp=0x185237a8 sp=0x1852378c\r\nruntime.runfinq()\r\n\t/root/go/src/runtime/mfinal.go:158 +0x9e fp=0x185237e0 sp=0x185237a8\r\nruntime.goexit()\r\n\t/root/go/src/runtime/asm_386.s:1591 +0x1 fp=0x185237e4 sp=0x185237e0\r\ncreated by runtime.createfing\r\n\t/root/go/src/runtime/mfinal.go:139 +0x5c\r\n\r\ngoroutine 5 [syscall]:\r\nsyscall.Syscall6(0x72, 0xfc4, 0x18537d98, 0x0, 0x1856a2d0, 0x0, 0x0, 0x18537d88, 0x8095d60, 0x18537d84)\r\n\t/root/go/src/syscall/asm_linux_386.s:45 +0x5 fp=0x18537d48 sp=0x18537d44\r\nsyscall.wait4(0xfc4, 0x18537d98, 0x0, 0x1856a2d0, 0x50, 0x0, 0x0)\r\n\t/root/go/src/syscall/zsyscall_linux_386.go:172 +0x71 fp=0x18537d7c sp=0x18537d48\r\nsyscall.Wait4(0xfc4, 0x18537dbc, 0x0, 0x1856a2d0, 0x185263c0, 0x0, 0x0)\r\n\t/root/go/src/syscall/syscall_linux.go:256 +0x4d fp=0x18537da0 sp=0x18537d7c\r\nos.(*Process).wait(0x1850ab10, 0x1e, 0x0, 0x0)\r\n\t/root/go/src/os/exec_unix.go:22 +0xbe fp=0x18537df8 sp=0x18537da0\r\nos.(*Process).Wait(0x1850ab10, 0x0, 0x0, 0x0)\r\n\t/root/go/src/os/doc.go:49 +0x2b fp=0x18537e0c sp=0x18537df8\r\nos/exec.(*Cmd).Wait(0x1850e5a0, 0x0, 0x0)\r\n\t/root/go/src/os/exec/exec.go:396 +0x186 fp=0x18537e74 sp=0x18537e0c\r\nos/exec.(*Cmd).Run(0x1850e5a0, 0x0, 0x0)\r\n\t/root/go/src/os/exec/exec.go:262 +0x58 fp=0x18537e8c sp=0x18537e74\r\nos/exec.(*Cmd).CombinedOutput(0x1850e5a0, 0x0, 0x0, 0x0, 0x0, 0x0)\r\n\t/root/go/src/os/exec/exec.go:453 +0x23f fp=0x18537edc sp=0x18537e8c\r\nruntime_test.runTestProg(0x185721e0, 0x8231136, 0xb, 0x82340da, 0xf, 0x0, 0x0)\r\n\t/root/go/src/runtime/crash_test.go:68 +0x194 fp=0x18537f48 sp=0x18537edc\r\nruntime_test.TestCgoCCodeSIGPROF(0x185721e0)\r\n\t/root/go/src/runtime/crash_cgo_test.go:206 +0x47 fp=0x18537fac sp=0x18537f48\r\ntesting.tRunner(0x185721e0, 0x831b3dc)\r\n\t/root/go/src/testing/testing.go:473 +0x8f fp=0x18537fd0 sp=0x18537fac\r\nruntime.goexit()\r\n\t/root/go/src/runtime/asm_386.s:1591 +0x1 fp=0x18537fd4 sp=0x18537fd0\r\ncreated by testing.RunTests\r\n\t/root/go/src/testing/testing.go:581 +0x6f2\r\n\r\ngoroutine 8 [syscall]:\r\nsyscall.Syscall(0x3, 0x4, 0x18592400, 0x200, 0x18592400, 0x200, 0x0)\r\n\t/root/go/src/syscall/asm_linux_386.s:20 +0x5 fp=0x18523e04 sp=0x18523e00\r\nsyscall.read(0x4, 0x18592400, 0x200, 0x200, 0x826d9dc, 0x0, 0x0)\r\n\t/root/go/src/syscall/zsyscall_linux_386.go:783 +0x4f fp=0x18523e24 sp=0x18523e04\r\nsyscall.Read(0x4, 0x18592400, 0x200, 0x200, 0x0, 0x0, 0x0)\r\n\t/root/go/src/syscall/syscall_unix.go:161 +0x45 fp=0x18523e44 sp=0x18523e24\r\nos.(*File).read(0x185263b8, 0x18592400, 0x200, 0x200, 0x18592400, 0x0, 0x0)\r\n\t/root/go/src/os/file_unix.go:228 +0x4a fp=0x18523e64 sp=0x18523e44\r\nos.(*File).Read(0x185263b8, 0x18592400, 0x200, 0x200, 0x344, 0x0, 0x0)\r\n\t/root/go/src/os/file.go:95 +0x6f fp=0x18523e90 sp=0x18523e64\r\nbytes.(*Buffer).ReadFrom(0x18572300, 0xb6ced310, 0x185263b8, 0x0, 0x0, 0x0, 0x0)\r\n\t/root/go/src/bytes/buffer.go:176 +0x1c5 fp=0x18523ee8 sp=0x18523e90\r\nio.copyBuffer(0xb6ced440, 0x18572300, 0xb6ced310, 0x185263b8, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\r\n\t/root/go/src/io/io.go:374 +0x129 fp=0x18523f4c sp=0x18523ee8\r\nio.Copy(0xb6ced440, 0x18572300, 0xb6ced310, 0x185263b8, 0x0, 0x0, 0x0, 0x0)\r\n\t/root/go/src/io/io.go:350 +0x53 fp=0x18523f7c sp=0x18523f4c\r\nos/exec.(*Cmd).writerDescriptor.func1(0x0, 0x0)\r\n\t/root/go/src/os/exec/exec.go:236 +0x72 fp=0x18523fc0 sp=0x18523f7c\r\nos/exec.(*Cmd).Start.func1(0x1850e5a0, 0x1850a9e0)\r\n\t/root/go/src/os/exec/exec.go:344 +0x1d fp=0x18523fd8 sp=0x18523fc0\r\nruntime.goexit()\r\n\t/root/go/src/runtime/asm_386.s:1591 +0x1 fp=0x18523fdc sp=0x18523fd8\r\ncreated by os/exec.(*Cmd).Start\r\n\t/root/go/src/os/exec/exec.go:345 +0x787\r\n\r\neax    0xf0\r\nebx    0x831d4e4\r\necx    0x0\r\nedx    0x0\r\nedi    0x0\r\nesi    0x0\r\nebp    0x0\r\nesp    0xbfcca628\r\neip    0x809c88d\r\neflags 0x286\r\ncs     0x73\r\nfs     0x0\r\ngs     0x33\r\nFAIL\truntime\t15.667s\r\n```\r\n\r\nAlex",
	"user": {
		"login": "alexbrainman",
		"id": 9796621,
		"type": "User",
		"site_admin": false
	},
	"assignee": {
		"login": "ianlancetaylor",
		"id": 3194333,
		"type": "User",
		"site_admin": false
	},
	"comments": 6,
	"closed_at": "2016-03-11T06:43:19Z",
	"created_at": "2016-03-11T03:40:04Z",
	"updated_at": "2016-03-11T06:43:19Z",
	"milestone": {
		"id": 1414133,
		"number": 31,
		"title": "Go1.7"
	}
}
