{
	"id": 150514144,
	"number": 15416,
	"state": "open",
	"title": "cmd/compile: panic on linux/mips64le during build with Go 1.6.2 in QEMU",
	"body": "Please answer these questions before submitting your issue. Thanks!\r\n\r\n1. What version of Go are you using (`go version`)?\r\ngo version go1.6.2 linux/mips64le\r\n\r\n2. What operating system and processor architecture are you using (`go env`)?\r\nGOARCH=\"mips64le\"\r\nGOBIN=\"\"\r\nGOEXE=\"\"\r\nGOHOSTARCH=\"mips64le\"\r\nGOHOSTOS=\"linux\"\r\nGOOS=\"linux\"\r\nGOPATH=\"\"\r\nGORACE=\"\"\r\nGOROOT=\"/usr/lib/golang\"\r\nGOTOOLDIR=\"/usr/lib/golang/pkg/tool/linux_mips64le\"\r\nGO15VENDOREXPERIMENT=\"1\"\r\nCC=\"gcc\"\r\nGOGCCFLAGS=\"-fPIC -fmessage-length=0\"\r\nCXX=\"g++\"\r\nCGO_ENABLED=\"0\"\r\n\r\n3. What did you do?\r\nJust compile golang on fedora 23 mips64el, which is based on QEMU melta 5KEc.\r\n\r\n4. What did you expect to see?\r\nCompile success.\r\n\r\n5. What did you see instead?\r\n# rpmbuild --define \"golang_arches mips64el\" -bb golang-1.6.2.spec\r\nExecuting(%prep): /bin/sh -e /var/tmp/rpm-tmp.s5c1s4\r\n+ umask 022\r\n+ cd /root/rpmbuild/BUILD\r\n+ cd /root/rpmbuild/BUILD\r\n+ rm -rf go\r\n+ /usr/bin/gzip -dc /root/rpmbuild/SOURCES/go1.6.2.tar.gz\r\n+ /usr/bin/tar -xof -\r\n+ STATUS=0\r\n+ '[' 0 -ne 0 ']'\r\n+ cd go\r\n+ /usr/bin/chmod -Rf a+rX,u+w,g-w,o-w .\r\n+ exit 0\r\nExecuting(%build): /bin/sh -e /var/tmp/rpm-tmp.LjhtJ8\r\n+ umask 022\r\n+ cd /root/rpmbuild/BUILD\r\n+ cd go\r\n+ uname -a\r\nLinux fedora-mips64el 4.4.0-0.rc4.git0.1.mips.fc23.mips64el #1 Fri Dec 18 08:53:44 GMT 2015 mips64 mips64 mips64 GNU/Linux\r\n+ cat /proc/cpuinfo\r\nsystem type             : MIPS Malta\r\nmachine                 : mti,malta\r\nprocessor               : 0\r\ncpu model               : MIPS 5KE V0.0\r\nBogoMIPS                : 2801.66\r\nwait instruction        : yes\r\nmicrosecond timers      : yes\r\ntlb_entries             : 32\r\nextra interrupt vector  : yes\r\nhardware watchpoint     : yes, count: 1, address/irw mask: [0x0ff8]\r\nisa                     : mips1 mips2 mips3 mips4 mips5 mips32r1 mips32r2 mips64r1 mips64r2\r\nASEs implemented        :\r\nshadow register sets    : 1\r\nkscratch registers      : 0\r\npackage                 : 0\r\ncore                    : 0\r\nVCED exceptions         : not available\r\nVCEI exceptions         : not available\r\n\r\n+ cat /proc/meminfo\r\nMemTotal:        2015436 kB\r\nMemFree:          380420 kB\r\nMemAvailable:    1864000 kB\r\nBuffers:           91896 kB\r\nCached:          1305964 kB\r\nSwapCached:            0 kB\r\nActive:           682032 kB\r\nInactive:         781152 kB\r\nActive(anon):      65596 kB\r\nInactive(anon):      136 kB\r\nActive(file):     616436 kB\r\nInactive(file):   781016 kB\r\nUnevictable:           0 kB\r\nMlocked:               0 kB\r\nSwapTotal:             0 kB\r\nSwapFree:              0 kB\r\nDirty:             63112 kB\r\nWriteback:             0 kB\r\nAnonPages:         65336 kB\r\nMapped:            49764 kB\r\nShmem:               412 kB\r\nSlab:             160164 kB\r\nSReclaimable:     107032 kB\r\nSUnreclaim:        53132 kB\r\nKernelStack:        1248 kB\r\nPageTables:         1284 kB\r\nNFS_Unstable:          0 kB\r\nBounce:                0 kB\r\nWritebackTmp:          0 kB\r\nCommitLimit:     1007716 kB\r\nCommitted_AS:     213152 kB\r\nVmallocTotal:   1069547512 kB\r\nVmallocUsed:           0 kB\r\nVmallocChunk:          0 kB\r\nAnonHugePages:     18432 kB\r\nHugePages_Total:       0\r\nHugePages_Free:        0\r\nHugePages_Rsvd:        0\r\nHugePages_Surp:        0\r\nHugepagesize:       2048 kB\r\n+ export GOROOT_BOOTSTRAP=/usr/lib/golang\r\n+ GOROOT_BOOTSTRAP=/usr/lib/golang\r\n+ export GOROOT_FINAL=/usr/lib/golang\r\n+ GOROOT_FINAL=/usr/lib/golang\r\n+ export GOHOSTOS=linux\r\n+ GOHOSTOS=linux\r\n+ export GOHOSTARCH=mips64le\r\n+ GOHOSTARCH=mips64le\r\n+ pushd src\r\n~/rpmbuild/BUILD/go/src ~/rpmbuild/BUILD/go\r\n+ export 'CFLAGS=-O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -march=mips64r2 -mabi=64'\r\n+ CFLAGS='-O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -march=mips64r2 -mabi=64'\r\n+ export 'LDFLAGS=-Wl,-z,relro -specs=/usr/lib/rpm/redhat/redhat-hardened-ld'\r\n+ LDFLAGS='-Wl,-z,relro -specs=/usr/lib/rpm/redhat/redhat-hardened-ld'\r\n+ export CC=gcc\r\n+ CC=gcc\r\n+ export CC_FOR_TARGET=gcc\r\n+ CC_FOR_TARGET=gcc\r\n+ export GOOS=linux\r\n+ GOOS=linux\r\n+ export GOARCH=mips64le\r\n+ GOARCH=mips64le\r\n+ export 'GO_LDFLAGS=-linkmode internal'\r\n+ GO_LDFLAGS='-linkmode internal'\r\n+ export CGO_ENABLED=0\r\n+ CGO_ENABLED=0\r\n+ ./make.bash --no-clean\r\n##### Building Go bootstrap tool.\r\ncmd/dist\r\n\r\n##### Building Go toolchain using /usr/lib/golang.\r\nbootstrap/internal/obj\r\nbootstrap/internal/obj/arm\r\nbootstrap/internal/obj/arm64\r\nbootstrap/internal/obj/mips\r\nbootstrap/internal/obj/ppc64\r\nbootstrap/internal/obj/x86\r\nbootstrap/asm/internal/arch\r\nbootstrap/asm/internal/flags\r\nbootstrap/asm/internal/lex\r\nbootstrap/asm/internal/asm\r\nbootstrap/asm\r\nbootstrap/compile/internal/big\r\nbootstrap/internal/gcprog\r\nbootstrap/compile/internal/gc\r\nbootstrap/compile/internal/amd64\r\nbootstrap/compile/internal/arm\r\nbootstrap/compile/internal/arm64\r\nbootstrap/compile/internal/mips64\r\nbootstrap/compile/internal/ppc64\r\nbootstrap/compile/internal/x86\r\nbootstrap/compile\r\nbootstrap/link/internal/ld\r\nbootstrap/link/internal/amd64\r\nbootstrap/link/internal/arm\r\nbootstrap/link/internal/arm64\r\nbootstrap/link/internal/mips64\r\nbootstrap/link/internal/ppc64\r\nbootstrap/link/internal/x86\r\nbootstrap/link\r\n\r\n##### Building go_bootstrap for host, linux/mips64le.\r\nruntime/internal/sys\r\nruntime/internal/atomic\r\nruntime\r\nencoding\r\nerrors\r\ninternal/race\r\ninternal/syscall/windows/sysdll\r\nmath\r\nsort\r\nsync/atomic\r\nunicode\r\nunicode/utf16\r\nunicode/utf8\r\nsync\r\ncontainer/heap\r\ninternal/singleflight\r\nio\r\nsyscall\r\nhash\r\nhash/adler32\r\nstrings\r\nbytes\r\nstrconv\r\nbufio\r\npath\r\nregexp/syntax\r\nreflect\r\nencoding/base64\r\ncrypto\r\ncrypto/sha1\r\ninternal/syscall/windows/registry\r\ninternal/syscall/windows\r\ntime\r\nregexp\r\nos\r\nencoding/binary\r\npath/filepath\r\nfmt\r\nos/signal\r\n  /ioutil\r\nos/exec\r\ndebug/dwarf\r\ngo/token\r\nflag\r\nlog\r\ntext/template/parse\r\nnet/url\r\ncompress/flate\r\nencoding/json\r\ngo/scanner\r\ngo/ast\r\ncompress/zlib\r\ntext/template\r\ndebug/elf\r\ndebug/macho\r\ngo/parser\r\ngo/doc\r\ngo/build\r\ncmd/go\r\n\r\n##### Building packages and commands for linux/mips64le.\r\npanic: regexp: Compile(`((https?|ftp|file|gopher|mailto|news|nntp|telnet|wais|prospero)://[a-zA-Z0-9_@\\-]+([.:][a-zA-Z0-9_@\\-]+)*/?[a-zA-Z0-9_?%#~\u0026/\\-+=()]+([:.,][a-zA-Z0-9_?%#~\u0026/\\-+=()]+)*)|([\\pL_][\\pL_0-9]*)`): error parsing regexp: invalid escape sequence: `\\-`\r\n\r\ngoroutine 1 [running]:\r\npanic(0x3434c0, 0xc82000e5a0)\r\n        /usr/lib/golang/src/runtime/panic.go:481 +0x4b8\r\nregexp.MustCompile(0x4bb7e0, 0xb9, 0x4655e0)\r\n        /usr/lib/golang/src/regexp/regexp.go:232 +0x17c\r\ngo/doc.init()\r\n        /usr/lib/golang/src/go/doc/comment.go:59 +0x108\r\ngo/build.init()\r\n        /usr/lib/golang/src/go/build/syslist.go:8 +0xc4\r\nmain.init()\r\n        /usr/lib/golang/src/cmd/go/zdefaultcc.go:6 +0xdc\r\nerror: Bad exit status from /var/tmp/rpm-tmp.LjhtJ8 (%build)\r\n\r\n\r\nRPM build errors:\r\n    Bad exit status from /var/tmp/rpm-tmp.LjhtJ8 (%build)\r\n\r\n\r\n",
	"user": {
		"login": "vanloswang",
		"id": 1133578,
		"type": "User",
		"site_admin": false
	},
	"comments": 6,
	"created_at": "2016-04-23T03:32:08Z",
	"updated_at": "2016-05-17T14:01:48Z",
	"milestone": {
		"id": 1709363,
		"number": 38,
		"title": "Go1.8"
	}
}
