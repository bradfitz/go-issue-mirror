{
	"id": 191571630,
	"body": "Thanks @aclements, your changes result in a big improvement in mark termination time for my application, bringing it down to around 20ms with ~120k goroutines and ~500MB live heap (compared with 50ms at 90k goroutines and 330MB heap on go1.6). Some of the extra pause time may be attributable to #14419 or to #14406, which I did not mitigate while testing this change.\r\n\r\nI've been testing with CL 20044 PS 2.\r\n\r\ngo1.6 with framepointer, ~90k goroutines:\r\n```\r\ngc 463 @23853.946s 0%: 14+69+49 ms clock, 478+716/606/779+1583 ms cpu, 652-\u003e653-\u003e334 MB, 669 MB goal, 36 P\r\ngc 464 @23920.847s 0%: 5.9+66+48 ms clock, 190+716/573/826+1546 ms cpu, 653-\u003e653-\u003e334 MB, 669 MB goal, 36 P\r\ngc 465 @23991.665s 0%: 5.5+68+48 ms clock, 177+646/575/780+1567 ms cpu, 651-\u003e652-\u003e334 MB, 668 MB goal, 36 P\r\ngc 466 @24060.214s 0%: 6.8+75+50 ms clock, 185+939/657/439+1350 ms cpu, 651-\u003e651-\u003e333 MB, 668 MB goal, 36 P\r\ngc 467 @24132.336s 0%: 5.7+64+53 ms clock, 185+796/559/650+1721 ms cpu, 650-\u003e651-\u003e333 MB, 667 MB goal, 36 P\r\ngc 468 @24204.829s 0%: 6.4+80+61 ms clock, 205+778/665/805+1972 ms cpu, 650-\u003e650-\u003e333 MB, 666 MB goal, 36 P\r\ngc 469 @24280.941s 0%: 5.1+69+56 ms clock, 165+645/578/808+1804 ms cpu, 650-\u003e652-\u003e332 MB, 667 MB goal, 36 P\r\ngc 470 @24347.731s 0%: 5.3+80+53 ms clock, 172+754/689/611+1718 ms cpu, 647-\u003e649-\u003e332 MB, 664 MB goal, 36 P\r\ngc 471 @24423.086s 0%: 10+74+48 ms clock, 326+595/635/875+1567 ms cpu, 647-\u003e649-\u003e331 MB, 663 MB goal, 36 P\r\ngc 472 @24493.659s 0%: 5.5+69+50 ms clock, 176+1110/611/452+1616 ms cpu, 644-\u003e644-\u003e330 MB, 660 MB goal, 36 P\r\n```\r\n\r\nCL 20044 PS 2, devel +f9e73e9 Mon Feb 29 11:13:35 2016 -0500 with framepointer, ~120k goroutines:\r\n```\r\ngc 659 @42602.290s 0%: 4.6+108+21 ms clock, 74+1353/956/1017+345 ms cpu, 945-\u003e945-\u003e485 MB, 969 MB goal, 36 P\r\ngc 660 @42655.022s 0%: 5.7+115+22 ms clock, 182+1215/1004/1070+709 ms cpu, 946-\u003e946-\u003e487 MB, 970 MB goal, 36 P\r\ngc 661 @42701.260s 0%: 5.1+111+22 ms clock, 165+1230/967/1143+718 ms cpu, 951-\u003e952-\u003e488 MB, 975 MB goal, 36 P\r\ngc 662 @42748.210s 0%: 5.0+106+19 ms clock, 100+1417/929/914+391 ms cpu, 953-\u003e953-\u003e489 MB, 977 MB goal, 36 P\r\ngc 663 @42801.338s 0%: 8.2+98+17 ms clock, 265+1200/867/1211+569 ms cpu, 954-\u003e956-\u003e490 MB, 978 MB goal, 36 P\r\ngc 664 @42847.753s 0%: 4.0+123+24 ms clock, 130+1347/948/984+796 ms cpu, 954-\u003e956-\u003e490 MB, 978 MB goal, 36 P\r\ngc 665 @42891.652s 0%: 5.7+93+18 ms clock, 184+1097/821/1143+582 ms cpu, 957-\u003e957-\u003e490 MB, 981 MB goal, 36 P\r\ngc 666 @42947.239s 0%: 8.0+109+18 ms clock, 258+1210/941/1224+577 ms cpu, 957-\u003e960-\u003e492 MB, 981 MB goal, 36 P\r\ngc 667 @42993.313s 0%: 11+105+20 ms clock, 368+1298/908/1167+644 ms cpu, 958-\u003e959-\u003e492 MB, 982 MB goal, 36 P\r\ngc 668 @43047.532s 0%: 10+102+19 ms clock, 325+1245/896/1163+636 ms cpu, 960-\u003e962-\u003e493 MB, 984 MB goal, 36 P\r\n```\r\n",
	"user": {
		"login": "rhysh",
		"id": 230685,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-03-03T04:03:24Z",
	"updated_at": "2016-03-03T04:03:24Z"
}
