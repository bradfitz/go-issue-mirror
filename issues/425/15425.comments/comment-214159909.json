{
	"id": 214159909,
	"body": "In Go 1.6, I tested your client and server code and it works, but doesn't exhibit the same behavior the Chrome \u0026 Firefox seem to have.\r\n\r\n```\r\nAirNemo-2:Desktop nimi$ GODEBUG=http2debug=1 go run server.go \r\n2016/04/24 23:25:06 http2: server connection from 127.0.0.1:58511 on 0xc820016100\r\n2016/04/24 23:25:06 http2: server: client 127.0.0.1:58511 said hello\r\n2016/04/24 23:25:06 http2: server read frame SETTINGS len=18, settings: ENABLE_PUSH=0, INITIAL_WINDOW_SIZE=4194304, MAX_HEADER_LIST_SIZE=10485760\r\n2016/04/24 23:25:06 http2: server processing setting [ENABLE_PUSH = 0]\r\n2016/04/24 23:25:06 http2: server processing setting [INITIAL_WINDOW_SIZE = 4194304]\r\n2016/04/24 23:25:06 http2: server processing setting [MAX_HEADER_LIST_SIZE = 10485760]\r\n2016/04/24 23:25:06 http2: server read frame WINDOW_UPDATE len=4 (conn) incr=1073741824\r\n2016/04/24 23:25:06 http2: server read frame SETTINGS flags=ACK len=0\r\n2016/04/24 23:25:06 http2: server read frame HEADERS flags=END_HEADERS stream=1 len=56\r\n2016/04/24 23:25:06 http2: server decoded header field \":authority\" = \"localhost.channelmeter.com:1333\"\r\n2016/04/24 23:25:06 http2: server decoded header field \":method\" = \"POST\"\r\n2016/04/24 23:25:06 http2: server decoded header field \":path\" = \"/\"\r\n2016/04/24 23:25:06 http2: server decoded header field \":scheme\" = \"https\"\r\n2016/04/24 23:25:06 http2: server decoded header field \"content-length\" = \"1073741824\"\r\n2016/04/24 23:25:06 http2: server decoded header field \"accept-encoding\" = \"gzip\"\r\n2016/04/24 23:25:06 http2: server decoded header field \"user-agent\" = \"Go-http-client/2.0\"\r\n2016/04/24 23:25:06 http2: server read frame DATA stream=1 len=65535 data=\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" (65279 bytes omitted)\r\n2016/04/24 23:25:06 Received HTTP/2.0 post request whose Headers are map[Content-Length:[1073741824] Accept-Encoding:[gzip] User-Agent:[Go-http-client/2.0]]\r\n2016/04/24 23:25:06 req.Body.Close() here, err=\u003cnil\u003e\r\n2016/04/24 23:25:06 http2: server encoding header \":status\" = \"413\"\r\n2016/04/24 23:25:06 http2: server encoding header \"content-type\" = \"text/plain; charset=utf-8\"\r\n2016/04/24 23:25:06 http2: server encoding header \"date\" = \"Mon, 25 Apr 2016 06:25:06 GMT\"\r\n2016/04/24 23:25:06 Wrote 25152 bytes. Error: \u003cnil\u003e\r\n2016/04/24 23:25:06 http2: server read frame WINDOW_UPDATE stream=1 len=4 incr=24576\r\n```\r\n\r\n```\r\nAirNemo-2:Desktop nimi$ go run ./client.go \r\n2016/04/24 23:25:06 len(data)=1073741824\r\n2016/04/24 23:25:06 client.Do next\r\n2016/04/24 23:25:06 client.Do done\r\n2016/04/24 23:25:06 done Reading the server response's body n=(25152) err=\u003cnil\u003e\r\nres.headers: map[Content-Type:[text/plain; charset=utf-8] Date:[Mon, 25 Apr 2016 06:25:06 GMT]]\r\n```\r\n\r\nHowever, Chrome 49.0.2623.112 still exhibits the erroneous behavior when Chrome makes the post request (via JS). Here is the output of server.go, from a Chrome client (go 1.6):\r\n\r\n```\r\nAirNemo-2:Desktop nimi$ GODEBUG=http2debug=1 go run server.go \r\n2016/04/24 23:28:49 http2: server connection from 127.0.0.1:58657 on 0xc820016100\r\n2016/04/24 23:28:49 http2: server: client 127.0.0.1:58657 said hello\r\n2016/04/24 23:28:49 http2: server read frame SETTINGS len=12, settings: MAX_CONCURRENT_STREAMS=1000, INITIAL_WINDOW_SIZE=6291456\r\n2016/04/24 23:28:49 http2: server processing setting [MAX_CONCURRENT_STREAMS = 1000]\r\n2016/04/24 23:28:49 http2: server processing setting [INITIAL_WINDOW_SIZE = 6291456]\r\n2016/04/24 23:28:49 http2: server read frame WINDOW_UPDATE len=4 (conn) incr=15663105\r\n2016/04/24 23:28:49 http2: server read frame SETTINGS flags=ACK len=0\r\n2016/04/24 23:28:49 http2: server read frame HEADERS flags=END_STREAM|END_HEADERS|PRIORITY stream=1 len=537\r\n2016/04/24 23:28:49 http2: server decoded header field \":method\" = \"GET\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":authority\" = \"localhost.channelmeter.com:1333\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":scheme\" = \"https\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":path\" = \"/\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cache-control\" = \"max-age=0\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept\" = \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"upgrade-insecure-requests\" = \"1\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"user-agent\" = \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept-encoding\" = \"gzip, deflate, sdch\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept-language\" = \"en-US,en;q=0.8\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"rxx=9buf2utu0r8.znr7b5\u0026v=1\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"_ga=GA1.2.1575566159.1439230335\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__cfduid=dc0421da8b1019e0b4589a6fa93642d341454224609\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utma=95374414.1575566159.1439230335.1461360906.1461366552.994\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utmc=95374414\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utmz=95374414.1460603659.954.25.utmcsr=channelmeter.atlassian.net|utmccn=(referral)|utmcmd=referral|utmcct=/browse/CMCOM-458\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"_hp2_id.3440866521=6666510306088045.3504969456630825.0651466615070784\"\r\n2016/04/24 23:28:49 http2: server encoding header \":status\" = \"200\"\r\n2016/04/24 23:28:49 http2: server encoding header \"content-type\" = \"text/html\"\r\n2016/04/24 23:28:49 http2: server encoding header \"content-length\" = \"952\"\r\n2016/04/24 23:28:49 http2: server encoding header \"date\" = \"Mon, 25 Apr 2016 06:28:49 GMT\"\r\n2016/04/24 23:28:49 http2: server read frame HEADERS flags=END_HEADERS|PRIORITY stream=3 len=150\r\n2016/04/24 23:28:49 http2: server decoded header field \":method\" = \"POST\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":authority\" = \"localhost.channelmeter.com:1333\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":scheme\" = \"https\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":path\" = \"/\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"content-length\" = \"5243075\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"origin\" = \"https://localhost.channelmeter.com:1333\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"user-agent\" = \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"content-type\" = \"multipart/form-data; boundary=----WebKitFormBoundarympkz8giGks318oJr\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept\" = \"*/*\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"referer\" = \"https://localhost.channelmeter.com:1333/\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept-encoding\" = \"gzip, deflate\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept-language\" = \"en-US,en;q=0.8\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"rxx=9buf2utu0r8.znr7b5\u0026v=1\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"_ga=GA1.2.1575566159.1439230335\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__cfduid=dc0421da8b1019e0b4589a6fa93642d341454224609\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utma=95374414.1575566159.1439230335.1461360906.1461366552.994\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utmc=95374414\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utmz=95374414.1460603659.954.25.utmcsr=channelmeter.atlassian.net|utmccn=(referral)|utmcmd=referral|utmcct=/browse/CMCOM-458\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"_hp2_id.3440866521=6666510306088045.3504969456630825.0651466615070784\"\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"------WebKitFormBoundarympkz8giGks318oJr\\r\\nContent-Disposition: form-data; name=\\\"file\\\"; filename=\\\"test.jpg\\\"\\r\\nContent-Type: application/octet-stream\\r\\n\\r\\n0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 Received HTTP/2.0 post request whose Headers are map[Referer:[https://localhost.channelmeter.com:1333/] Accept-Encoding:[gzip, deflate] Cookie:[rxx=9buf2utu0r8.znr7b5\u0026v=1; _ga=GA1.2.1575566159.1439230335; __cfduid=dc0421da8b1019e0b4589a6fa93642d341454224609; __utma=95374414.1575566159.1439230335.1461360906.1461366552.994; __utmc=95374414; __utmz=95374414.1460603659.954.25.utmcsr=channelmeter.atlassian.net|utmccn=(referral)|utmcmd=referral|utmcct=/browse/CMCOM-458; _hp2_id.3440866521=6666510306088045.3504969456630825.0651466615070784] Origin:[https://localhost.channelmeter.com:1333] User-Agent:[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36] Accept:[*/*] Content-Length:[5243075] Content-Type:[multipart/form-data; boundary=----WebKitFormBoundarympkz8giGks318oJr] Accept-Language:[en-US,en;q=0.8]]\r\n2016/04/24 23:28:49 req.Body.Close() here, err=\u003cnil\u003e\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 Wrote 4096 bytes. Error: http2: stream closed\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2852 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2596 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame DATA stream=3 len=2791 data=\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\" (2535 bytes omitted)\r\n2016/04/24 23:28:49 http2: server read frame HEADERS flags=END_STREAM|END_HEADERS|PRIORITY stream=5 len=36\r\n2016/04/24 23:28:49 http2: server decoded header field \":method\" = \"GET\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":authority\" = \"localhost.channelmeter.com:1333\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":scheme\" = \"https\"\r\n2016/04/24 23:28:49 http2: server decoded header field \":path\" = \"/favicon.ico\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"user-agent\" = \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept\" = \"*/*\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"referer\" = \"https://localhost.channelmeter.com:1333/\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept-encoding\" = \"gzip, deflate, sdch\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"accept-language\" = \"en-US,en;q=0.8\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"rxx=9buf2utu0r8.znr7b5\u0026v=1\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"_ga=GA1.2.1575566159.1439230335\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__cfduid=dc0421da8b1019e0b4589a6fa93642d341454224609\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utma=95374414.1575566159.1439230335.1461360906.1461366552.994\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utmc=95374414\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"__utmz=95374414.1460603659.954.25.utmcsr=channelmeter.atlassian.net|utmccn=(referral)|utmcmd=referral|utmcct=/browse/CMCOM-458\"\r\n2016/04/24 23:28:49 http2: server decoded header field \"cookie\" = \"_hp2_id.3440866521=6666510306088045.3504969456630825.0651466615070784\"\r\n2016/04/24 23:28:49 http2: server encoding header \":status\" = \"200\"\r\n2016/04/24 23:28:49 http2: server encoding header \"content-type\" = \"text/html\"\r\n2016/04/24 23:28:49 http2: server encoding header \"content-length\" = \"952\"\r\n2016/04/24 23:28:49 http2: server encoding header \"date\" = \"Mon, 25 Apr 2016 06:28:49 GMT\"\r\n\r\n\r\n```\r\n\r\nDoes the request succeed with Chrome, when the script is compiled with go tip? I can try building tip and testing the code again.",
	"user": {
		"login": "nemothekid",
		"id": 940094,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-04-25T06:28:23Z",
	"updated_at": "2016-04-25T06:29:16Z"
}
