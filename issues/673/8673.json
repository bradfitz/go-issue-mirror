{
	"id": 51288531,
	"number": 8673,
	"state": "closed",
	"title": "bootstrap: go_bootstrap raises \"invalid opcode\" error on Plan 9",
	"body": "by **lufia@me.com**:\n\n\u003cpre\u003eWhat steps reproduce the problem?\nIf possible, include a link to a program on play.golang.org.\n\n1. hget \u003ca href=\"https://storage.googleapis.com/golang/go1.3.1.src.tar.gz\"\u003ehttps://storage.googleapis.com/golang/go1.3.1.src.tar.gz\u003c/a\u003e | gunzip | tar x\n2. cd go/src\n3. GO386=387\n4. ./all.rc\n\nWhat happened?\n\n# Building C bootstrap tool.\ncmd/dist\n\n# Building compilers and Go bootstrap tool for host, plan9/386.\nlib9\nlibbio\nliblink\nmisc/pprof\ncmd/cc\nwarning: /usr/lufia/go/src/cmd/cc/y.tab.c:1785[/usr/lufia/go/src/cmd/cc/y.tab.c:4614]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/cc/y.tab.c:1785[/usr/lufia/go/src/cmd/cc/y.tab.c:4614]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/cc/y.tab.c:1791[/usr/lufia/go/src/cmd/cc/y.tab.c:4620]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/cc/y.tab.c:1791[/usr/lufia/go/src/cmd/cc/y.tab.c:4620]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/cc/y.tab.c:1788[/usr/lufia/go/src/cmd/cc/y.tab.c:4617]\nset and not used: yymsg\nwarning: /usr/lufia/go/src/cmd/cc/y.tab.c:1868[/usr/lufia/go/src/cmd/cc/y.tab.c:4692]\nset and not used: yytoken\nwarning: /usr/lufia/go/src/cmd/cc/y.tab.c:1952[/usr/lufia/go/src/cmd/cc/y.tab.c:4772]\nset and not used: yyptr\ncmd/gc\nwarning:\n/usr/lufia/go/src/cmd/gc/mparith1.c:594[/usr/lufia/go/src/cmd/gc/mparith1.c:4120] more\narguments than format INT\nwarning: /usr/lufia/go/src/cmd/gc/y.tab.c:2074[/usr/lufia/go/src/cmd/gc/y.tab.c:5571]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/gc/y.tab.c:2074[/usr/lufia/go/src/cmd/gc/y.tab.c:5571]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/gc/y.tab.c:2077[/usr/lufia/go/src/cmd/gc/y.tab.c:5574]\nset and not used: yymsg\nwarning: /usr/lufia/go/src/cmd/gc/y.tab.c:4953[/usr/lufia/go/src/cmd/gc/y.tab.c:8426]\nuseless or misleading comparison: ULONG \u0026lt;= 0xffffffff\nwarning: /usr/lufia/go/src/cmd/gc/y.tab.c:4967[/usr/lufia/go/src/cmd/gc/y.tab.c:8440]\nuseless or misleading comparison: 0 \u0026lt; ULONG\nwarning: /usr/lufia/go/src/cmd/gc/y.tab.c:4969[/usr/lufia/go/src/cmd/gc/y.tab.c:8442]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/gc/y.tab.c:2264[/usr/lufia/go/src/cmd/gc/y.tab.c:5749]\nset and not used: yyptr\ncmd/8l\ncmd/8a\nwarning: /usr/lufia/go/src/cmd/8a/y.tab.c:1376[/usr/lufia/go/src/cmd/8a/y.tab.c:4299]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/8a/y.tab.c:1376[/usr/lufia/go/src/cmd/8a/y.tab.c:4299]\nresult of operation not used\nwarning: /usr/lufia/go/src/cmd/8a/y.tab.c:1379[/usr/lufia/go/src/cmd/8a/y.tab.c:4302]\nset and not used: yymsg\nwarning: /usr/lufia/go/src/cmd/8a/y.tab.c:1567[/usr/lufia/go/src/cmd/8a/y.tab.c:4478]\nset and not used: yyptr\ncmd/8c\ncmd/8g\npkg/runtime\npkg/errors\n(snip)\npkg/go/doc\npkg/go/build\ncmd/go\nsys: trap: invalid opcode pc=0x0004fd70\nPC=0x4fd70\n\ngoroutine 16 [running]:\nruntime.aeshashbody(0x30523f04, 0x8, 0x30523f38)\n\t/usr/lufia/go/src/pkg/runtime/asm_386.s:845 fp=0x30523ec0 sp=0x30523ebc\nhash_insert(0x18bda0, 0x10436020, 0x30523f38, 0x30523f34)\n\t/usr/lufia/go/src/pkg/runtime/hashmap.goc:492 +0x52 fp=0x30523f0c sp=0x30523ec0\nruntime.mapassign1(0x18bda0, 0x10436020, 0x30523f38, 0x30523f34)\n\t/usr/lufia/go/src/pkg/runtime/hashmap.goc:933 +0x3b fp=0x30523f24 sp=0x30523f0c\nunicode.init()\n\t/usr/lufia/go/src/pkg/unicode/tables.go:52 +0xab fp=0x30523f44 sp=0x30523f24\ngo/parser.init()\n\t/usr/lufia/go/src/pkg/go/parser/parser.go:2478 +0x47 fp=0x30523f50 sp=0x30523f44\nmain.init()\n\t/usr/lufia/go/src/cmd/go/zdefaultcc.go:6 +0x47 fp=0x30523f9c sp=0x30523f50\nruntime.main()\n\t/usr/lufia/go/src/pkg/runtime/proc.c:240 +0xd9 fp=0x30523fd0 sp=0x30523f9c\nruntime.goexit()\n\t/usr/lufia/go/src/pkg/runtime/proc.c:1445 fp=0x30523fd4 sp=0x30523fd0\ncreated by _rt0_go\n\t/usr/lufia/go/src/pkg/runtime/asm_386.s:101 +0x100\n\nax\t0x1e6730\nbx\t0x30523f34\ncx\t0x1\ndx\t0x30523f04\ndi\t0xdfffee5c\nsi\t0x30acc0\nbp\t0x1\nsp\t0x30523ebc\npc\t0x4fd70\nflags\t0x10206\ncs\t0x23\nfs\t0x1b\ngs\t0x1b\n\nPlease provide any additional information below.\n\nI copy go_bootstrap command from Plan 9 to remote.\nthen run `go tool objdump go_bootstrap' on Mac OS X.\n\nnear pc=0x0004fd70 below:\n\nTEXT runtime.aeshashstr(SB) /usr/lufia/go/src/pkg/runtime/asm_386.s\n        asm_386.s:835   0x4fd50 8b542404        MOVL 0x4(SP), DX\n        asm_386.s:836   0x4fd54 8b44240c        MOVL 0xc(SP), AX\n        asm_386.s:837   0x4fd58 8b4804          MOVL 0x4(AX), CX\n        asm_386.s:838   0x4fd5b 8b00            MOVL 0(AX), AX\n        asm_386.s:839   0x4fd5d e90e000000      JMP runtime.aeshashbody(SB)\n        asm_386.s:839   0x4fd62 0000            ADDL AL, 0(AX)\n        asm_386.s:839   0x4fd64 0000            ADDL AL, 0(AX)\n        asm_386.s:839   0x4fd66 0000            ADDL AL, 0(AX)\n        asm_386.s:839   0x4fd68 0000            ADDL AL, 0(AX)\n        asm_386.s:839   0x4fd6a 0000            ADDL AL, 0(AX)\n        asm_386.s:839   0x4fd6c 0000            ADDL AL, 0(AX)\n        asm_386.s:839   0x4fd6e 0000            ADDL AL, 0(AX)\n\nTEXT runtime.aeshashbody(SB) /usr/lufia/go/src/pkg/runtime/asm_386.s\n        asm_386.s:845   0x4fd70 660f6e02                MOVD 0(DX), X0\n        asm_386.s:846   0x4fd74 660f3a22c101            PINSRD $0x1, CX, X0\n        asm_386.s:847   0x4fd7a 660f6f1540c03000        MOVDQA 0x30c040(IP), X2\n        asm_386.s:848   0x4fd82 660f6f1d50c03000        MOVDQA 0x30c050(IP), X3\n        asm_386.s:849   0x4fd8a 83f910                  CMPL $0x10, CX\n        asm_386.s:850   0x4fd8d 7242                    JB 0x4fdd1\n        asm_386.s:852   0x4fd8f 83f910                  CMPL $0x10, CX\n        asm_386.s:853   0x4fd92 7619                    JBE 0x4fdad\n        asm_386.s:854   0x4fd94 f30f6f08                REP MOVDQU 0(AX), X1\n        asm_386.s:855   0x4fd98 660f38dcc2              AESENC X2, X0\u003c/pre\u003e",
	"user": {
		"login": "gopherbot",
		"id": 8566911,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 6,
	"closed_at": "2015-02-15T17:26:15Z",
	"created_at": "2014-09-06T16:34:43Z",
	"updated_at": "2016-06-25T01:40:54Z"
}
