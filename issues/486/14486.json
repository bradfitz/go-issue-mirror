{
	"id": 135953131,
	"number": 14486,
	"state": "closed",
	"title": "runtime: TestGoroutineParallelism2 fails with \"invalid memory address or nil pointer dereference\" on brillo",
	"body": "Reproducible on Qualcomm Dragonboard 410c, Brillo image built with BDK 7.5.4.\r\n\r\n```\r\ngo_android_exec: adb push /var/folders/00/1b8h8000h01000cxqpysvccm005d21/T/go-build559449628/runtime/_test/runtime.test /mnt/media_rw/tmp/runtime.test-55607/runtime.test-55607-tmp\r\n1484 KB/s (5098700 bytes in 3.353s)\r\ngo_android_exec: adb shell cp '/mnt/media_rw/tmp/runtime.test-55607/runtime.test-55607-tmp' '/mnt/media_rw/tmp/runtime.test-55607/runtime.test-55607'\r\ngo_android_exec: adb shell rm '/mnt/media_rw/tmp/runtime.test-55607/runtime.test-55607-tmp'\r\ngo_android_exec: adb shell export TMPDIR=\"/mnt/media_rw/tmp/runtime.test-55607\"; export GOROOT=\"/mnt/media_rw/goroot/\"; export GOPATH=\"/mnt/media_rw/gopath/\"; cd \"/mnt/media_rw/goroot/src/runtime\"; '/mnt/media_rw/tmp/runtime.test-55607/runtime.test-55607' -test.short=true -test.timeout=6m0s; echo -n exitcode=$?\r\n--- FAIL: TestGoroutineParallelism2 (0.05s)\r\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\r\n\tpanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal 0xb code=0x1 addr=0x0 pc=0xb6dc1f30]\r\n\r\ngoroutine 102631 [running]:\r\npanic(0xb6f9c4e0, 0x9691e030)\r\n\t/Users/jbd/go/src/runtime/panic.go:483 +0x37c fp=0x9692be24 sp=0x9692bde0\r\ntesting.tRunner.func1(0x9695e000)\r\n\t/Users/jbd/go/src/testing/testing.go:467 +0x16c fp=0x9692be80 sp=0x9692be24\r\nruntime.call16(0x0, 0xb7017854, 0x9719c05c, 0x4, 0x4)\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:429 +0x68 fp=0x9692be94 sp=0x9692be80\r\npanic(0xb6f9c4e0, 0x9691e030)\r\n\t/Users/jbd/go/src/runtime/panic.go:441 +0x49c fp=0x9692bed8 sp=0x9692be94\r\nruntime.panicmem()\r\n\t/Users/jbd/go/src/runtime/panic.go:45 +0x50 fp=0x9692beec sp=0x9692bed8\r\nruntime.sigpanic()\r\n\t/Users/jbd/go/src/runtime/sigpanic_unix.go:24 +0x2b4 fp=0x9692bf18 sp=0x9692beec\r\nruntime_test.testGoroutineParallelism2(0x9695e000, 0x1530100)\r\n\t/Users/jbd/go/src/runtime/proc_test.go:183 +0x2fc fp=0x9692bf9c sp=0x9692bf1c\r\nruntime_test.TestGoroutineParallelism2(0x9695e000)\r\n\t/Users/jbd/go/src/runtime/proc_test.go:141 +0x48 fp=0x9692bfa8 sp=0x9692bf9c\r\ntesting.tRunner(0x9695e000, 0xb70c5c1c)\r\n\t/Users/jbd/go/src/testing/testing.go:473 +0xb0 fp=0x9692bfcc sp=0x9692bfa8\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x9692bfcc sp=0x9692bfcc\r\ncreated by testing.RunTests\r\n\t/Users/jbd/go/src/testing/testing.go:582 +0x688\r\n\r\ngoroutine 1 [chan receive, locked to thread]:\r\nruntime.gopark(0xb7016dd4, 0x97736030, 0xb6fe36f0, 0xc, 0xb70d6717, 0x3)\r\n\t/Users/jbd/go/src/runtime/proc.go:262 +0x15c fp=0x96931d58 sp=0x96931d44\r\nruntime.goparkunlock(0x97736030, 0xb6fe36f0, 0xc, 0xb6d06617, 0x3)\r\n\t/Users/jbd/go/src/runtime/proc.go:268 +0x48 fp=0x96931d74 sp=0x96931d58\r\nruntime.chanrecv(0xb6f66658, 0x97736000, 0x96931e70, 0x96931d01, 0xb6d80000)\r\n\t/Users/jbd/go/src/runtime/chan.go:470 +0x538 fp=0x96931dbc sp=0x96931d74\r\nruntime.chanrecv1(0xb6f66658, 0x97736000, 0x96931e70)\r\n\t/Users/jbd/go/src/runtime/chan.go:355 +0x28 fp=0x96931dd4 sp=0x96931dbc\r\ntesting.RunTests(0xb7016ad0, 0xb70c5640, 0xb2, 0xb2, 0x96972001)\r\n\t/Users/jbd/go/src/testing/testing.go:583 +0x6b8 fp=0x96931ea4 sp=0x96931dd4\r\ntesting.(*M).Run(0x96931f7c, 0xb6dca6a8)\r\n\t/Users/jbd/go/src/testing/testing.go:515 +0x94 fp=0x96931eec sp=0x96931ea4\r\nruntime_test.TestMain(0x96931f7c)\r\n\t/Users/jbd/go/src/runtime/crash_test.go:24 +0x1c fp=0x96931f2c sp=0x96931eec\r\nmain.main()\r\n\truntime/_test/_testmain.go:996 +0x140 fp=0x96931fa4 sp=0x96931f2c\r\nruntime.main()\r\n\t/Users/jbd/go/src/runtime/proc.go:188 +0x328 fp=0x96931fcc sp=0x96931fa4\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x96931fcc sp=0x96931fcc\r\n\r\ngoroutine 17 [syscall, locked to thread]:\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x9692efd8 sp=0x9692efd8\r\n\r\ngoroutine 2 [force gc (idle)]:\r\nruntime.gopark(0xb7016dd4, 0xb70d6020, 0xb6fe7900, 0xf, 0x14, 0x1)\r\n\t/Users/jbd/go/src/runtime/proc.go:262 +0x15c fp=0x9691a7a8 sp=0x9691a794\r\nruntime.goparkunlock(0xb70d6020, 0xb6fe7900, 0xf, 0x14, 0x1)\r\n\t/Users/jbd/go/src/runtime/proc.go:268 +0x48 fp=0x9691a7c4 sp=0x9691a7a8\r\nruntime.forcegchelper()\r\n\t/Users/jbd/go/src/runtime/proc.go:229 +0xc8 fp=0x9691a7dc sp=0x9691a7c4\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x9691a7dc sp=0x9691a7dc\r\ncreated by runtime.init.4\r\n\t/Users/jbd/go/src/runtime/proc.go:218 +0x28\r\n\r\ngoroutine 3 [GC sweep wait]:\r\nruntime.gopark(0xb7016dd4, 0xb70d6178, 0xb6fe4800, 0xd, 0xb6d68914, 0x1)\r\n\t/Users/jbd/go/src/runtime/proc.go:262 +0x15c fp=0x9691af9c sp=0x9691af88\r\nruntime.goparkunlock(0xb70d6178, 0xb6fe4800, 0xd, 0x14, 0x1)\r\n\t/Users/jbd/go/src/runtime/proc.go:268 +0x48 fp=0x9691afb8 sp=0x9691af9c\r\nruntime.bgsweep(0x9690c080)\r\n\t/Users/jbd/go/src/runtime/mgcsweep.go:79 +0x178 fp=0x9691afd4 sp=0x9691afb8\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x9691afd4 sp=0x9691afd4\r\ncreated by runtime.gcenable\r\n\t/Users/jbd/go/src/runtime/mgc.go:191 +0x54\r\n\r\ngoroutine 4 [finalizer wait]:\r\nruntime.gopark(0xb7016dd4, 0xb70e421c, 0xb6fe6340, 0xe, 0x14, 0x1)\r\n\t/Users/jbd/go/src/runtime/proc.go:262 +0x15c fp=0x9691b788 sp=0x9691b774\r\nruntime.goparkunlock(0xb70e421c, 0xb6fe6340, 0xe, 0x14, 0x1)\r\n\t/Users/jbd/go/src/runtime/proc.go:268 +0x48 fp=0x9691b7a4 sp=0x9691b788\r\nruntime.runfinq()\r\n\t/Users/jbd/go/src/runtime/mfinal.go:158 +0xc4 fp=0x9691b7dc sp=0x9691b7a4\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x9691b7dc sp=0x9691b7dc\r\ncreated by runtime.createfing\r\n\t/Users/jbd/go/src/runtime/mfinal.go:139 +0x68\r\n\r\ngoroutine 5 [GC worker (idle)]:\r\nruntime.gopark(0x9790e014, 0x9691bfcc, 0xb6fe8b88, 0x10, 0x14, 0x0)\r\n\t/Users/jbd/go/src/runtime/proc.go:262 +0x15c fp=0x9691bf90 sp=0x9691bf7c\r\nruntime.gcBgMarkWorker(0x96912000)\r\n\t/Users/jbd/go/src/runtime/mgc.go:1402 +0xd4 fp=0x9691bfd4 sp=0x9691bf90\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x9691bfd4 sp=0x9691bfd4\r\ncreated by runtime.gcBgMarkStartWorkers\r\n\t/Users/jbd/go/src/runtime/mgc.go:1329 +0x8c\r\n\r\ngoroutine 7 [syscall]:\r\nruntime.notetsleepg(0xb70d6224, 0xe6502c86, 0x0, 0x0)\r\n\t/Users/jbd/go/src/runtime/lock_futex.go:205 +0x50 fp=0x9691cf88 sp=0x9691cf70\r\nruntime.timerproc()\r\n\t/Users/jbd/go/src/runtime/time.go:209 +0x148 fp=0x9691cfdc sp=0x9691cf88\r\nruntime.goexit()\r\n\t/Users/jbd/go/src/runtime/asm_arm.s:993 +0x4 fp=0x9691cfdc sp=0x9691cfdc\r\ncreated by runtime.addtimerLocked\r\n\t/Users/jbd/go/src/runtime/time.go:116 +0x210\r\nexitcode=2go_android_exec: adb shell rm -rf /mnt/media_rw/tmp/runtime.test-55607\r\nFAIL\truntime\t22.155s\r\n```",
	"user": {
		"login": "rakyll",
		"id": 108380,
		"type": "User",
		"site_admin": false
	},
	"assignee": {
		"login": "rakyll",
		"id": 108380,
		"type": "User",
		"site_admin": false
	},
	"comments": 2,
	"closed_at": "2016-03-08T00:23:01Z",
	"created_at": "2016-02-24T04:43:48Z",
	"updated_at": "2016-10-09T00:30:27Z",
	"milestone": {
		"id": 1414133,
		"number": 31,
		"title": "Go1.7"
	}
}
