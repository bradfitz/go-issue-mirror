{
	"id": 54004200,
	"number": 9564,
	"state": "closed",
	"title": "runtime: crashes on OS X 10.9 at TestGCFairness-2",
	"body": "Hello all:\r\n\r\nI’m running the master branch build script on Mac OS X 10.9.5. The build fails a crash when running the test suite. For what it’s worth, the exact same build and test suite works fine on my OS X 10.10.1 machine that has an identical gcc version.\r\n\r\ngcc --version\r\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\r\nApple LLVM version 6.0 (clang-600.0.56) (based on LLVM 3.5svn)\r\nTarget: x86_64-apple-darwin13.4.0\r\nThread model: posix\r\n\r\nThe steps I am performing are:\r\ncd /usr/local/go/src #in here is a clone of master\r\ngit fetch\r\ngit pull\r\n./all.bash\r\n\r\nThe failure/error text is:\r\n##### GOMAXPROCS=2 runtime -cpu=1,2,4\r\n--- FAIL: TestGCFairness-2 (0.04s)\r\n\tcrash_test.go:76: building source: exit status 2\r\n\t\truntime:greyobject: checkmarks finds unexpected unmarked object obj=0xc2080a2080, mbits-\u003ebits=0x1 *mbits-\u003ebitp=0xb9\r\n\t\truntime: found obj at *(0xc20805c5f0+0x38)\r\n\t\truntime:greyobject Span: obj=0xc2080a2080 k=0x6104051 s.start=0xc2080a2000 s.limit=0xc2080a4000 s.sizeclass=1 s.elemsize=8\r\n\t\t *(obj+0) = 0xc208053410\r\n\t\tfatal error: checkmark found unmarked object\r\n\t\t\r\n\t\truntime stack:\r\n\t\truntime.throw(0x4ea0b0, 0x1f)\r\n\t\t\t/usr/local/go/src/runtime/panic.go:508 +0x98 fp=0x7fff5fbff240 sp=0x7fff5fbff228\r\n\t\truntime.greyobject(0xc2080a2080, 0xc20805c5f0, 0x38, 0x7fff5fbff330, 0x78d840, 0x78d840)\r\n\t\t\t/usr/local/go/src/runtime/mgc.go:440 +0x2c9 fp=0x7fff5fbff2a0 sp=0x7fff5fbff240\r\n\t\truntime.scanobject(0xc20805c5f0, 0x1a3a10, 0x0, 0x78d840, 0x78d840)\r\n\t\t\t/usr/local/go/src/runtime/mgc.go:573 +0x3f0 fp=0x7fff5fbff350 sp=0x7fff5fbff2a0\r\n\t\truntime.drainworkbuf(0x78d840, 0x300000001)\r\n\t\t\t/usr/local/go/src/runtime/mgc.go:650 +0x184 fp=0x7fff5fbff380 sp=0x7fff5fbff350\r\n\t\truntime.scanblock(0x0, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/runtime/mgc.go:610 +0xe5 fp=0x7fff5fbff3c8 sp=0x7fff5fbff380\r\n\t\truntime.gchelper()\r\n\t\t\t/usr/local/go/src/runtime/mgc.go:1562 +0x75 fp=0x7fff5fbff3f8 sp=0x7fff5fbff3c8\r\n\t\truntime.stopm()\r\n\t\t\t/usr/local/go/src/runtime/proc1.go:1052 +0x164 fp=0x7fff5fbff420 sp=0x7fff5fbff3f8\r\n\t\truntime.gcstopm()\r\n\t\t\t/usr/local/go/src/runtime/proc1.go:1215 +0xff fp=0x7fff5fbff450 sp=0x7fff5fbff420\r\n\t\truntime.schedule()\r\n\t\t\t/usr/local/go/src/runtime/proc1.go:1424 +0xa4 fp=0x7fff5fbff480 sp=0x7fff5fbff450\r\n\t\truntime.gosched_m(0xc208000120)\r\n\t\t\t/usr/local/go/src/runtime/proc1.go:1535 +0x119 fp=0x7fff5fbff4a0 sp=0x7fff5fbff480\r\n\t\truntime.newstack()\r\n\t\t\t/usr/local/go/src/runtime/stack1.go:712 +0xa3a fp=0x7fff5fbff5f8 sp=0x7fff5fbff4a0\r\n\t\truntime.morestack()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:311 +0x7e fp=0x7fff5fbff600 sp=0x7fff5fbff5f8\r\n\t\t\r\n\t\tgoroutine 1 [runnable]:\r\n\t\tgo/build.(*importReader).readByte(0xc2080ed040, 0x87620)\r\n\t\t\t/usr/local/go/src/go/build/read.go:40 fp=0xc2080d1498 sp=0xc2080d1490\r\n\t\tgo/build.(*importReader).peekByte(0xc2080ed040, 0x495401, 0x22)\r\n\t\t\t/usr/local/go/src/go/build/read.go:89 +0x164 fp=0xc2080d14d8 sp=0xc2080d1498\r\n\t\tgo/build.readImports(0x78ddc0, 0xc2080a2100, 0xc2080a2100, 0x0, 0x0, 0x0, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/go/build/read.go:209 +0x108 fp=0xc2080d1530 sp=0xc2080d14d8\r\n\t\tgo/build.(*Context).matchFile(0x6bcfe0, 0xc208064ba0, 0x19, 0xc2080b590a, 0x9, 0xc208076001, 0xc2080e9740, 0x0, 0x0, 0x0, ...)\r\n\t\t\t/usr/local/go/src/go/build/build.go:963 +0x5be fp=0xc2080d1678 sp=0xc2080d1530\r\n\t\tgo/build.(*Context).Import(0x6bcfe0, 0x499f10, 0x7, 0xc20805f7a0, 0x18, 0x4, 0x77b000, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/go/build/build.go:625 +0x1dcb fp=0xc2080d1fa0 sp=0xc2080d1678\r\n\t\tmain.loadImport(0x499f10, 0x7, 0xc20805f7a0, 0x18, 0xc20805ea20, 0x0, 0x0, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:267 +0x4e1 fp=0xc2080d2158 sp=0xc2080d1fa0\r\n\t\tmain.(*Package).load(0xc208021800, 0xc20805ea20, 0xc20800c900, 0x0, 0x0, 0x4)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:584 +0x3e0c fp=0xc2080d2718 sp=0xc2080d2158\r\n\t\tmain.loadImport(0xc2080a08f1, 0x6, 0xc20805e960, 0x15, 0xc20805ea20, 0xc20805cb40, 0x2, 0x2, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:275 +0x63d fp=0xc2080d28d0 sp=0xc2080d2718\r\n\t\tmain.(*Package).load(0xc208021400, 0xc20805ea20, 0xc20800c300, 0x0, 0x0, 0x4)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:584 +0x3e0c fp=0xc2080d2e90 sp=0xc2080d28d0\r\n\t\tmain.loadImport(0xc2080a00eb, 0x3, 0xc20805d6d0, 0x4a, 0xc20805ea20, 0xc208053860, 0x1, 0x1, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:275 +0x63d fp=0xc2080d3048 sp=0xc2080d2e90\r\n\t\tmain.(*Package).load(0xc2080de000, 0xc20805ea20, 0xc20800c600, 0x0, 0x0, 0x4)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:584 +0x3e0c fp=0xc2080d3608 sp=0xc2080d3048\r\n\t\tmain.loadImport(0x486df0, 0x1, 0xc2080464b0, 0x4a, 0xc20805ea20, 0x0, 0x0, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:275 +0x63d fp=0xc2080d37c0 sp=0xc2080d3608\r\n\t\tmain.loadPackage(0x486df0, 0x1, 0xc20805ea20, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:866 +0xfd6 fp=0xc2080d3a18 sp=0xc2080d37c0\r\n\t\tmain.packagesAndErrors(0xc2080a13f0, 0x1, 0x1, 0x0, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:905 +0x366 fp=0xc2080d3b30 sp=0xc2080d3a18\r\n\t\tmain.packagesForBuild(0xc20800a030, 0x0, 0x0, 0x0, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/pkg.go:918 +0x74 fp=0xc2080d3c40 sp=0xc2080d3b30\r\n\t\tmain.runBuild(0x6b7c20, 0xc20800a030, 0x0, 0x0)\r\n\t\t\t/usr/local/go/src/cmd/go/build.go:266 +0x78 fp=0xc2080d3d98 sp=0xc2080d3c40\r\n\t\tmain.main()\r\n\t\t\t/usr/local/go/src/cmd/go/main.go:164 +0x608 fp=0xc2080d3f98 sp=0xc2080d3d98\r\n\t\truntime.main()\r\n\t\t\t/usr/local/go/src/runtime/proc.go:86 +0x1d3 fp=0xc2080d3fe0 sp=0xc2080d3f98\r\n\t\truntime.goexit()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:2430 +0x1 fp=0xc2080d3fe8 sp=0xc2080d3fe0\r\n\t\t\r\n\t\tgoroutine 2 [force gc (idle)]:\r\n\t\truntime.gopark(0x56e330, 0x6bc8b0, 0x4b3850, 0xf)\r\n\t\t\t/usr/local/go/src/runtime/proc.go:151 +0x108 fp=0xc20801a798 sp=0xc20801a768\r\n\t\truntime.goparkunlock(0x6bc8b0, 0x4b3850, 0xf)\r\n\t\t\t/usr/local/go/src/runtime/proc.go:157 +0x48 fp=0xc20801a7c0 sp=0xc20801a798\r\n\t\truntime.forcegchelper()\r\n\t\t\t/usr/local/go/src/runtime/proc.go:120 +0xce fp=0xc20801a7e0 sp=0xc20801a7c0\r\n\t\truntime.goexit()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:2430 +0x1 fp=0xc20801a7e8 sp=0xc20801a7e0\r\n\t\tcreated by runtime.init·4\r\n\t\t\t/usr/local/go/src/runtime/proc.go:108 +0x33\r\n\t\t\r\n\t\tgoroutine 3 [garbage collection]:\r\n\t\truntime.systemstack_switch()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:199 fp=0xc20801af48 sp=0xc20801af40\r\n\t\truntime.gcwork(0x0)\r\n\t\t\t/usr/local/go/src/runtime/malloc.go:583 +0x2b9 fp=0xc20801afc0 sp=0xc20801af48\r\n\t\truntime.backgroundgc()\r\n\t\t\t/usr/local/go/src/runtime/mgc0.go:87 +0x62 fp=0xc20801afe0 sp=0xc20801afc0\r\n\t\truntime.goexit()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:2430 +0x1 fp=0xc20801afe8 sp=0xc20801afe0\r\n\t\tcreated by runtime.gogc\r\n\t\t\t/usr/local/go/src/runtime/malloc.go:501 +0xe2\r\n\t\t\r\n\t\tgoroutine 17 [GC sweep wait]:\r\n\t\truntime.gopark(0x56e330, 0x6d12d8, 0x4a71b0, 0xd)\r\n\t\t\t/usr/local/go/src/runtime/proc.go:151 +0x108 fp=0xc20801d798 sp=0xc20801d768\r\n\t\truntime.goparkunlock(0x6d12d8, 0x4a71b0, 0xd)\r\n\t\t\t/usr/local/go/src/runtime/proc.go:157 +0x48 fp=0xc20801d7c0 sp=0xc20801d798\r\n\t\truntime.bgsweep()\r\n\t\t\t/usr/local/go/src/runtime/mgc0.go:111 +0xdd fp=0xc20801d7e0 sp=0xc20801d7c0\r\n\t\truntime.goexit()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:2430 +0x1 fp=0xc20801d7e8 sp=0xc20801d7e0\r\n\t\tcreated by runtime.gc\r\n\t\t\t/usr/local/go/src/runtime/mgc.go:2131 +0xe6b\r\n\t\t\r\n\t\tgoroutine 4 [finalizer wait]:\r\n\t\truntime.gopark(0x56e330, 0x6d12d0, 0x4b2f90, 0xe)\r\n\t\t\t/usr/local/go/src/runtime/proc.go:151 +0x108 fp=0xc208018748 sp=0xc208018718\r\n\t\truntime.goparkunlock(0x6d12d0, 0x4b2f90, 0xe)\r\n\t\t\t/usr/local/go/src/runtime/proc.go:157 +0x48 fp=0xc208018770 sp=0xc208018748\r\n\t\truntime.runfinq()\r\n\t\t\t/usr/local/go/src/runtime/malloc.go:959 +0xb7 fp=0xc2080187e0 sp=0xc208018770\r\n\t\truntime.goexit()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:2430 +0x1 fp=0xc2080187e8 sp=0xc2080187e0\r\n\t\tcreated by runtime.createfing\r\n\t\t\t/usr/local/go/src/runtime/malloc.go:939 +0x68\r\n\t\t\r\n\t\tgoroutine 18 [syscall]:\r\n\t\truntime.notetsleepg(0x6d1ca0, 0xffffffffffffffff, 0x1)\r\n\t\t\t/usr/local/go/src/runtime/lock_sema.go:262 +0x93 fp=0xc208018f68 sp=0xc208018f28\r\n\t\truntime.signal_recv(0x0)\r\n\t\t\t/usr/local/go/src/runtime/sigqueue.go:109 +0x135 fp=0xc208018fa0 sp=0xc208018f68\r\n\t\tos/signal.loop()\r\n\t\t\t/usr/local/go/src/os/signal/signal_unix.go:21 +0x1f fp=0xc208018fe0 sp=0xc208018fa0\r\n\t\truntime.goexit()\r\n\t\t\t/usr/local/go/src/runtime/asm_amd64.s:2430 +0x1 fp=0xc208018fe8 sp=0xc208018fe0\r\n\t\tcreated by os/signal.init·1\r\n\t\t\t/usr/local/go/src/os/signal/signal_unix.go:27 +0x3f\r\nFAIL\r\nFAIL\truntime\t22.548s",
	"user": {
		"login": "odysseus9672",
		"id": 4352294,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 2,
	"closed_at": "2015-01-11T20:45:17Z",
	"created_at": "2015-01-11T20:44:39Z",
	"updated_at": "2016-06-25T01:58:17Z"
}
