{
	"id": 160651556,
	"number": 16081,
	"state": "closed",
	"title": "runtime: docker build failure with go-1.6.2/musl libc on armhf",
	"body": "Please answer these questions before submitting your issue. Thanks!\r\n\r\n1. What version of Go are you using (`go version`)?\r\n\r\n`go version go1.6.2 linux/arm`\r\n\r\n2. What operating system and processor architecture are you using (`go env`)?\r\n\r\nAlpine Linux edge.\r\n`Linux ncdev-edge-armhf 4.1.15-0-grsec #1-Alpine SMP Wed Dec 16 15:13:43 GMT 2015 armv7l Linux`\r\n\r\nOn wandboard quad with 2G ram and 4G swap.\r\n\r\n````sh\r\nGOARCH=\"arm\"\r\nGOBIN=\"\"\r\nGOEXE=\"\"\r\nGOHOSTARCH=\"arm\"\r\nGOHOSTOS=\"linux\"\r\nGOOS=\"linux\"\r\nGOPATH=\"\"\r\nGORACE=\"\"\r\nGOROOT=\"/usr/lib/go\"\r\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_arm\"\r\nGO15VENDOREXPERIMENT=\"1\"\r\nCC=\"gcc\"\r\nGOGCCFLAGS=\"-fPIC -marm -pthread -fmessage-length=0\"\r\nCXX=\"g++\"\r\nCGO_ENABLED=\"1\"\r\n````\r\n\r\n3. What did you do?\r\nIf possible, provide a recipe for reproducing the error.\r\nA complete runnable program is good.\r\nA link on play.golang.org is best.\r\n\r\ntried to build docker-1.11.2 as:\r\n````sh\r\n        export AUTO_GOPATH=1\r\n        export DOCKER_GITCOMMIT=$_gitcommit\r\n        export DOCKER_BUILDTAGS=$_buildtags\r\n        unset CC # prevent possible ccache issues\r\n\r\n        # docker\r\n        cd \"$builddir\"\r\n        ./hack/make.sh dynbinary || return 1\r\n````\r\n\r\nFull build script is found here:  http://git.alpinelinux.org/cgit/aports/tree/community/docker/APKBUILD#n62\r\n\r\n4. What did you expect to see?\r\n\r\ndocker sucessfully built.\r\n\r\n5. What did you see instead?\r\n\r\n````\r\n---\u003e Making bundle: dynbinary (in bundles/1.11.2/dynbinary)\r\nBuilding: bundles/1.11.2/dynbinary/docker-1.11.2\r\n# github.com/ugorji/go/codec\r\nruntime: memory allocated by OS (0x7f092000) not in usable range [0x8f958000,0xffffffff)\r\nfatal error: out of memory\r\n\r\nruntime stack:\r\nruntime.throw(0x40ba28, 0xd)\r\n        /usr/lib/go/src/runtime/panic.go:547 +0x78\r\nruntime.(*mcache).refill(0x7f8174b0, 0xe, 0x7f1c1e80)\r\n        /usr/lib/go/src/runtime/mcache.go:121 +0xfc\r\nruntime.mallocgc.func2()\r\n        /usr/lib/go/src/runtime/malloc.go:642 +0x28\r\nruntime.systemstack(0x82dd00)\r\n        /usr/lib/go/src/runtime/asm_arm.s:247 +0x80\r\nruntime.mstart()\r\n        /usr/lib/go/src/runtime/proc.go:1051\r\n\r\ngoroutine 1 [running]:\r\nruntime.systemstack_switch()\r\n        /usr/lib/go/src/runtime/asm_arm.s:192 +0x4 fp=0xa3e7f6b4 sp=0xa3e7f6b0\r\nruntime.mallocgc(0xd0, 0x3e42e8, 0x0, 0xaf8d7ee0)\r\n        /usr/lib/go/src/runtime/malloc.go:643 +0x930 fp=0xa3e7f724 sp=0xa3e7f6b4\r\nruntime.newobject(0x3e42e8, 0xaf8d7ee0)\r\n        /usr/lib/go/src/runtime/malloc.go:781 +0x50 fp=0xa3e7f738 sp=0xa3e7f724\r\ncmd/internal/obj/arm.preprocess(0x8f964300, 0xa8c07aa0)\r\n        /usr/lib/go/src/cmd/internal/obj/arm/obj5.go:431 +0xc14 fp=0xa3e7fa7c sp=0xa3e7f738\r\ncmd/internal/obj.Flushplist(0x8f964300)\r\n        /usr/lib/go/src/cmd/internal/obj/objfile.go:299 +0x2b8 fp=0xa3e7fbd8 sp=0xa3e7fa7c\r\ncmd/internal/obj.Writeobjdirect(0x8f964300, 0xa3cad560)\r\n        /usr/lib/go/src/cmd/internal/obj/objfile.go:114 +0x1c fp=0xa3e7fbe4 sp=0xa3e7fbd8\r\ncmd/compile/internal/gc.dumpobj()\r\n        /usr/lib/go/src/cmd/compile/internal/gc/obj.go:88 +0xca8 fp=0xa3e7fd30 sp=0xa3e7fbe4\r\ncmd/compile/internal/gc.Main()\r\n        /usr/lib/go/src/cmd/compile/internal/gc/lex.go:495 +0x260c fp=0xa3e7fefc sp=0xa3e7fd30\r\ncmd/compile/internal/arm.Main()\r\n        /usr/lib/go/src/cmd/compile/internal/arm/galign.go:92 +0x538 fp=0xa3e7ff08 sp=0xa3e7fefc\r\nmain.main()\r\n        /usr/lib/go/src/cmd/compile/main.go:34 +0x15c fp=0xa3e7ff74 sp=0xa3e7ff08\r\nruntime.main()\r\n        /usr/lib/go/src/runtime/proc.go:188 +0x2b4 fp=0xa3e7ff9c sp=0xa3e7ff74\r\nruntime.goexit()\r\n        /usr/lib/go/src/runtime/asm_arm.s:990 +0x4 fp=0xa3e7ff9c sp=0xa3e7ff9c\r\n````\r\n",
	"user": {
		"login": "ncopa",
		"id": 66357,
		"type": "User",
		"site_admin": false
	},
	"comments": 9,
	"closed_at": "2016-06-16T22:07:59Z",
	"created_at": "2016-06-16T12:39:57Z",
	"updated_at": "2016-06-16T22:07:59Z"
}
