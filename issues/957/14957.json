{
	"id": 143414304,
	"number": 14957,
	"state": "closed",
	"title": "cmd/link: external linking can fail on Solaris 11.2+",
	"body": "1. What version of Go are you using (`go version`)?\r\n`go version devel +ba333a3 Fri Mar 25 01:09:28 2016 +0000 solaris/amd64`\r\n\r\n2. What operating system and processor architecture are you using (`go env`)?\r\n`SunOS solaris 5.11 11.3 i86pc i386 i86pc`\r\n\r\n```\r\nGOARCH=\"amd64\"\r\nGOBIN=\"\"\r\nGOEXE=\"\"\r\nGOHOSTARCH=\"amd64\"\r\nGOHOSTOS=\"solaris\"\r\nGOOS=\"solaris\"\r\nGOPATH=\"\"\r\nGORACE=\"\"\r\nGOROOT=\"/export/home/joe/src/go\"\r\nGOTOOLDIR=\"/export/home/joe/src/go/pkg/tool/solaris_amd64\"\r\nCC=\"gcc\"\r\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build162816245=/tmp/go-build -gno-record-gcc-switches\"\r\nCXX=\"g++\"\r\nCGO_ENABLED=\"1\"\r\n```\r\n\r\nGCC:\r\n\r\n```\r\nUsing built-in specs.\r\nCOLLECT_GCC=gcc\r\nCOLLECT_LTO_WRAPPER=/usr/gcc/4.8/lib/gcc/i386-pc-solaris2.11/4.8.2/lto-wrapper\r\nTarget: i386-pc-solaris2.11\r\nConfigured with: /builds/hudson/workspace/nightly-update/build/i386/components/gcc48/gcc-4.8.2/configure CC=/usr/gcc/4.7/bin/gcc CXX=/usr/gcc/4.7/bin/g++ --prefix=/usr/gcc/4.8 --mandir=/usr/gcc/4.8/share/man --bindir=/usr/gcc/4.8/bin --libdir=/usr/gcc/4.8/lib --sbindir=/usr/gcc/4.8/sbin --infodir=/usr/gcc/4.8/share/info --libexecdir=/usr/gcc/4.8/lib --enable-languages=c,c++,fortran,objc --enable-shared --with-gmp-include=/usr/include/gmp --with-mpfr-include=/usr/include/mpfr --without-gnu-ld --with-ld=/usr/bin/ld --with-gnu-as --with-as=/usr/gnu/bin/as CFLAGS='-g -O2  -mtune=opteron -march=opteron' CXXFLAGS='-g -O2 -mtune=opteron -march=opteron'\r\nThread model: posix\r\ngcc version 4.8.2 (GCC) \r\n```\r\n\r\n3. What did you do?\r\n\r\nBootstrapping with Go 1.4.3\r\n\r\n```\r\n##### Testing packages.\r\nok  \tarchive/tar\t0.023s\r\nok  \tarchive/zip\t0.074s\r\nok  \tbufio\t0.044s\r\nok  \tbytes\t0.062s\r\nok  \tcompress/bzip2\t0.062s\r\nok  \tcompress/flate\t0.851s\r\nok  \tcompress/gzip\t0.013s\r\nok  \tcompress/lzw\t0.008s\r\nok  \tcompress/zlib\t0.021s\r\nok  \tcontainer/heap\t0.006s\r\nok  \tcontainer/list\t0.006s\r\nok  \tcontainer/ring\t0.013s\r\nok  \tcrypto/aes\t0.024s\r\nok  \tcrypto/cipher\t0.006s\r\nok  \tcrypto/des\t0.013s\r\nok  \tcrypto/dsa\t0.007s\r\nok  \tcrypto/ecdsa\t0.018s\r\nok  \tcrypto/elliptic\t0.027s\r\nok  \tcrypto/hmac\t0.006s\r\nok  \tcrypto/md5\t0.006s\r\nok  \tcrypto/rand\t0.012s\r\nok  \tcrypto/rc4\t0.055s\r\nok  \tcrypto/rsa\t0.058s\r\nok  \tcrypto/sha1\t0.006s\r\nok  \tcrypto/sha256\t0.006s\r\nok  \tcrypto/sha512\t0.006s\r\nok  \tcrypto/subtle\t0.007s\r\nok  \tcrypto/tls\t0.471s\r\nok  \tcrypto/x509\t0.658s\r\nok  \tdatabase/sql\t0.035s\r\nok  \tdatabase/sql/driver\t0.006s\r\nok  \tdebug/dwarf\t0.015s\r\nok  \tdebug/elf\t0.025s\r\nok  \tdebug/gosym\t0.220s\r\nok  \tdebug/macho\t0.008s\r\nok  \tdebug/pe\t0.025s\r\nok  \tdebug/plan9obj\t0.006s\r\nok  \tencoding/ascii85\t0.006s\r\nok  \tencoding/asn1\t0.007s\r\nok  \tencoding/base32\t0.011s\r\nok  \tencoding/base64\t0.007s\r\nok  \tencoding/binary\t0.006s\r\nok  \tencoding/csv\t0.007s\r\nok  \tencoding/gob\t0.033s\r\nok  \tencoding/hex\t0.006s\r\nok  \tencoding/json\t0.105s\r\nok  \tencoding/pem\t0.013s\r\nok  \tencoding/xml\t0.012s\r\nok  \terrors\t0.007s\r\nok  \texpvar\t0.008s\r\nok  \tflag\t0.008s\r\nok  \tfmt\t0.073s\r\nok  \tgo/ast\t0.011s\r\nok  \tgo/build\t0.153s\r\nok  \tgo/constant\t0.007s\r\nok  \tgo/doc\t0.034s\r\nok  \tgo/format\t0.009s\r\nok  \tgo/internal/gccgoimporter\t0.007s\r\nok  \tgo/internal/gcimporter\t0.354s\r\nok  \tgo/parser\t0.028s\r\nok  \tgo/printer\t0.185s\r\nok  \tgo/scanner\t0.006s\r\nok  \tgo/token\t0.016s\r\nok  \tgo/types\t0.317s\r\nok  \thash/adler32\t0.011s\r\nok  \thash/crc32\t0.006s\r\nok  \thash/crc64\t0.007s\r\nok  \thash/fnv\t0.005s\r\nok  \thtml\t0.007s\r\nok  \thtml/template\t0.026s\r\nok  \timage\t0.076s\r\nok  \timage/color\t0.038s\r\nok  \timage/draw\t0.042s\r\nok  \timage/gif\t0.053s\r\nok  \timage/jpeg\t0.095s\r\nok  \timage/png\t0.028s\r\nok  \tindex/suffixarray\t0.014s\r\nok  \tinternal/singleflight\t0.017s\r\nok  \tinternal/trace\t0.006s\r\nok  \tio\t0.025s\r\nok  \tio/ioutil\t0.006s\r\nok  \tlog\t0.008s\r\nok  \tlog/syslog\t2.029s\r\nok  \tmath\t0.007s\r\nok  \tmath/big\t0.181s\r\nok  \tmath/cmplx\t0.006s\r\nok  \tmath/rand\t0.055s\r\nok  \tmime\t0.009s\r\nok  \tmime/multipart\t0.171s\r\nok  \tmime/quotedprintable\t0.077s\r\nok  \tnet\t3.225s\r\nok  \tnet/http\t9.887s\r\nok  \tnet/http/cgi\t0.226s\r\nok  \tnet/http/cookiejar\t0.010s\r\nok  \tnet/http/fcgi\t0.009s\r\nok  \tnet/http/httptest\t0.011s\r\nok  \tnet/http/httputil\t0.032s\r\nok  \tnet/http/internal\t0.006s\r\nok  \tnet/internal/socktest\t0.006s\r\nok  \tnet/mail\t0.007s\r\nok  \tnet/rpc\t0.015s\r\nok  \tnet/rpc/jsonrpc\t0.012s\r\nok  \tnet/smtp\t0.027s\r\nok  \tnet/textproto\t0.007s\r\nok  \tnet/url\t0.010s\r\nok  \tos\t0.306s\r\nok  \tos/exec\t0.595s\r\nok  \tos/signal\t4.398s\r\nok  \tos/user\t0.006s\r\nok  \tpath\t0.007s\r\nok  \tpath/filepath\t0.044s\r\nok  \treflect\t0.045s\r\nok  \tregexp\t0.077s\r\nok  \tregexp/syntax\t0.224s\r\n--- FAIL: TestCgoCrashHandler (1.40s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoSignalDeadlock (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoTraceback (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoCallbackGC (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoExternalThreadPanic (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoExternalThreadSIGPROF (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoExternalThreadSignal (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoExecSignalMask (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestEnsureDropM (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoCheckBytes (0.00s)\r\n\tcrash_cgo_test.go:162: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoPanicDeadlock (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n--- FAIL: TestCgoCCodeSIGPROF (0.00s)\r\n\tcrash_test.go:66: building testprogcgo: exit status 2\r\n\t\t# _/export/home/joe/src/go/src/runtime/testdata/testprogcgo\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\nFAIL\r\nFAIL\truntime\t7.737s\r\nok  \truntime/debug\t0.008s\r\nok  \truntime/internal/atomic\t0.055s\r\nok  \truntime/pprof\t1.285s\r\nok  \truntime/trace\t3.394s\r\nok  \tsort\t0.044s\r\nok  \tstrconv\t0.298s\r\nok  \tstrings\t0.069s\r\nok  \tsync\t0.104s\r\nok  \tsync/atomic\t0.016s\r\nok  \tsyscall\t0.024s\r\nok  \ttesting\t2.330s\r\nok  \ttesting/quick\t0.110s\r\nok  \ttext/scanner\t0.007s\r\nok  \ttext/tabwriter\t0.007s\r\nok  \ttext/template\t0.020s\r\nok  \ttext/template/parse\t0.008s\r\nok  \ttime\t2.319s\r\nok  \tunicode\t0.007s\r\nok  \tunicode/utf16\t0.006s\r\nok  \tunicode/utf8\t0.008s\r\nok  \tvendor/golang.org/x/net/http2/hpack\t0.008s\r\nok  \tcmd/addr2line\t0.603s\r\nok  \tcmd/api\t0.012s\r\nok  \tcmd/asm/internal/asm\t0.144s\r\nok  \tcmd/asm/internal/lex\t0.007s\r\nok  \tcmd/compile/internal/big\t0.436s\r\nok  \tcmd/compile/internal/gc\t12.885s\r\nok  \tcmd/compile/internal/ssa\t0.151s\r\nok  \tcmd/cover\t1.121s\r\nok  \tcmd/doc\t0.023s\r\nok  \tcmd/fix\t0.012s\r\n--- FAIL: TestCoverageWithCgo (0.64s)\r\n\tgo_test.go:244: running testgo [test -short -cover ./testdata/cgocover]\r\n\tgo_test.go:259: standard output:\r\n\tgo_test.go:260: FAIL\t_/export/home/joe/src/go/src/cmd/go/testdata/cgocover [build failed]\r\n\t\t\r\n\tgo_test.go:263: standard error:\r\n\tgo_test.go:264: # testmain\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n\tgo_test.go:273: go [test -short -cover ./testdata/cgocover] failed unexpectedly: exit status 2\r\n--- FAIL: TestNoteReading (0.33s)\r\n\tgo_test.go:244: running testgo [build -ldflags -buildid=TestNoteReading-Build-ID -o /tmp/gotest401197282/hello.exe /tmp/gotest401197282/hello.go]\r\n\tgo_test.go:244: running testgo [build -ldflags -buildid=TestNoteReading-Build-ID -linkmode=external -o /tmp/gotest401197282/hello.exe /tmp/gotest401197282/hello.go]\r\n\tgo_test.go:263: standard error:\r\n\tgo_test.go:264: # command-line-arguments\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n\tgo_test.go:273: go [build -ldflags -buildid=TestNoteReading-Build-ID -linkmode=external -o /tmp/gotest401197282/hello.exe /tmp/gotest401197282/hello.go] failed unexpectedly: exit status 2\r\n--- FAIL: TestNoteReading2K (0.36s)\r\n\tgo_test.go:244: running testgo [build -ldflags -buildid=TestNoteReading-Build-ID -o /tmp/gotest764207321/hello.exe /tmp/gotest764207321/hello.go]\r\n\tgo_test.go:244: running testgo [build -ldflags -buildid=TestNoteReading-Build-ID -linkmode=external -o /tmp/gotest764207321/hello.exe /tmp/gotest764207321/hello.go]\r\n\tgo_test.go:263: standard error:\r\n\tgo_test.go:264: # command-line-arguments\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\n\t\t\r\n\tgo_test.go:273: go [build -ldflags -buildid=TestNoteReading-Build-ID -linkmode=external -o /tmp/gotest764207321/hello.exe /tmp/gotest764207321/hello.go] failed unexpectedly: exit status 2\r\nFAIL\r\nFAIL\tcmd/go\t42.164s\r\nok  \tcmd/gofmt\t0.031s\r\nok  \tcmd/internal/goobj\t0.006s\r\nok  \tcmd/internal/obj\t0.006s\r\nok  \tcmd/internal/obj/x86\t0.007s\r\nok  \tcmd/internal/unvendor/golang.org/x/arch/arm/armasm\t0.008s\r\nok  \tcmd/internal/unvendor/golang.org/x/arch/x86/x86asm\t0.124s\r\nok  \tcmd/nm\t0.551s\r\n--- FAIL: TestDisasmExtld (0.76s)\r\n\tobjdump_test.go:71: go build fmthello.go: exit status 2\r\n\t\t# command-line-arguments\r\n\t\t/export/home/joe/src/go/pkg/tool/solaris_amd64/link: running gcc failed: exit status 1\r\n\t\tld: fatal: bad section layout: .SUNW_ldynsym must precede and be adjacent to .dynsym\r\n\t\tcollect2: error: ld returned 1 exit status\r\n\t\t\r\nFAIL\r\nFAIL\tcmd/objdump\t1.516s\r\nok  \tcmd/pack\t1.345s\r\nok  \tcmd/pprof/internal/profile\t0.006s\r\nok  \tcmd/vet\t2.004s\r\n2016/03/24 21:25:34 Failed: exit status 1\r\n```",
	"user": {
		"login": "jtsylve",
		"id": 594165,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "OS-Solaris"
		}
	],
	"comments": 21,
	"closed_at": "2016-04-11T18:03:43Z",
	"created_at": "2016-03-25T03:13:51Z",
	"updated_at": "2016-06-24T21:00:28Z",
	"milestone": {
		"id": 1414133,
		"number": 31,
		"title": "Go1.7"
	}
}
