{
	"id": 177019750,
	"number": 17109,
	"state": "open",
	"title": "cmd/compile: using r0 more efficiently on ppc64x with SSA",
	"body": "Please answer these questions before submitting your issue. Thanks!\r\n\r\n### What version of Go are you using (`go version`)?\r\ngo version devel +9fcbde7 Wed Sep 14 10:07:17 2016 -0500 linux/ppc64le\r\n\r\n### What operating system and processor architecture are you using (`go env`)?\r\nUbuntu 16.04 ppc64le\r\n\r\n### What did you do?\r\nBuilt the test from the math package and looked at objdump to inspect generated code now that we have SSA for ppc64le.\r\ngo test -c\r\nobjdump -D math.test\r\n\r\nAccording to the golang ABI for ppc64le, r0 is dedicated and should always contain the value zero.  Here are some examples where better code could be generated by taking advantage of that fact.\r\n\r\n### What did you expect to see?\r\nEfficient use of r0\r\n\r\n### What did you see instead?\r\nThe potential for improvement in the following cases:\r\n\r\nIn main.matchString:\r\n  1105c:       b4 07 04 7c     extsw   r4,r0\r\n  11060:       00 18 04 7c     cmpw    r4,r3\r\nNo need to do extsw or move it to another register.  Should be able to just do cmpw r0,r3.\r\n\r\nIn runtime.interhash:\r\n   11844:       b4 07 05 7c     extsw   r5,r0\r\n   11848:       3e 06 a5 54     clrlwi  r5,r5,24\r\n   1184c:       00 20 05 7c     cmpw    r5,r4\r\nAnother example of unnecessary extsw with use of an extra register with an extra clrlwi as well.\r\n\r\nIn runtime.memequal8:\r\n   11b74:       b4 07 04 7c     extsw   r4,r0\r\n   11b78:       30 00 81 98     stb     r4,48(r1)\r\nThis could just be a stb r0,48(r1)\r\n\r\nIn runtime.c64hash:\r\n  1173c:       14 02 83 7c     add     r4,r3,r0\r\n   11740:       20 00 81 f8     std     r4,32(r1)\r\nThe add r4,r3,r0 is just moving the register?  But this could just be std r3,32(r1).\r\n\r\n",
	"user": {
		"login": "laboger",
		"id": 9433228,
		"type": "User",
		"site_admin": false
	},
	"comments": 0,
	"created_at": "2016-09-14T21:00:56Z",
	"updated_at": "2016-09-14T21:05:07Z"
}
