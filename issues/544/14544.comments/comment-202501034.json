{
	"id": 202501034,
	"body": "@ianlancetaylor sure, thanks for having a look at this.\r\n\r\nSeems cgo uses clang which is the default compiler in the freebsd base system and that clang wont find -lgfortran. The $FC command uses /usr/local/bin/gfortran.\r\nPing me if i should try out new patches/commands or generate more debug info. If better access is needed i can setup a freebsd server and user account so you can have a look at it live.\r\n\r\n```\r\n##### ../misc/cgo/fortran\r\nWORK=/tmp/go-build300608776\r\nmkdir -p $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_/usr/home/martisch/go/misc/cgo/\r\nmkdir -p $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/\r\ncd /usr/home/martisch/go/misc/cgo/fortran\r\nCGO_LDFLAGS=\"-g\" \"-O2\" \"-lgfortran\" /home/martisch/go/pkg/tool/freebsd_amd64/cgo -objdir $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/ -importpath _/usr/home/martisch/go/misc/cgo/fortran -- -I $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/ fortran.go\r\ncd $WORK\r\nclang -fdebug-prefix-map=a=b -c trivial.c\r\nclang -gno-record-gcc-switches -c trivial.c\r\ncd /usr/home/martisch/go/misc/cgo/fortran\r\nclang -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -gno-record-gcc-switches -I $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/ -g -O2 -o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/_cgo_main.o -c $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/_cgo_main.c\r\nclang -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -gno-record-gcc-switches -I $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/ -g -O2 -o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/_cgo_export.o -c $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/_cgo_export.c\r\nclang -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -gno-record-gcc-switches -I $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/ -g -O2 -o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/fortran.cgo2.o -c $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/fortran.cgo2.c\r\ngfortran -I . -fPIC -m64 -pthread -fmessage-length=0 -gno-record-gcc-switches -I $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/ -g -O2 -o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/answer.f90.o -c ./answer.f90\r\nclang -I . -fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -gno-record-gcc-switches -o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/_cgo_.o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/_cgo_main.o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/_cgo_export.o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/fortran.cgo2.o $WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/_obj_test/answer.f90.o -g -O2 -lgfortran\r\n# _/usr/home/martisch/go/misc/cgo/fortran\r\n/usr/bin/ld: cannot find -lgfortran\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n$WORK/_/usr/home/martisch/go/misc/cgo/fortran/_test/fortran.test\r\nFAIL\t_/usr/home/martisch/go/misc/cgo/fortran [build failed]\r\nFAIL: go test\r\n2016/03/28 19:06:12 Failed: exit status 1\r\n```\r\n\r\n```\r\ngfortran -print-search-dirs\r\ninstall: /usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/\r\nprograms: =/usr/local/libexec/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/:/usr/local/libexec/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/:/usr/local/libexec/gcc48/gcc/x86_64-portbld-freebsd10.1/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/../../../../../x86_64-portbld-freebsd10.1/bin/x86_64-portbld-freebsd10.1/4.8.5/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/../../../../../x86_64-portbld-freebsd10.1/bin/\r\nlibraries: =/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/../../../../../x86_64-portbld-freebsd10.1/lib/x86_64-portbld-freebsd10.1/4.8.5/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/../../../../../x86_64-portbld-freebsd10.1/lib/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/../../../x86_64-portbld-freebsd10.1/4.8.5/:/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/../../../:/lib/x86_64-portbld-freebsd10.1/4.8.5/:/lib/:/usr/lib/x86_64-portbld-freebsd10.1/4.8.5/:/usr/lib/\r\n\r\ngfortran -print-file-name=libgfortran.so   \r\n/usr/local/lib/gcc48/gcc/x86_64-portbld-freebsd10.1/4.8.5/../../../libgfortran.so\r\n```",
	"user": {
		"login": "martisch",
		"id": 184995,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-03-28T17:38:27Z",
	"updated_at": "2016-03-28T17:40:47Z"
}
