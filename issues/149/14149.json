{
	"id": 129867374,
	"number": 14149,
	"state": "closed",
	"title": "runtime: 1.6rc1: bad pointer in wrote barrier on Linux64",
	"body": "This is from an http server getting stress-tested for data retrieval (300conns, 18h). It has never happened on any previous version of GoLang (same codebase works fine on 1.5.2). \r\n\r\nruntime: writebarrierptr *0x7fea78276540 = 0xc\r\nfatal error: bad pointer in write barrier\r\nruntime: writebarrierptr *0x7feb89f7b460 = 0xc\r\nfatal error: bad pointer in write barrier\r\n\r\nruntime stack:\r\nruntime.throw(0xe447e0, 0x1c)\r\n        /usr/local/go/src/runtime/panic.go:530 +0x90 fp=0x7fea78276420 sp=0x7fea78276408\r\nruntime.writebarrierptr.func1()\r\n        /usr/local/go/src/runtime/mbarrier.go:140 +0xb3 fp=0x7fea78276448 sp=0x7fea78276420\r\nruntime.systemstack(0x7fea78276460)\r\n        /usr/local/go/src/runtime/asm_amd64.s:307 +0xab fp=0x7fea78276450 sp=0x7fea78276448\r\nruntime.writebarrierptr(0x7fea78276540, 0xc)\r\n        /usr/local/go/src/runtime/mbarrier.go:141 +0x97 fp=0x7fea78276480 sp=0x7fea78276450\r\nruntime.mmap.func1()\r\n        /usr/local/go/src/runtime/cgo_mmap.go:21 +0x78 fp=0x7fea782764b8 sp=0x7fea78276480\r\nruntime.systemstack(0x7fea782764e8)\r\n        /usr/local/go/src/runtime/asm_amd64.s:307 +0xab fp=0x7fea782764c0 sp=0x7fea782764b8\r\nruntime.mmap(0x0, 0x40000, 0x2200000003, 0xffffffff, 0xc)\r\n        /usr/local/go/src/runtime/cgo_mmap.go:22 +0x8f fp=0x7fea78276520 sp=0x7fea782764c0\r\nruntime.sysAlloc(0x40000, 0x141a380, 0x7fcc0000003b)\r\n        /usr/local/go/src/runtime/mem_linux.go:58 +0x3b fp=0x7fea78276558 sp=0x7fea78276520\r\nruntime.persistentalloc1(0x800, 0x40, 0x141a378, 0x7fcc0db00100)\r\n        /usr/local/go/src/runtime/malloc.go:932 +0x284 fp=0x7fea78276590 sp=0x7fea78276558\r\nruntime.persistentalloc.func1()\r\n        /usr/local/go/src/runtime/malloc.go:890 +0x3b fp=0x7fea782765c0 sp=0x7fea78276590\r\nruntime.systemstack(0x7fea782765d8)\r\n        /usr/local/go/src/runtime/asm_amd64.s:307 +0xab fp=0x7fea782765c8 sp=0x7fea782765c0\r\nruntime.persistentalloc(0x800, 0x40, 0x141a378, 0x42ce6f)\r\n        /usr/local/go/src/runtime/malloc.go:891 +0x58 fp=0x7fea78276608 sp=0x7fea782765c8\r\nruntime.getempty(0x65, 0x0)\r\n        /usr/local/go/src/runtime/mgcwork.go:347 +0x8c fp=0x7fea78276638 sp=0x7fea78276608\r\nruntime.(*gcWork).init(0xc820016720)\r\n        /usr/local/go/src/runtime/mgcwork.go:97 +0x20 fp=0x7fea78276650 sp=0x7fea78276638\r\nruntime.(*gcWork).put(0xc820016720, 0xc823a390a0)\r\n        /usr/local/go/src/runtime/mgcwork.go:113 +0x38 fp=0x7fea78276670 sp=0x7fea78276650\r\nruntime.greyobject(0xc823a390a0, 0xc83d25c9b0, 0x0, 0xc81fe2e37a, 0xc800000000, 0x7feb9212d258, 0xc820016720)\r\n        /usr/local/go/src/runtime/mgcmark.go:1090 +0x2f1 fp=0x7fea782766f8 sp=0x7fea78276670\r\nruntime.scanblock(0xc83d25c9b0, 0x20, 0xed59a0, 0xc820016720)\r\n        /usr/local/go/src/runtime/mgcmark.go:947 +0x15e fp=0x7fea78276780 sp=0x7fea782766f8\r\nruntime.scanframeworker(0x7fea78276a68, 0x7fea78276b60, 0xc820016720)\r\n        /usr/local/go/src/runtime/mgcmark.go:762 +0x1cc fp=0x7fea78276820 sp=0x7fea78276780\r\nruntime.scanstack.func1(0x7fea78276a68, 0x0, 0x7fea78276801)\r\n        /usr/local/go/src/runtime/mgcmark.go:659 +0x64 fp=0x7fea78276868 sp=0x7fea78276820\r\nruntime.gentraceback(0x432ef3, 0xc83d25c900, 0x0, 0xc82bd2b200, 0x0, 0x0, 0x7fffffff, 0x7fea78276c88, 0x0, 0x0, ...)\r\n        /usr/local/go/src/runtime/traceback.go:369 +0xd95 fp=0x7fea78276ac0 sp=0x7fea78276868\r\nruntime.scanstack(0xc82bd2b200)\r\n        /usr/local/go/src/runtime/mgcmark.go:682 +0x3cc fp=0x7fea78276cd0 sp=0x7fea78276ac0\r\nruntime.scang(0xc82bd2b200)\r\n        /usr/local/go/src/runtime/proc.go:797 +0x96 fp=0x7fea78276cf0 sp=0x7fea78276cd0\r\nruntime.markroot.func1()\r\n        /usr/local/go/src/runtime/mgcmark.go:189 +0xac fp=0x7fea78276d20 sp=0x7fea78276cf0\r\nruntime.systemstack(0x7fea78276da0)\r\n        /usr/local/go/src/runtime/asm_amd64.s:307 +0xab fp=0x7fea78276d28 sp=0x7fea78276d20\r\nruntime.markroot(0x9f9)\r\n        /usr/local/go/src/runtime/mgcmark.go:194 +0x31d fp=0x7fea78276db8 sp=0x7fea78276d28\r\nruntime.gcDrain(0x7fea78276e28, 0x0)\r\n        /usr/local/go/src/runtime/mgcmark.go:812 +0x241 fp=0x7fea78276df0 sp=0x7fea78276db8\r\nruntime.gcMark(0x6fd4ef1a5f09c)\r\n        /usr/local/go/src/runtime/mgc.go:1559 +0xf9 fp=0x7fea78276e50 sp=0x7fea78276df0\r\nruntime.gcMarkTermination.func1()\r\n        /usr/local/go/src/runtime/mgc.go:1173 +0x23 fp=0x7fea78276e60 sp=0x7fea78276e50\r\nruntime.systemstack(0xc820015500)\r\n        /usr/local/go/src/runtime/asm_amd64.s:291 +0x79 fp=0x7fea78276e68 sp=0x7fea78276e60\r\nruntime.mstart()\r\n        /usr/local/go/src/runtime/proc.go:1048 fp=0x7fea78276e70 sp=0x7fea78276e68\r\n\r\ngoroutine 20 [garbage collection]:\r\nruntime.systemstack_switch()\r\n        /usr/local/go/src/runtime/asm_amd64.s:245 fp=0xc820018d48 sp=0xc820018d40\r\nruntime.gcMarkTermination()\r\n        /usr/local/go/src/runtime/mgc.go:1181 +0x136 fp=0xc820018f58 sp=0xc820018d48\r\nruntime.gcStart(0x2, 0xadc400)\r\n        /usr/local/go/src/runtime/mgc.go:1017 +0x399 fp=0xc820018f80 sp=0xc820018f58\r\nruntime/debug.freeOSMemory()\r\n        /usr/local/go/src/runtime/mheap.go:874 +0x25 fp=0xc820018f98 sp=0xc820018f80\r\nruntime/debug.FreeOSMemory()\r\n        /usr/local/go/src/runtime/debug/garbage.go:108 +0x14 fp=0xc820018fa0 sp=0xc820018f98\r\nmain.main.func1(0xc820256000)\r\n        /var/lib/jenkins/workspace/nebula/.build/go/src/git2.co.bitcasa.com/go/nebula.git/cmd/nebula-supervisor/nebula-supervisor.go:92 +0x50 fp=0xc820018fb8 sp=0xc820018fa0\r\nruntime.goexit()\r\n        /usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820018fc0 sp=0xc820018fb8\r\ncreated by main.main\r\n        /var/lib/jenkins/workspace/nebula/.build/go/src/git2.co.bitcasa.com/go/nebula.git/cmd/nebula-supervisor/nebula-supervisor.go:95 +0xf4b\r\n\r\n",
	"user": {
		"login": "snadrus",
		"id": 1920558,
		"type": "User",
		"site_admin": false
	},
	"comments": 6,
	"closed_at": "2016-02-01T20:38:25Z",
	"created_at": "2016-01-29T19:56:45Z",
	"updated_at": "2016-02-01T20:38:25Z",
	"milestone": {
		"id": 1096159,
		"number": 24,
		"title": "Go1.6"
	}
}
