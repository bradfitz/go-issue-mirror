{
	"id": 72801130,
	"body": "This code has not changed betwen g01.4 and tip. What I think is an issue is 5a is miscompiling `MOVM.P.W        [R0,R1],0(R13)` \r\n\r\nCompare the output from `5a` compiling rt0_linux_arm.s\r\n```\r\nanda(~/go/src) % ../../go1.4/pkg/tool/linux_arm/5a -I cmd/ld -S runtime/rt0_linux_arm.s | grep -A5 ^_rt0_arm_linux1                                                      \r\n_rt0_arm_linux1 t=1 nosplit size=16 value=0 args=0xffffffff80000000 locals=0x0 leaf\r\n        0x0000 00000 (runtime/rt0_linux_arm.s:13)       TEXT    _rt0_arm_linux1+0(SB),4,$-4--2147483648\r\n        0x0000 00000 (runtime/rt0_linux_arm.s:24)       MOVM.P.W        [R0,R1],0(R13)\r\n        0x0004 00004 (runtime/rt0_linux_arm.s:45)       MOVW    $20,R7\r\n        0x0008 00008 (runtime/rt0_linux_arm.s:46)       SWI     ,$0\r\n        0x000c 00012 (runtime/rt0_linux_arm.s:56)       B       ,runtime.rt0_go(SB)\r\n```\r\nand tip\r\n```\r\npanda(~/go/src) % ../../go/pkg/tool/linux_arm/5a -I cmd/ld -S runtime/rt0_linux_arm.s | grep -A5 ^_rt0_arm_linux1\r\n_rt0_arm_linux1 t=1 nosplit size=16 value=0 args=0xffffffff80000000 locals=0x0 leaf\r\n        0x0000 00000 (runtime/rt0_linux_arm.s:13)       TEXT    _rt0_arm_linux1+0(SB),4,$-4--2147483648\r\n        0x0000 00000 (runtime/rt0_linux_arm.s:24)       MOVM.P.W        ],0(R13)\r\n        0x0004 00004 (runtime/rt0_linux_arm.s:45)       MOVW    $20,R7\r\n        0x0008 00008 (runtime/rt0_linux_arm.s:46)       SWI     ,$0\r\n        0x000c 00012 (runtime/rt0_linux_arm.s:56)       B       ,runtime.rt0_go(SB)\r\n```\r\ngdb also shows the same for a go1.4 binary\r\n```\r\n(gdb) disassemble/r _rt0_arm_linux1\r\nDump of assembler code for function _rt0_arm_linux1:\r\n   0x000728b8 \u003c+0\u003e:     03 00 2d e9     push    {r0, r1}\r\n   0x000728bc \u003c+4\u003e:     14 70 a0 e3     mov     r7, #20\r\n   0x000728c0 \u003c+8\u003e:     00 00 00 ef     svc     0x00000000\r\n   0x000728c4 \u003c+12\u003e:    04 d0 4d e2     sub     sp, sp, #4\r\n   0x000728c8 \u003c+16\u003e:    52 62 ff eb     bl      0x4b218 \u003cruntime.setup_auxv\u003e\r\n   0x000728cc \u003c+20\u003e:    04 d0 8d e2     add     sp, sp, #4\r\n   0x000728d0 \u003c+24\u003e:    39 f5 ff ea     b       0x6fdbc \u003cruntime.rt0_go\u003e\r\n```\r\nand compiled with tip's 5a\r\n```\r\n(gdb) disassemble /r _rt0_arm_linux1\r\nDump of assembler code for function _rt0_arm_linux1:\r\n   0x000c62dc \u003c+0\u003e:     00 00 2d e9     push    {}      ; \u003cUNPREDICTABLE\u003e\r\n   0x000c62e0 \u003c+4\u003e:     14 70 a0 e3     mov     r7, #20\r\n   0x000c62e4 \u003c+8\u003e:     00 00 00 ef     svc     0x00000000\r\n   0x000c62e8 \u003c+12\u003e:    80 f3 ff ea     b       0xc30f0 \u003cruntime.rt0_go\u003e\r\n```\r\n_note_ the `push` instruction is malformed so `R1` which holds argv is not saved correctly.\r\n\r\nI believe that the other `MOVM` encodings are simliarly affected\r\n",
	"user": {
		"login": "davecheney",
		"id": 7171,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2015-02-04T07:08:19Z",
	"updated_at": "2015-02-04T07:08:19Z"
}
