{
	"id": 66071598,
	"body": "\u003ca id=\"c3\"\u003e\u003c/a\u003eComment 3:\n\n\u003cpre\u003eYeah, it triggers a bug in racewalk.c\n\nThe whole inlined function:\n\nfunc (s *nodeStack) pop() *Node {\n\ti := len(*s)\n\tn := (*s)[i-1]\n\t*s = (*s)[:i-1]\n\treturn n\n}\n\ngoes into Node ninit list, and racewalk inserts all instrumentation after it:\n\n\ti := len(*s)\n\tn := (*s)[i-1]\n\t*s = (*s)[:i-1]\n        ...\n        raceread(\u0026(*s)[i-1])\n\nand that causes OOB.\nBelow is tree dump:\n\n\n.   .   .   AS-init\n.   .   .   .   DCL l(596)\n.   .   .   .   .   NAME-html.n u(1) a(1) g(1381) l(596) x(0+0) class(PAUTO) f(1) ld(1)\ntc(1) used(1) PTR64-*html.Node\n\n.   .   .   .   DCL l(596)\n.   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1) used(1)\nPTR64-*html.nodeStack\n\n.   .   .   .   DCL l(596)\n.   .   .   .   .   NAME-html..anon0 u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.Node\n\n.   .   .   .   DCL l(596)\n.   .   .   .   .   NAME-html.i u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1) used(1)\nint\n\n.   .   .   .   DCL l(596)\n.   .   .   .   .   NAME-html.n u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1) used(1)\nPTR64-*html.Node\n\n.   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1) used(1)\nPTR64-*html.nodeStack\n.   .   .   .   .   ADDR u(2) l(596) esc(no) ld(1) tc(1) implicit(1)\nPTR64-*html.nodeStack\n.   .   .   .   .   .   DOTPTR u(2) l(596) x(72+0) tc(1) html.nodeStack\n.   .   .   .   .   .   .   NAME-html.p u(1) a(1) g(1378) l(563) x(0+0) class(PPARAM)\nf(1) esc(s) ld(1) tc(1) used(1) PTR64-*html.parser\n.   .   .   .   .   .   .   NAME-html.oe u(1) a(1) l(596) x(0+0)\n\n.   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   NAME-html..anon0 u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.Node\n\n.   .   .   .   AS-init\n.   .   .   .   .   DCL l(596)\n.   .   .   .   .   .   NAME-html.i u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) int\n.   .   .   .   AS u(100) l(596) tc(1)\n.   .   .   .   .   NAME-html.i u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1) used(1)\nint\n.   .   .   .   .   LEN u(2) l(596) tc(1) int\n.   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.nodeStack\n\n.   .   .   .   AS-init\n.   .   .   .   .   DCL l(596)\n.   .   .   .   .   .   NAME-html.n u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.Node\n.   .   .   .   AS u(100) l(596) tc(1)\n.   .   .   .   .   NAME-html.n u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1) used(1)\nPTR64-*html.Node\n.   .   .   .   .   INDEX u(3) l(596) tc(1) PTR64-*html.Node\n.   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.nodeStack\n.   .   .   .   .   .   SUB u(2) l(596) tc(1) int\n.   .   .   .   .   .   .   NAME-html.i u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) int\n.   .   .   .   .   .   .   LITERAL-1 u(1) a(1) l(1904) tc(1) int\n\n.   .   .   .   AS-init\n.   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   NAME-html.autotmp_0151 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) int\n.   .   .   .   .   .   SUB u(2) l(596) tc(1) int\n.   .   .   .   .   .   .   NAME-html.i u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) int\n.   .   .   .   .   .   .   LITERAL-1 u(1) a(1) l(1904) tc(1) int\n\n.   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   NAME-html.autotmp_0152 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) uint64\n.   .   .   .   .   .   CONV u(2) l(596) tc(1) uint64\n.   .   .   .   .   .   .   CAP u(2) l(596) tc(1) int\n.   .   .   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO)\nld(1) tc(1) used(1) PTR64-*html.nodeStack\n\n.   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   NAME-html.autotmp_0153 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) uint64\n.   .   .   .   .   .   CONV u(2) l(596) tc(1) uint64\n.   .   .   .   .   .   .   NAME-html.autotmp_0151 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) int\n\n.   .   .   .   .   IF l(596) tc(1)\n.   .   .   .   .   IF-test\n.   .   .   .   .   .   LT u(2) l(596) tc(1) bool\n.   .   .   .   .   .   .   NAME-html.autotmp_0152 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) uint64\n.   .   .   .   .   .   .   NAME-html.autotmp_0153 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) uint64\n.   .   .   .   .   IF-body\n.   .   .   .   .   .   CALLFUNC u(100) l(596) tc(1)\n.   .   .   .   .   .   .   NAME-runtime.panicslice u(1) a(1) g(4) l(2) x(0+0)\nclass(PFUNC) tc(1) used(1) FUNC-funcSTRUCT-()\n.   .   .   .   AS u(100) l(596) tc(1)\n.   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.nodeStack\n.   .   .   .   .   SLICE u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.nodeStack\n.   .   .   .   .   SLICE-list\n.   .   .   .   .   .   NAME-html.autotmp_0152 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) uint64\n\n.   .   .   .   .   .   NAME-html.autotmp_0153 u(1) a(1) l(596) x(0+0) class(PAUTO)\nesc(N) tc(1) used(1) uint64\n\n.   .   .   .   GOTO-init\n.   .   .   .   .   BLOCK u(2) l(596)\n.   .   .   .   .   BLOCK-list\n.   .   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   .   NAME-html..anon0 u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1)\ntc(1) used(1) PTR64-*html.Node\n.   .   .   .   .   .   .   NAME-html.n u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.Node\n.   .   .   .   GOTO l(596) tc(1)\n.   .   .   .   .   NAME-html..inlret000011 u(1) a(1) l(596) x(0+0)\n\n.   .   .   .   GOTO l(596) tc(1)\n.   .   .   .   .   NAME-html..inlret000011 u(1) a(1) l(596) x(0+0)\n\n.   .   .   .   LABEL l(596) tc(1)\n.   .   .   .   .   NAME-html..inlret000011 u(1) a(1) l(596) x(0+0)\n\n//***********************************************************************************//\nRACE DETECTOR STUFF\n\n.   .   .   .   CALLFUNC u(100) l(596) tc(1)\n.   .   .   .   .   NAME-runtime.raceread u(1) a(1) g(301) l(2) x(0+0) class(PFUNC)\ntc(1) used(1) FUNC-funcSTRUCT-(FIELD-uintptr)\n.   .   .   .   CALLFUNC-list\n.   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   INDREG a(1) l(596) x(0+0) tc(1) uintptr\n.   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) uintptr\n.   .   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) E-30-unsafe.Pointer\n.   .   .   .   .   .   .   .   ADDR u(2) l(596) tc(1) PTR64-*html.nodeStack\n.   .   .   .   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO)\nld(1) tc(1) used(1) PTR64-*html.nodeStack\n\n.   .   .   .   CALLFUNC u(100) l(596) tc(1)\n.   .   .   .   .   NAME-runtime.raceread u(1) a(1) g(301) l(2) x(0+0) class(PFUNC)\ntc(1) used(1) FUNC-funcSTRUCT-(FIELD-uintptr)\n.   .   .   .   CALLFUNC-list\n.   .   .   .   .   AS u(3) l(596) tc(1)\n.   .   .   .   .   .   INDREG a(1) l(596) x(0+0) tc(1) uintptr\n.   .   .   .   .   .   CONVNOP u(3) l(596) tc(1) uintptr\n.   .   .   .   .   .   .   CONVNOP u(3) l(596) tc(1) E-30-unsafe.Pointer\n.   .   .   .   .   .   .   .   ADDR u(3) l(596) tc(1) PTR64-*PTR64-*html.Node\n.   .   .   .   .   .   .   .   .   INDEX u(3) l(596) tc(1) PTR64-*html.Node\n.   .   .   .   .   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   .   .   .   .   ...\n.   .   .   .   .   .   .   .   .   .   SUB u(2) l(596) tc(1) int\n.   .   .   .   .   .   .   .   .   .   .   ...\n.   .   .   .   .   .   .   .   .   .   .   ...\n\n.   .   .   .   CALLFUNC u(100) l(596) tc(1)\n.   .   .   .   .   NAME-runtime.raceread u(1) a(1) g(301) l(2) x(0+0) class(PFUNC)\ntc(1) used(1) FUNC-funcSTRUCT-(FIELD-uintptr)\n.   .   .   .   CALLFUNC-list\n.   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   INDREG a(1) l(596) x(0+0) tc(1) uintptr\n.   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) uintptr\n.   .   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) E-30-unsafe.Pointer\n.   .   .   .   .   .   .   .   ADDR u(2) l(596) tc(1) PTR64-*html.nodeStack\n.   .   .   .   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO)\nld(1) tc(1) used(1) PTR64-*html.nodeStack\n\n.   .   .   .   CALLFUNC u(100) l(596) tc(1)\n.   .   .   .   .   NAME-runtime.raceread u(1) a(1) g(301) l(2) x(0+0) class(PFUNC)\ntc(1) used(1) FUNC-funcSTRUCT-(FIELD-uintptr)\n.   .   .   .   CALLFUNC-list\n.   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   INDREG a(1) l(596) x(0+0) tc(1) uintptr\n.   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) uintptr\n.   .   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) E-30-unsafe.Pointer\n.   .   .   .   .   .   .   .   ADDR u(2) l(596) tc(1) PTR64-*html.nodeStack\n.   .   .   .   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO)\nld(1) tc(1) used(1) PTR64-*html.nodeStack\n\n.   .   .   .   CALLFUNC u(100) l(596) tc(1)\n.   .   .   .   .   NAME-runtime.racewrite u(1) a(1) g(302) l(2) x(0+0) class(PFUNC)\ntc(1) used(1) FUNC-funcSTRUCT-(FIELD-uintptr)\n.   .   .   .   CALLFUNC-list\n.   .   .   .   .   AS u(2) l(596) tc(1)\n.   .   .   .   .   .   INDREG a(1) l(596) x(0+0) tc(1) uintptr\n.   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) uintptr\n.   .   .   .   .   .   .   CONVNOP u(2) l(596) tc(1) E-30-unsafe.Pointer\n.   .   .   .   .   .   .   .   ADDR u(2) l(596) tc(1) PTR64-*html.nodeStack\n.   .   .   .   .   .   .   .   .   IND u(2) l(596) tc(1) html.nodeStack\n.   .   .   .   .   .   .   .   .   .   NAME-html.s u(1) a(1) l(596) x(0+0) class(PAUTO)\nld(1) tc(1) used(1) PTR64-*html.nodeStack\n\n//***********************************************************************************//\n\n.   .   .   AS u(100) l(596) tc(1)\n.   .   .   .   NAME-html.n u(1) a(1) g(1381) l(596) x(0+0) class(PAUTO) f(1) ld(1)\ntc(1) used(1) PTR64-*html.Node\n.   .   .   .   CONVNOP u(2) l(596) tc(1) PTR64-*html.Node\n.   .   .   .   .   NAME-html..anon0 u(1) a(1) l(596) x(0+0) class(PAUTO) ld(1) tc(1)\nused(1) PTR64-*html.Node\n\n.   .   .   IF-init\n.   .   .   .   CALLFUNC u(100) l(597) tc(1)\n.   .   .   .   .   NAME-runtime.raceread u(1) a(1) g(301) l(2) x(0+0) class(PFUNC)\ntc(1) used(1) FUNC-funcSTRUCT-(FIELD-uintptr)\n.   .   .   .   CALLFUNC-list\n.   .   .   .   .   AS u(2) l(597) tc(1)\n.   .   .   .   .   .   INDREG a(1) l(597) x(0+0) tc(1) uintptr\n.   .   .   .   .   .   CONVNOP u(2) l(597) tc(1) uintptr\n.   .   .   .   .   .   .   CONVNOP u(2) l(597) tc(1) E-30-unsafe.Pointer\n.   .   .   .   .   .   .   .   ADDR u(2) l(597) tc(1) PTR64-*atom.Atom\n.   .   .   .   .   .   .   .   .   DOTPTR u(2) l(597) x(44+0) tc(1) atom.Atom\n.   .   .   .   .   .   .   .   .   .   NAME-html.n u(1) a(1) g(1381) l(596) x(0+0)\nclass(PAUTO) f(1) ld(1) tc(1) used(1) PTR64-*html.Node\n.   .   .   .   .   .   .   .   .   .   NAME-html.DataAtom u(1) a(1) l(597) x(0+0)\u003c/pre\u003e",
	"user": {
		"login": "dvyukov",
		"id": 1095328,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2012-10-29T15:10:01Z",
	"updated_at": "2014-12-08T10:22:53Z"
}
