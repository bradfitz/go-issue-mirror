{
	"id": 168523773,
	"body": "Here is my go benchmark @davecheney \r\n\r\n```\r\npackage main\r\n\r\nimport (\r\n\t\"math/rand\"\r\n\t\"testing\"\r\n)\r\n\r\ntype Value interface{}\r\n\r\ntype Record struct {\r\n\tintVal int\r\n}\r\n\r\nfunc (r *Record) UpdateValue(val Value) {\r\n\tr.intVal = val.(int)\r\n}\r\n\r\nfunc (r *Record) GetValue() Value {\r\n\treturn r.intVal\r\n}\r\n\r\nfunc (r *Record) UpdateInt(intVal int) {\r\n\tr.intVal = intVal\r\n}\r\n\r\nfunc (r *Record) GetInt() int {\r\n\treturn r.intVal\r\n}\r\n\r\nfunc BenchmarkIfaceRead(b *testing.B) {\r\n\tnkeys := 100\r\n\tb.RunParallel(func(pb *testing.PB) {\r\n\t\tstore := make(map[int]*Record)\r\n\t\trnd := rand.New(rand.NewSource(1))\r\n\t\tfor i := 0; i \u003c nkeys; i++ {\r\n\t\t\tstore[i] = \u0026Record{\r\n\t\t\t\tintVal: i,\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar val Value = nil\r\n\t\tvar intVal int\r\n\t\tfor pb.Next() {\r\n\t\t\tk := rnd.Intn(nkeys)\r\n\t\t\tr := store[k]\r\n\t\t\tval = r.GetValue()\r\n\t\t}\r\n\t\tif val != nil {\r\n\t\t\tintVal = val.(int)\r\n\t\t}\r\n\t\tintVal++\r\n\t})\r\n}\r\n\r\nfunc BenchmarkIfaceWrite(b *testing.B) {\r\n\tnkeys := 100\r\n\tb.RunParallel(func(pb *testing.PB) {\r\n\t\tstore := make(map[int]*Record)\r\n\t\trnd := rand.New(rand.NewSource(1))\r\n\t\tfor i := 0; i \u003c nkeys; i++ {\r\n\t\t\tstore[i] = \u0026Record{\r\n\t\t\t\tintVal: i,\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor pb.Next() {\r\n\t\t\tk := rnd.Intn(nkeys)\r\n\t\t\tr := store[k]\r\n\t\t\tr.UpdateValue(0)\r\n\t\t}\r\n\t})\r\n}\r\n\r\nfunc BenchmarkNoIfaceRead(b *testing.B) {\r\n\tnkeys := 100\r\n\tb.RunParallel(func(pb *testing.PB) {\r\n\t\tstore := make(map[int]*Record)\r\n\t\trnd := rand.New(rand.NewSource(1))\r\n\t\tfor i := 0; i \u003c nkeys; i++ {\r\n\t\t\tstore[i] = \u0026Record{\r\n\t\t\t\tintVal: i,\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar val Value = nil\r\n\t\tvar intVal int\r\n\t\tfor pb.Next() {\r\n\t\t\tk := rnd.Intn(nkeys)\r\n\t\t\tr := store[k]\r\n\t\t\tintVal = r.GetInt()\r\n\t\t}\r\n\t\tif val != nil {\r\n\t\t\tintVal = val.(int)\r\n\t\t}\r\n\t\tintVal++\r\n\t})\r\n}\r\n\r\nfunc BenchmarkNoIfaceWrite(b *testing.B) {\r\n\tnkeys := 100\r\n\tb.RunParallel(func(pb *testing.PB) {\r\n\t\tstore := make(map[int]*Record)\r\n\t\trnd := rand.New(rand.NewSource(1))\r\n\t\tfor i := 0; i \u003c nkeys; i++ {\r\n\t\t\tstore[i] = \u0026Record{\r\n\t\t\t\tintVal: i,\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor pb.Next() {\r\n\t\t\tk := rnd.Intn(nkeys)\r\n\t\t\tr := store[k]\r\n\t\t\tr.UpdateInt(0)\r\n\t\t}\r\n\t})\r\n}\r\n```\r\n\r\nI try the command \"go test -bench=. -cpu=1,32\". The result is:\r\nPASS\r\nBenchmarkIfaceRead      \t10000000\t       177 ns/op\r\nBenchmarkIfaceRead-32   \t50000000\t        31.6 ns/op\r\nBenchmarkIfaceWrite     \t        10000000\t       189 ns/op\r\nBenchmarkIfaceWrite-32  \t100000000\t        30.0 ns/op\r\nBenchmarkNoIfaceRead    \t20000000\t        96.7 ns/op\r\nBenchmarkNoIfaceRead-32 \t500000000\t         3.23 ns/op\r\nBenchmarkNoIfaceWrite   \t20000000\t        97.3 ns/op\r\nBenchmarkNoIfaceWrite-32\t500000000\t         3.13 ns/op\r\nok  \ttest/scale-test\t16.772s",
	"user": {
		"login": "totemtang",
		"id": 4866453,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-01-03T17:59:37Z",
	"updated_at": "2016-01-03T18:00:04Z"
}
