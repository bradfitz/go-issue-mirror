{
	"id": 97529923,
	"number": 11889,
	"state": "closed",
	"title": "x/mobile/cmd/gomobile: build test is flaky on darwin",
	"body": "Occasionally failing with the following on a darwin host:\r\n\r\n```\r\n$ go test golang.org/x/mobile/cmd/gomobile/...\r\n\r\ngo test .\r\n--- FAIL: TestIOSBuild (0.03s)\r\n\tbuild_darwin_test.go:40: unexpected output:\r\n\t\t--- /var/folders/00/1b8h8000h01000cxqpysvccm005d21/T/gofmt539734488\t2015-07-27 11:49:58.000000000 -0700\r\n\t\t+++ /var/folders/00/1b8h8000h01000cxqpysvccm005d21/T/gofmt986936151\t2015-07-27 11:49:58.000000000 -0700\r\n\t\t@@ -1,5 +1,122 @@\r\n\t\t GOMOBILE=/Users/jbd/pkg/gomobile\r\n\t\t WORK=$WORK\r\n\t\t+mkdir -p $WORK/main\r\n\t\t+echo \"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\r\n\t\t+\u003c!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"\u003e\r\n\t\t+\u003cplist version=\"1.0\"\u003e\r\n\t\t+\u003cdict\u003e\r\n\t\t+  \u003ckey\u003eCFBundleDevelopmentRegion\u003c/key\u003e\r\n\t\t+  \u003cstring\u003een\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundleExecutable\u003c/key\u003e\r\n\t\t+  \u003cstring\u003emain\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundleIdentifier\u003c/key\u003e\r\n\t\t+  \u003cstring\u003eorg.golang.todo.$(PRODUCT_NAME:rfc1034identifier)\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundleInfoDictionaryVersion\u003c/key\u003e\r\n\t\t+  \u003cstring\u003e6.0\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundleName\u003c/key\u003e\r\n\t\t+  \u003cstring\u003eBasic\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundlePackageType\u003c/key\u003e\r\n\t\t+  \u003cstring\u003eAPPL\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundleShortVersionString\u003c/key\u003e\r\n\t\t+  \u003cstring\u003e1.0\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundleSignature\u003c/key\u003e\r\n\t\t+  \u003cstring\u003e????\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eCFBundleVersion\u003c/key\u003e\r\n\t\t+  \u003cstring\u003e1\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eLSRequiresIPhoneOS\u003c/key\u003e\r\n\t\t+  \u003ctrue/\u003e\r\n\t\t+  \u003ckey\u003eUILaunchStoryboardName\u003c/key\u003e\r\n\t\t+  \u003cstring\u003eLaunchScreen\u003c/string\u003e\r\n\t\t+  \u003ckey\u003eUIRequiredDeviceCapabilities\u003c/key\u003e\r\n\t\t+  \u003carray\u003e\r\n\t\t+    \u003cstring\u003earmv7\u003c/string\u003e\r\n\t\t+  \u003c/array\u003e\r\n\t\t+  \u003ckey\u003eUISupportedInterfaceOrientations\u003c/key\u003e\r\n\t\t+  \u003carray\u003e\r\n\t\t+    \u003cstring\u003eUIInterfaceOrientationPortrait\u003c/string\u003e\r\n\t\t+    \u003cstring\u003eUIInterfaceOrientationLandscapeLeft\u003c/string\u003e\r\n\t\t+    \u003cstring\u003eUIInterfaceOrientationLandscapeRight\u003c/string\u003e\r\n\t\t+  \u003c/array\u003e\r\n\t\t+  \u003ckey\u003eUISupportedInterfaceOrientations~ipad\u003c/key\u003e\r\n\t\t+  \u003carray\u003e\r\n\t\t+    \u003cstring\u003eUIInterfaceOrientationPortrait\u003c/string\u003e\r\n\t\t+    \u003cstring\u003eUIInterfaceOrientationPortraitUpsideDown\u003c/string\u003e\r\n\t\t+    \u003cstring\u003eUIInterfaceOrientationLandscapeLeft\u003c/string\u003e\r\n\t\t+    \u003cstring\u003eUIInterfaceOrientationLandscapeRight\u003c/string\u003e\r\n\t\t+  \u003c/array\u003e\r\n\t\t+\u003c/dict\u003e\r\n\t\t+\u003c/plist\u003e\r\n\t\t+\" \u003e $WORK/main/Info.plist\r\n\t\t+mkdir -p $WORK/main/Images.xcassets/AppIcon.appiconset\r\n\t\t+echo \"{\r\n\t\t+  \"images\" : [\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"iphone\",\r\n\t\t+      \"size\" : \"29x29\",\r\n\t\t+      \"scale\" : \"2x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"iphone\",\r\n\t\t+      \"size\" : \"29x29\",\r\n\t\t+      \"scale\" : \"3x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"iphone\",\r\n\t\t+      \"size\" : \"40x40\",\r\n\t\t+      \"scale\" : \"2x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"iphone\",\r\n\t\t+      \"size\" : \"40x40\",\r\n\t\t+      \"scale\" : \"3x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"iphone\",\r\n\t\t+      \"size\" : \"60x60\",\r\n\t\t+      \"scale\" : \"2x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"iphone\",\r\n\t\t+      \"size\" : \"60x60\",\r\n\t\t+      \"scale\" : \"3x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"ipad\",\r\n\t\t+      \"size\" : \"29x29\",\r\n\t\t+      \"scale\" : \"1x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"ipad\",\r\n\t\t+      \"size\" : \"29x29\",\r\n\t\t+      \"scale\" : \"2x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"ipad\",\r\n\t\t+      \"size\" : \"40x40\",\r\n\t\t+      \"scale\" : \"1x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"ipad\",\r\n\t\t+      \"size\" : \"40x40\",\r\n\t\t+      \"scale\" : \"2x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"ipad\",\r\n\t\t+      \"size\" : \"76x76\",\r\n\t\t+      \"scale\" : \"1x\"\r\n\t\t+    },\r\n\t\t+    {\r\n\t\t+      \"idiom\" : \"ipad\",\r\n\t\t+      \"size\" : \"76x76\",\r\n\t\t+      \"scale\" : \"2x\"\r\n\t\t+    }\r\n\t\t+  ],\r\n\t\t+  \"info\" : {\r\n\t\t+    \"version\" : 1,\r\n\t\t+    \"author\" : \"xcode\"\r\n\t\t+  }\r\n\t\t+}\r\n\t\t+\" \u003e $WORK/main/Images.xcassets/AppIcon.appiconset/Contents.json\r\n\t\t mkdir -p $WORK/main.xcodeproj\r\n\t\t echo \"// !$*UTF8*$!\r\n\t\t {\r\n\t\t@@ -252,123 +369,6 @@\r\n\t\t   rootObject = 254BB8361B1FD08900C56DE9 /* Project object */;\r\n\t\t }\r\n\t\t \" \u003e $WORK/main.xcodeproj/project.pbxproj\r\n\t\t-mkdir -p $WORK/main\r\n\t\t-echo \"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\r\n\t\t-\u003c!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"\u003e\r\n\t\t-\u003cplist version=\"1.0\"\u003e\r\n\t\t-\u003cdict\u003e\r\n\t\t-  \u003ckey\u003eCFBundleDevelopmentRegion\u003c/key\u003e\r\n\t\t-  \u003cstring\u003een\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundleExecutable\u003c/key\u003e\r\n\t\t-  \u003cstring\u003emain\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundleIdentifier\u003c/key\u003e\r\n\t\t-  \u003cstring\u003eorg.golang.todo.$(PRODUCT_NAME:rfc1034identifier)\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundleInfoDictionaryVersion\u003c/key\u003e\r\n\t\t-  \u003cstring\u003e6.0\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundleName\u003c/key\u003e\r\n\t\t-  \u003cstring\u003eBasic\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundlePackageType\u003c/key\u003e\r\n\t\t-  \u003cstring\u003eAPPL\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundleShortVersionString\u003c/key\u003e\r\n\t\t-  \u003cstring\u003e1.0\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundleSignature\u003c/key\u003e\r\n\t\t-  \u003cstring\u003e????\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eCFBundleVersion\u003c/key\u003e\r\n\t\t-  \u003cstring\u003e1\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eLSRequiresIPhoneOS\u003c/key\u003e\r\n\t\t-  \u003ctrue/\u003e\r\n\t\t-  \u003ckey\u003eUILaunchStoryboardName\u003c/key\u003e\r\n\t\t-  \u003cstring\u003eLaunchScreen\u003c/string\u003e\r\n\t\t-  \u003ckey\u003eUIRequiredDeviceCapabilities\u003c/key\u003e\r\n\t\t-  \u003carray\u003e\r\n\t\t-    \u003cstring\u003earmv7\u003c/string\u003e\r\n\t\t-  \u003c/array\u003e\r\n\t\t-  \u003ckey\u003eUISupportedInterfaceOrientations\u003c/key\u003e\r\n\t\t-  \u003carray\u003e\r\n\t\t-    \u003cstring\u003eUIInterfaceOrientationPortrait\u003c/string\u003e\r\n\t\t-    \u003cstring\u003eUIInterfaceOrientationLandscapeLeft\u003c/string\u003e\r\n\t\t-    \u003cstring\u003eUIInterfaceOrientationLandscapeRight\u003c/string\u003e\r\n\t\t-  \u003c/array\u003e\r\n\t\t-  \u003ckey\u003eUISupportedInterfaceOrientations~ipad\u003c/key\u003e\r\n\t\t-  \u003carray\u003e\r\n\t\t-    \u003cstring\u003eUIInterfaceOrientationPortrait\u003c/string\u003e\r\n\t\t-    \u003cstring\u003eUIInterfaceOrientationPortraitUpsideDown\u003c/string\u003e\r\n\t\t-    \u003cstring\u003eUIInterfaceOrientationLandscapeLeft\u003c/string\u003e\r\n\t\t-    \u003cstring\u003eUIInterfaceOrientationLandscapeRight\u003c/string\u003e\r\n\t\t-  \u003c/array\u003e\r\n\t\t-\u003c/dict\u003e\r\n\t\t-\u003c/plist\u003e\r\n\t\t-\" \u003e $WORK/main/Info.plist\r\n\t\t-mkdir -p $WORK/main/Images.xcassets/AppIcon.appiconset\r\n\t\t-echo \"{\r\n\t\t-  \"images\" : [\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"iphone\",\r\n\t\t-      \"size\" : \"29x29\",\r\n\t\t-      \"scale\" : \"2x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"iphone\",\r\n\t\t-      \"size\" : \"29x29\",\r\n\t\t-      \"scale\" : \"3x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"iphone\",\r\n\t\t-      \"size\" : \"40x40\",\r\n\t\t-      \"scale\" : \"2x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"iphone\",\r\n\t\t-      \"size\" : \"40x40\",\r\n\t\t-      \"scale\" : \"3x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"iphone\",\r\n\t\t-      \"size\" : \"60x60\",\r\n\t\t-      \"scale\" : \"2x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"iphone\",\r\n\t\t-      \"size\" : \"60x60\",\r\n\t\t-      \"scale\" : \"3x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"ipad\",\r\n\t\t-      \"size\" : \"29x29\",\r\n\t\t-      \"scale\" : \"1x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"ipad\",\r\n\t\t-      \"size\" : \"29x29\",\r\n\t\t-      \"scale\" : \"2x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"ipad\",\r\n\t\t-      \"size\" : \"40x40\",\r\n\t\t-      \"scale\" : \"1x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"ipad\",\r\n\t\t-      \"size\" : \"40x40\",\r\n\t\t-      \"scale\" : \"2x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"ipad\",\r\n\t\t-      \"size\" : \"76x76\",\r\n\t\t-      \"scale\" : \"1x\"\r\n\t\t-    },\r\n\t\t-    {\r\n\t\t-      \"idiom\" : \"ipad\",\r\n\t\t-      \"size\" : \"76x76\",\r\n\t\t-      \"scale\" : \"2x\"\r\n\t\t-    }\r\n\t\t-  ],\r\n\t\t-  \"info\" : {\r\n\t\t-    \"version\" : 1,\r\n\t\t-    \"author\" : \"xcode\"\r\n\t\t-  }\r\n\t\t-}\r\n\t\t-\" \u003e $WORK/main/Images.xcassets/AppIcon.appiconset/Contents.json\r\n\t\t GOOS=darwin GOARCH=arm GOARM=7 CC=clang-iphoneos CXX=clang-iphoneos CGO_CFLAGS=-isysroot=iphoneos -arch armv7 CGO_LDFLAGS=-isysroot=iphoneos -arch armv7 CGO_ENABLED=1 go build -p=8 -pkgdir=$GOMOBILE/pkg_darwin_arm -tags=\"\" -x -tags=ios -o=$WORK/arm golang.org/x/mobile/example/basic\r\n\t\t GOOS=darwin GOARCH=arm64 CC=clang-iphoneos CXX=clang-iphoneos CGO_CFLAGS=-isysroot=iphoneos -arch arm64 CGO_LDFLAGS=-isysroot=iphoneos -arch arm64 CGO_ENABLED=1 go build -p=8 -pkgdir=$GOMOBILE/pkg_darwin_arm64 -tags=\"\" -x -tags=ios -o=$WORK/arm64 golang.org/x/mobile/example/basic\r\n\t\t xcrun lipo -create $WORK/arm $WORK/arm64 -o $WORK/main/main\r\n```",
	"user": {
		"login": "rakyll",
		"id": 108380,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"assignee": {
		"login": "crawshaw",
		"id": 161319,
		"type": "User",
		"site_admin": false
	},
	"comments": 2,
	"closed_at": "2015-07-27T20:15:57Z",
	"created_at": "2015-07-27T18:52:09Z",
	"updated_at": "2016-08-05T16:11:23Z",
	"milestone": {
		"id": 1067491,
		"number": 22,
		"title": "Unreleased"
	}
}
