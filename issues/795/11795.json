{
	"id": 95965137,
	"number": 11795,
	"state": "closed",
	"title": "runtime: SIGILL during compilation",
	"body": "```text\r\n$ go version\r\ngo version go1.5beta2 linux/amd64\r\n$ uname -a\r\nLinux flynn 3.19.0-22-generic #22~14.04.1-Ubuntu SMP Wed Jun 17 10:03:13 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\nWhile running `go test`:\r\n\r\n```text\r\nWORK=/tmp/go-build680090135\r\nmkdir -p $WORK/github.com/flynn/flynn/router/proxy/_test/github.com/flynn/flynn/router/\r\nmkdir -p $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305/_obj/\r\nmkdir -p $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/\r\nmkdir -p $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa/_obj/\r\nmkdir -p $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/\r\ncd /home/vagrant/go/src/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa\r\n/vagrant/util/_toolchain/go/pkg/tool/linux_amd64/compile -o $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa.a -trimpath $WORK -p github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa -buildid c13f10f0f394750003bd4f6eda2844332ffe73c9 -D _/home/vagrant/go/src/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa -I $WORK -pack -asmhdr $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa/_obj/go_asm.h ./hsalsa20.go ./salsa208.go ./salsa20_amd64.go\r\ncd /home/vagrant/go/src/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305\r\n/vagrant/util/_toolchain/go/pkg/tool/linux_amd64/compile -o $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305.a -trimpath $WORK -p github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305 -buildid 98ac4b17e9c7615cd4e12c8d41cf91187390c708 -D _/home/vagrant/go/src/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305 -I $WORK -pack -asmhdr $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305/_obj/go_asm.h ./poly1305.go ./sum_amd64.go\r\n/vagrant/util/_toolchain/go/pkg/tool/linux_amd64/asm -o $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305/_obj/const_amd64.o -trimpath $WORK -I $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305/_obj/ -I /vagrant/util/_toolchain/go/pkg/include -D GOOS_linux -D GOARCH_amd64 ./const_amd64.s\r\ncd /home/vagrant/go/src/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa\r\n/vagrant/util/_toolchain/go/pkg/tool/linux_amd64/asm -o $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa/_obj/salsa2020_amd64.o -trimpath $WORK -I $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa/_obj/ -I /vagrant/util/_toolchain/go/pkg/include -D GOOS_linux -D GOARCH_amd64 ./salsa2020_amd64.s\r\ncd /home/vagrant/go/src/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305\r\n/vagrant/util/_toolchain/go/pkg/tool/linux_amd64/old6a -o $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305/_obj/const_amd64.o.new -trimpath $WORK -I $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305/_obj/ -I /vagrant/util/_toolchain/go/pkg/include -D GOOS_linux -D GOARCH_amd64 ./const_amd64.s\r\ncd /home/vagrant/go/src/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa\r\n/vagrant/util/_toolchain/go/pkg/tool/linux_amd64/old6a -o $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa/_obj/salsa2020_amd64.o.new -trimpath $WORK -I $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa/_obj/ -I /vagrant/util/_toolchain/go/pkg/include -D GOOS_linux -D GOARCH_amd64 ./salsa2020_amd64.s\r\npack r $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa.a $WORK/github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/salsa20/salsa/_obj/salsa2020_amd64.o # internal\r\n# github.com/flynn/flynn/Godeps/_workspace/src/golang.org/x/crypto/poly1305\r\nSIGILL: illegal instruction\r\nPC=0x5117f0 m=0\r\n\r\ngoroutine 1 [running, locked to thread]:\r\nsyscall.init()\r\n\t/usr/local/go/src/syscall/ztypes_linux_amd64.go:712 fp=0xc820045e48 sp=0xc820045e40\r\nos.init()\r\n\t/usr/local/go/src/os/types_notwin.go:25 +0x4c fp=0xc820045e90 sp=0xc820045e48\r\nfmt.init()\r\n\t/usr/local/go/src/fmt/scan.go:1191 +0x56 fp=0xc820045ef0 sp=0xc820045e90\r\nflag.init()\r\n\t/usr/local/go/src/flag/flag.go:957 +0x47 fp=0xc820045f18 sp=0xc820045ef0\r\ncmd/internal/asm.init()\r\n\t/usr/local/go/src/cmd/internal/asm/macbody.go:855 +0x47 fp=0xc820045f48 sp=0xc820045f18\r\nmain.init()\r\n\ta.y:732 +0x3b fp=0xc820045f50 sp=0xc820045f48\r\nruntime.main()\r\n\t/usr/local/go/src/runtime/proc.go:100 +0x28e fp=0xc820045fa0 sp=0xc820045f50\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1696 +0x1 fp=0xc820045fa8 sp=0xc820045fa0\r\n\r\ngoroutine 2 [force gc (idle)]:\r\nruntime.gopark(0x5c7248, 0x6623d0, 0x58c760, 0xf, 0x14, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:185 +0x169 fp=0xc82002e758 sp=0xc82002e730\r\nruntime.goparkunlock(0x6623d0, 0x58c760, 0xf, 0xc820000114, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:191 +0x54 fp=0xc82002e790 sp=0xc82002e758\r\nruntime.forcegchelper()\r\n\t/usr/local/go/src/runtime/proc.go:152 +0xb8 fp=0xc82002e7c0 sp=0xc82002e790\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1696 +0x1 fp=0xc82002e7c8 sp=0xc82002e7c0\r\ncreated by runtime.init.4\r\n\t/usr/local/go/src/runtime/proc.go:141 +0x2b\r\n\r\ngoroutine 3 [GC sweep wait]:\r\nruntime.gopark(0x5c7248, 0x662580, 0x589e20, 0xd, 0x426014, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:185 +0x169 fp=0xc82002ef48 sp=0xc82002ef20\r\nruntime.goparkunlock(0x662580, 0x589e20, 0xd, 0x14, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:191 +0x54 fp=0xc82002ef80 sp=0xc82002ef48\r\nruntime.bgsweep(0xc820018070)\r\n\t/usr/local/go/src/runtime/mgcsweep.go:51 +0xb1 fp=0xc82002efb8 sp=0xc82002ef80\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1696 +0x1 fp=0xc82002efc0 sp=0xc82002efb8\r\ncreated by runtime.gcenable\r\n\t/usr/local/go/src/runtime/mgc.go:200 +0x53\r\n\r\nrax    0x7f8a6cfcb028\r\nrbx    0x2\r\nrcx    0xc820000180\r\nrdx    0x17f0\r\nrdi    0x4523f0\r\nrsi    0x10\r\nrbp    0x0\r\nrsp    0xc820045e40\r\nr8     0x46771\r\nr9     0x591530\r\nr10    0x556b20\r\nr11    0x286\r\nr12    0x10\r\nr13    0x5c6c76\r\nr14    0x8\r\nr15    0x0\r\nrip    0x5117f0\r\nrflags 0x10202\r\ncs     0x33\r\nfs     0x0\r\ngs     0x0\r\n\r\n-----\r\n\r\nSIGQUIT: quit\r\nPC=0x460303 m=1\r\n\r\ngoroutine 0 [idle]:\r\nruntime.futex(0x6628e0, 0x0, 0xc820043ea0, 0x0, 0x0, 0x46015c, 0x3c, 0x0, 0x417494, 0x6628e0, ...)\r\n\t/usr/local/go/src/runtime/sys_linux_amd64.s:289 +0x23 fp=0xc820043e70 sp=0xc820043e68\r\nruntime.futexsleep(0x6628e0, 0x0, 0xdf8475800)\r\n\t/usr/local/go/src/runtime/os1_linux.go:56 +0xf0 fp=0xc820043eb8 sp=0xc820043e70\r\nruntime.notetsleep_internal(0x6628e0, 0xdf8475800, 0xc820000480)\r\n\t/usr/local/go/src/runtime/lock_futex.go:167 +0x134 fp=0xc820043ee8 sp=0xc820043eb8\r\nruntime.notetsleep(0x6628e0, 0xdf8475800, 0x0)\r\n\t/usr/local/go/src/runtime/lock_futex.go:187 +0x71 fp=0xc820043f08 sp=0xc820043ee8\r\nruntime.sysmon()\r\n\t/usr/local/go/src/runtime/proc1.go:2971 +0x4aa fp=0xc820043f90 sp=0xc820043f08\r\nruntime.mstart1()\r\n\t/usr/local/go/src/runtime/proc1.go:715 +0xf7 fp=0xc820043fb0 sp=0xc820043f90\r\nruntime.mstart()\r\n\t/usr/local/go/src/runtime/proc1.go:685 +0x72 fp=0xc820043fc0 sp=0xc820043fb0\r\nrax    0xfffffffffffffffc\r\nrbx    0xc820043ea0\r\nrcx    0xffffffffffffffff\r\nrdx    0x0\r\nrdi    0x6628e0\r\nrsi    0x0\r\nrbp    0x0\r\nrsp    0xc820043e68\r\nr8     0x0\r\nr9     0x0\r\nr10    0xc820043ea0\r\nr11    0x246\r\nr12    0x4361a0\r\nr13    0x5c6d78\r\nr14    0x8\r\nr15    0x0\r\nrip    0x460303\r\nrflags 0x246\r\ncs     0x33\r\nfs     0x0\r\ngs     0x0\r\n\r\n-----\r\n\r\nSIGQUIT: quit\r\nPC=0x460301 m=2\r\n\r\ngoroutine 0 [idle]:\r\nruntime.futex(0xc820034588, 0x0, 0x0, 0x0, 0x0, 0x662820, 0x0, 0x0, 0x41731a, 0xc820034588, ...)\r\n\t/usr/local/go/src/runtime/sys_linux_amd64.s:288 +0x21 fp=0xc82003fe10 sp=0xc82003fe08\r\nruntime.futexsleep(0xc820034588, 0x0, 0xffffffffffffffff)\r\n\t/usr/local/go/src/runtime/os1_linux.go:39 +0x53 fp=0xc82003fe58 sp=0xc82003fe10\r\nruntime.notesleep(0xc820034588)\r\n\t/usr/local/go/src/runtime/lock_futex.go:142 +0xaa fp=0xc82003fe80 sp=0xc82003fe58\r\nruntime.stopm()\r\n\t/usr/local/go/src/runtime/proc1.go:1122 +0x124 fp=0xc82003fea8 sp=0xc82003fe80\r\nruntime.findrunnable(0xc820023500, 0x0)\r\n\t/usr/local/go/src/runtime/proc1.go:1508 +0x6bf fp=0xc82003ff28 sp=0xc82003fea8\r\nruntime.schedule()\r\n\t/usr/local/go/src/runtime/proc1.go:1617 +0x282 fp=0xc82003ff60 sp=0xc82003ff28\r\nruntime.park_m(0xc820000600)\r\n\t/usr/local/go/src/runtime/proc1.go:1676 +0x1ac fp=0xc82003ff88 sp=0xc82003ff60\r\nruntime.mcall(0x0)\r\n\t/usr/local/go/src/runtime/asm_amd64.s:204 +0x5e fp=0xc82003ff98 sp=0xc82003ff88\r\nrax    0xca\r\nrbx    0x0\r\nrcx    0xffffffffffffffff\r\nrdx    0x0\r\nrdi    0xc820034588\r\nrsi    0x0\r\nrbp    0x1\r\nrsp    0xc82003fe08\r\nr8     0x0\r\nr9     0x0\r\nr10    0x0\r\nr11    0x286\r\nr12    0x4361a0\r\nr13    0x5c6d78\r\nr14    0x8\r\nr15    0x0\r\nrip    0x460301\r\nrflags 0x286\r\ncs     0x33\r\nfs     0x0\r\ngs     0x0\r\n\r\n-----\r\n\r\nSIGQUIT: quit\r\nPC=0x460301 m=3\r\n\r\ngoroutine 0 [idle]:\r\nruntime.futex(0xc820034a08, 0x0, 0x0, 0x0, 0x0, 0x662820, 0x0, 0x0, 0x41731a, 0xc820034a08, ...)\r\n\t/usr/local/go/src/runtime/sys_linux_amd64.s:288 +0x21 fp=0xc820041e70 sp=0xc820041e68\r\nruntime.futexsleep(0xc820034a08, 0x0, 0xffffffffffffffff)\r\n\t/usr/local/go/src/runtime/os1_linux.go:39 +0x53 fp=0xc820041eb8 sp=0xc820041e70\r\nruntime.notesleep(0xc820034a08)\r\n\t/usr/local/go/src/runtime/lock_futex.go:142 +0xaa fp=0xc820041ee0 sp=0xc820041eb8\r\nruntime.stopm()\r\n\t/usr/local/go/src/runtime/proc1.go:1122 +0x124 fp=0xc820041f08 sp=0xc820041ee0\r\nruntime.startlockedm(0xc820000180)\r\n\t/usr/local/go/src/runtime/proc1.go:1292 +0xca fp=0xc820041f28 sp=0xc820041f08\r\nruntime.schedule()\r\n\t/usr/local/go/src/runtime/proc1.go:1624 +0x2b5 fp=0xc820041f60 sp=0xc820041f28\r\nruntime.park_m(0xc820000d80)\r\n\t/usr/local/go/src/runtime/proc1.go:1676 +0x1ac fp=0xc820041f88 sp=0xc820041f60\r\nruntime.mcall(0x0)\r\n\t/usr/local/go/src/runtime/asm_amd64.s:204 +0x5e fp=0xc820041f98 sp=0xc820041f88\r\nrax    0xca\r\nrbx    0x0\r\nrcx    0xffffffffffffffff\r\nrdx    0x0\r\nrdi    0xc820034a08\r\nrsi    0x0\r\nrbp    0x1\r\nrsp    0xc820041e68\r\nr8     0x0\r\nr9     0x0\r\nr10    0x0\r\nr11    0x286\r\nr12    0x4361a0\r\nr13    0x5c6d78\r\nr14    0x8\r\nr15    0x0\r\nrip    0x460301\r\nrflags 0x286\r\ncs     0x33\r\nfs     0x0\r\ngs     0x0\r\n\r\n-----\r\n\r\nSIGQUIT: quit\r\nPC=0x460301 m=4\r\n\r\ngoroutine 0 [idle]:\r\nruntime.futex(0xc82005e108, 0x0, 0x0, 0x0, 0x0, 0x662820, 0x0, 0x0, 0x41731a, 0xc82005e108, ...)\r\n\t/usr/local/go/src/runtime/sys_linux_amd64.s:288 +0x21 fp=0xc82006fe40 sp=0xc82006fe38\r\nruntime.futexsleep(0xc82005e108, 0x0, 0xffffffffffffffff)\r\n\t/usr/local/go/src/runtime/os1_linux.go:39 +0x53 fp=0xc82006fe88 sp=0xc82006fe40\r\nruntime.notesleep(0xc82005e108)\r\n\t/usr/local/go/src/runtime/lock_futex.go:142 +0xaa fp=0xc82006feb0 sp=0xc82006fe88\r\nruntime.stopm()\r\n\t/usr/local/go/src/runtime/proc1.go:1122 +0x124 fp=0xc82006fed8 sp=0xc82006feb0\r\nruntime.findrunnable(0xc820024a00, 0x0)\r\n\t/usr/local/go/src/runtime/proc1.go:1508 +0x6bf fp=0xc82006ff58 sp=0xc82006fed8\r\nruntime.schedule()\r\n\t/usr/local/go/src/runtime/proc1.go:1617 +0x282 fp=0xc82006ff90 sp=0xc82006ff58\r\nruntime.mstart1()\r\n\t/usr/local/go/src/runtime/proc1.go:725 +0x129 fp=0xc82006ffb0 sp=0xc82006ff90\r\nruntime.mstart()\r\n\t/usr/local/go/src/runtime/proc1.go:685 +0x72 fp=0xc82006ffc0 sp=0xc82006ffb0\r\nrax    0xca\r\nrbx    0x0\r\nrcx    0xffffffffffffffff\r\nrdx    0x0\r\nrdi    0xc82005e108\r\nrsi    0x0\r\nrbp    0x1\r\nrsp    0xc82006fe38\r\nr8     0x0\r\nr9     0x0\r\nr10    0x0\r\nr11    0x286\r\nr12    0x4361a0\r\nr13    0x5c6d78\r\nr14    0x8\r\nr15    0x0\r\nrip    0x460301\r\nrflags 0x286\r\ncs     0x33\r\nfs     0x0\r\ngs     0x0\r\n$WORK/github.com/flynn/flynn/router/proxy/_test/proxy.test -test.run=xxxxx\r\nFAIL\tgithub.com/flynn/flynn/router/proxy [build failed]\r\n```\r\n\r\nCore dump: https://s3.amazonaws.com/flynn-temp/sigill_core.gz\r\n\r\nThis happens rarely (less than 1 in 1000 builds).",
	"user": {
		"login": "titanous",
		"id": 13026,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 4,
	"closed_at": "2015-07-21T01:35:18Z",
	"created_at": "2015-07-20T01:18:39Z",
	"updated_at": "2016-07-20T14:27:38Z",
	"milestone": {
		"id": 905105,
		"number": 1,
		"title": "Go1.5"
	}
}
