{
	"id": 137942913,
	"number": 14599,
	"state": "closed",
	"title": "runtime: panic: \"fatal error: malloc deadlock\" with CPU profile",
	"body": "\u003e What version of Go are you using (`go version`)?\r\n\r\ngo version go1.6 linux/amd64\r\n\r\n\u003e What operating system and processor architecture are you using (`go env`)?\r\n\r\nUbuntu 15.10 Wily\r\n\r\nLinux 4.2.0-23-generic #28-Ubuntu SMP Sun Dec 27 17:47:31 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n\u003e What did you do?\r\n\r\nI'm getting \"panic: fatal error: malloc deadlock\" quite reproducibly in\r\nmy program: https://github.com/ncw/go-nflog-acctd when compiled with go\r\n1.6 and run with cpu profiling.\r\n\r\nThe code runs clean with the race detector enabled.\r\n\r\nThe panic only seems to happen when cpu profiling is enabled so I'd\r\nguess it is something to do with that.\r\n\r\nTo reproduce on a Linux amd64 based system\r\n\r\n```\r\nsudo apt-get install libnetfilter-log-dev\r\ngo get github.com/ncw/go-nflog-acctd\r\ncd $GOPATH/github.com/ncw/go-nflog-acctd\r\nsudo start-iptables-accounting-nflog\r\nsudo go-nflog-acctd  -interval 10s -ip4-dst-group=4 -ip4-src-group=5\r\n-ip6-dst-group=6 -ip6-src-group=7 -cpuprofile z.prof\r\n```\r\n\r\nIn another window run\r\n\r\n```\r\nsudo sudo hping3 127.0.0.2 --syn -p 80 -s 53 --flood\r\n```\r\n\r\nThis usually produces a stack trace within a minute or two.\r\n\r\nI haven't made it go wrong without the `-cpuprofile z.prof` flag.\r\n\r\n\u003e What did you expect to see?\r\n\r\nNo traceback\r\n\r\n\u003e What did you see instead?\r\n\r\nThis traceback\r\n\r\n```\r\npanic: fatal error: malloc deadlock\r\n\r\ngoroutine 0 [idle]:\r\npanic(0x58a9a0, 0xc8200100d0)\r\n\t/usr/local/go/src/runtime/panic.go:355 +0x7a\r\n\r\ngoroutine 8 [syscall, locked to thread]:\r\nruntime.cgocall(0x536610, 0xc8200f9ea0, 0x0)\r\n\t/usr/local/go/src/runtime/cgocall.go:123 +0x11b fp=0xc8200f9e50\r\nsp=0xc8200f9e20\r\nmain._Cfunc_nflog_handle_packet(0x222db50, 0x7f1d000008c0, 0x1dc4, 0x0)\r\n\t??:0 +0x41 fp=0xc8200f9ea0 sp=0xc8200f9e50\r\nmain.(*NfLog).Loop(0xc820016140)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:357 +0x386\r\nfp=0xc8200f9fa8 sp=0xc8200f9ea0\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200f9fb0\r\nsp=0xc8200f9fa8\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 1 [chan receive]:\r\nmain.main()\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:399 +0xf1a\r\n\r\ngoroutine 17 [syscall, locked to thread]:\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1\r\n\r\ngoroutine 5 [syscall]:\r\nos/signal.signal_recv(0x0)\r\n\t/usr/local/go/src/runtime/sigqueue.go:116 +0x132\r\nos/signal.loop()\r\n\t/usr/local/go/src/os/signal/signal_unix.go:22 +0x18\r\ncreated by os/signal.init.1\r\n\t/usr/local/go/src/os/signal/signal_unix.go:28 +0x37\r\n\r\ngoroutine 6 [syscall]:\r\nruntime.CPUProfile(0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/cpuprof.go:421 +0x34\r\nruntime/pprof.profileWriter(0x7f1d21ddb308, 0xc820028030)\r\n\t/usr/local/go/src/runtime/pprof/pprof.go:607 +0x1c\r\ncreated by runtime/pprof.StartCPUProfile\r\n\t/usr/local/go/src/runtime/pprof/pprof.go:601 +0x145\r\n\r\ngoroutine 7 [runnable, locked to thread]:\r\nmain._C2func_recv(0x4, 0x7f1d080008c0, 0x400000, 0x0, 0x1144, 0x0, 0x0)\r\n\t??:0 +0x56\r\nmain.(*NfLog).Loop(0xc8200160a0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 9 [syscall, locked to thread]:\r\nmain._C2func_recv(0x6, 0x7f1d1db54010, 0x400000, 0x0, 0x0, 0x0, 0x0)\r\n\t??:0 +0x56\r\nmain.(*NfLog).Loop(0xc8200161e0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 10 [syscall, locked to thread]:\r\nmain._C2func_recv(0x7, 0x7f1d1c751010, 0x400000, 0x0, 0x0, 0x0, 0x0)\r\n\t??:0 +0x56\r\nmain.(*NfLog).Loop(0xc820016280)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 11 [runnable]:\r\nmain.(*Accounting).Engine(0xc82000a1b0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:190 +0x3fa\r\ncreated by main.(*Accounting).Start\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:280 +0x8a\r\n\r\ngoroutine 12 [select]:\r\nmain.(*Accounting).DumpStats(0xc82000a1b0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:260 +0x6f1\r\ncreated by main.(*Accounting).Start\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:282 +0xcf\r\n\r\ngoroutine 13 [select, locked to thread]:\r\nruntime.gopark(0x60bf20, 0xc820021f28, 0x5c24d8, 0x6, 0x18, 0x2)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163\r\nruntime.selectgoImpl(0xc820021f28, 0x0, 0x18)\r\n\t/usr/local/go/src/runtime/select.go:392 +0xa67\r\nruntime.selectgo(0xc820021f28)\r\n\t/usr/local/go/src/runtime/select.go:215 +0x12\r\nruntime.ensureSigM.func1()\r\n\t/usr/local/go/src/runtime/signal1_unix.go:279 +0x358\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1\r\n```\r\n\r\nAnd here is one with `GOTRACEBACK=all`\r\n\r\n```\r\npanic: fatal error: malloc deadlock\r\n\r\ngoroutine 0 [idle]:\r\npanic(0x58a9a0, 0xc8200100e0)\r\n\t/usr/local/go/src/runtime/panic.go:355 +0x7a\r\n\r\ngoroutine 7 [syscall, locked to thread]:\r\nruntime.cgocall(0x536610, 0xc8200ebea0, 0x0)\r\n\t/usr/local/go/src/runtime/cgocall.go:123 +0x11b fp=0xc8200ebe50 sp=0xc8200ebe20\r\nmain._Cfunc_nflog_handle_packet(0xef2050, 0x7fc6000008c0, 0x1144, 0x0)\r\n\t??:0 +0x41 fp=0xc8200ebea0 sp=0xc8200ebe50\r\nmain.(*NfLog).Loop(0xc8200160a0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:357 +0x386 fp=0xc8200ebfa8 sp=0xc8200ebea0\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200ebfb0 sp=0xc8200ebfa8\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 1 [chan receive, 1 minutes]:\r\nmain.main()\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:399 +0xf1a\r\n\r\ngoroutine 17 [syscall, 1 minutes, locked to thread]:\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1\r\n\r\ngoroutine 5 [syscall, 1 minutes]:\r\nos/signal.signal_recv(0x0)\r\n\t/usr/local/go/src/runtime/sigqueue.go:116 +0x132\r\nos/signal.loop()\r\n\t/usr/local/go/src/os/signal/signal_unix.go:22 +0x18\r\ncreated by os/signal.init.1\r\n\t/usr/local/go/src/os/signal/signal_unix.go:28 +0x37\r\n\r\ngoroutine 6 [syscall, 1 minutes]:\r\nruntime.CPUProfile(0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/cpuprof.go:421 +0x34\r\nruntime/pprof.profileWriter(0x7fc61782f308, 0xc820028030)\r\n\t/usr/local/go/src/runtime/pprof/pprof.go:607 +0x1c\r\ncreated by runtime/pprof.StartCPUProfile\r\n\t/usr/local/go/src/runtime/pprof/pprof.go:601 +0x145\r\n\r\ngoroutine 8 [runnable, locked to thread]:\r\nmain._C2func_recv(0x5, 0x7fc5fc0008c0, 0x400000, 0x0, 0x1dc4, 0x0, 0x0)\r\n\t??:0 +0x56\r\nmain.(*NfLog).Loop(0xc820016140)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 9 [syscall, locked to thread]:\r\nmain._C2func_recv(0x6, 0x7fc6080008c0, 0x400000, 0x0, 0x0, 0x0, 0x0)\r\n\t??:0 +0x56\r\nmain.(*NfLog).Loop(0xc8200161e0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 10 [syscall, locked to thread]:\r\nmain._C2func_recv(0x7, 0x7fc60e3fc010, 0x400000, 0x0, 0x0, 0x0, 0x0)\r\n\t??:0 +0x56\r\nmain.(*NfLog).Loop(0xc820016280)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 11 [runnable]:\r\nmain.(*Accounting).Engine(0xc82000a1b0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:190 +0x3fa\r\ncreated by main.(*Accounting).Start\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:280 +0x8a\r\n\r\ngoroutine 12 [select]:\r\nmain.(*Accounting).DumpStats(0xc82000a1b0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:260 +0x6f1\r\ncreated by main.(*Accounting).Start\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:282 +0xcf\r\n\r\ngoroutine 13 [select, 1 minutes, locked to thread]:\r\nruntime.gopark(0x60bf20, 0xc820021f28, 0x5c24d8, 0x6, 0x18, 0x2)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163\r\nruntime.selectgoImpl(0xc820021f28, 0x0, 0x18)\r\n\t/usr/local/go/src/runtime/select.go:392 +0xa67\r\nruntime.selectgo(0xc820021f28)\r\n\t/usr/local/go/src/runtime/select.go:215 +0x12\r\nruntime.ensureSigM.func1()\r\n\t/usr/local/go/src/runtime/signal1_unix.go:279 +0x358\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1\r\n```\r\n\r\nAnd one with `GOTRACEBACK=system`\r\n\r\n```\r\npanic: fatal error: malloc deadlock\r\n\r\ngoroutine 0 [idle]:\r\nruntime.throw(0x5c8120, 0xf)\r\n\t/usr/local/go/src/runtime/panic.go:530 +0x90 fp=0xc8200df158 sp=0xc8200df140\r\nruntime.mallocgc(0x21, 0x0, 0x3, 0x0)\r\n\t/usr/local/go/src/runtime/malloc.go:544 +0x1cc fp=0xc8200df230 sp=0xc8200df158\r\nruntime.rawstring(0x21, 0x0, 0x0, 0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/string.go:284 +0x70 fp=0xc8200df278 sp=0xc8200df230\r\nruntime.rawstringtmp(0x0, 0x21, 0x0, 0x0, 0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/string.go:111 +0xb7 fp=0xc8200df2b0 sp=0xc8200df278\r\nruntime.concatstrings(0x0, 0xc8200df440, 0x2, 0x2, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/string.go:49 +0x1bb fp=0xc8200df3e8 sp=0xc8200df2b0\r\nruntime.concatstring2(0x0, 0x5c92c0, 0xf, 0x5e52d0, 0x12, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/string.go:59 +0x67 fp=0xc8200df438 sp=0xc8200df3e8\r\nruntime.(*errorString).Error(0xc8200100d0, 0x0, 0x0)\r\n\t\u003cautogenerated\u003e:2 +0xde fp=0xc8200df498 sp=0xc8200df438\r\nruntime.printany(0x58a9a0, 0xc8200100d0)\r\n\t/usr/local/go/src/runtime/error.go:73 +0x1aa fp=0xc8200df568 sp=0xc8200df498\r\npanic(0x58a9a0, 0xc8200100d0)\r\n\t/usr/local/go/src/runtime/panic.go:355 +0x7a fp=0xc8200df5e8 sp=0xc8200df568\r\nruntime.panicindex()\r\n\t/usr/local/go/src/runtime/panic.go:15 +0x49 fp=0xc8200df610 sp=0xc8200df5e8\r\nruntime.findfunc(0x536110, 0x0)\r\n\t/usr/local/go/src/runtime/symtab.go:227 +0x195 fp=0xc8200df650 sp=0xc8200df610\r\nruntime.setsSP(0x536110, 0xc800000000)\r\n\t/usr/local/go/src/runtime/proc.go:3104 +0x21 fp=0xc8200df668 sp=0xc8200df650\r\nruntime.sigprof(0x536110, 0x7f8f237fdd18, 0x0, 0xc8200a6780, 0xc8200a4800)\r\n\t/usr/local/go/src/runtime/proc.go:3020 +0xb8 fp=0xc8200df940 sp=0xc8200df668\r\nruntime.sighandler(0xc80000001b, 0xc8200dfbb0, 0xc8200dfa80, 0xc8200a6780)\r\n\t/usr/local/go/src/runtime/signal_amd64x.go:49 +0xbe fp=0xc8200df9d8 sp=0xc8200df940\r\nruntime.sigtrampgo(0x1b, 0xc8200dfbb0, 0xc8200dfa80)\r\n\t/usr/local/go/src/runtime/signal_sigtramp.go:48 +0xf6 fp=0xc8200dfa60 sp=0xc8200df9d8\r\nruntime.sigtramp(0x1, 0x0, 0xc8200d8000, 0x0, 0x7fa0, 0x7f8f30155ad0, 0x13f3010, 0x7f8f237fdd40, 0x5f7140, 0x7f8f30155ac0, ...)\r\n\t/usr/local/go/src/runtime/sys_linux_amd64.s:234 +0x1b fp=0xc8200dfa80 sp=0xc8200dfa60\r\nruntime.sigreturn(0x0, 0xc8200d8000, 0x0, 0x7fa0, 0x7f8f30155ad0, 0x13f3010, 0x7f8f237fdd40, 0x5f7140, 0x7f8f30155ac0, 0x50, ...)\r\n\t/usr/local/go/src/runtime/sys_linux_amd64.s:238 fp=0xc8200dfa88 sp=0xc8200dfa80\r\n\r\ngoroutine 7 [syscall, locked to thread]:\r\nruntime.cgocall(0x536610, 0xc8200e5ea0, 0x0)\r\n\t/usr/local/go/src/runtime/cgocall.go:123 +0x11b fp=0xc8200e5e50 sp=0xc8200e5e20\r\nmain._Cfunc_nflog_handle_packet(0x13f3050, 0x7f8f30155010, 0x1144, 0x0)\r\n\t??:0 +0x41 fp=0xc8200e5ea0 sp=0xc8200e5e50\r\nmain.(*NfLog).Loop(0xc8200160a0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:357 +0x386 fp=0xc8200e5fa8 sp=0xc8200e5ea0\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200e5fb0 sp=0xc8200e5fa8\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 1 [chan receive]:\r\nruntime.gopark(0x60bee8, 0xc820060598, 0x5c6990, 0xc, 0x17, 0x3)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820039bb0 sp=0xc820039b88\r\nruntime.goparkunlock(0xc820060598, 0x5c6990, 0xc, 0xc8200a2017, 0x3)\r\n\t/usr/local/go/src/runtime/proc.go:268 +0x54 fp=0xc820039be8 sp=0xc820039bb0\r\nruntime.chanrecv(0x5462c0, 0xc820060540, 0xc820039eb8, 0x1, 0x0)\r\n\t/usr/local/go/src/runtime/chan.go:470 +0x49f fp=0xc820039c70 sp=0xc820039be8\r\nruntime.chanrecv1(0x5462c0, 0xc820060540, 0xc820039eb8)\r\n\t/usr/local/go/src/runtime/chan.go:355 +0x2b fp=0xc820039ca0 sp=0xc820039c70\r\nmain.main()\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:399 +0xf1a fp=0xc820039f60 sp=0xc820039ca0\r\nruntime.main()\r\n\t/usr/local/go/src/runtime/proc.go:188 +0x2b0 fp=0xc820039fb0 sp=0xc820039f60\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820039fb8 sp=0xc820039fb0\r\n\r\ngoroutine 17 [syscall, locked to thread]:\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820038fb8 sp=0xc820038fb0\r\n\r\ngoroutine 2 [force gc (idle)]:\r\nruntime.gopark(0x60bee8, 0x8a8db0, 0x5c7450, 0xf, 0x14, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820024758 sp=0xc820024730\r\nruntime.goparkunlock(0x8a8db0, 0x5c7450, 0xf, 0xc820000114, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:268 +0x54 fp=0xc820024790 sp=0xc820024758\r\nruntime.forcegchelper()\r\n\t/usr/local/go/src/runtime/proc.go:229 +0xb8 fp=0xc8200247c0 sp=0xc820024790\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200247c8 sp=0xc8200247c0\r\ncreated by runtime.init.4\r\n\t/usr/local/go/src/runtime/proc.go:218 +0x2b\r\n\r\ngoroutine 3 [GC sweep wait]:\r\nruntime.gopark(0x60bee8, 0x8a8f00, 0x5c47c0, 0xd, 0x45cf14, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820024f48 sp=0xc820024f20\r\nruntime.goparkunlock(0x8a8f00, 0x5c47c0, 0xd, 0x14, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:268 +0x54 fp=0xc820024f80 sp=0xc820024f48\r\nruntime.bgsweep(0xc820056000)\r\n\t/usr/local/go/src/runtime/mgcsweep.go:79 +0x14d fp=0xc820024fb8 sp=0xc820024f80\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820024fc0 sp=0xc820024fb8\r\ncreated by runtime.gcenable\r\n\t/usr/local/go/src/runtime/mgc.go:191 +0x53\r\n\r\ngoroutine 4 [finalizer wait]:\r\nruntime.gopark(0x60bee8, 0x8c3a20, 0x5c7120, 0xe, 0x14, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820025718 sp=0xc8200256f0\r\nruntime.goparkunlock(0x8c3a20, 0x5c7120, 0xe, 0x14, 0x1)\r\n\t/usr/local/go/src/runtime/proc.go:268 +0x54 fp=0xc820025750 sp=0xc820025718\r\nruntime.runfinq()\r\n\t/usr/local/go/src/runtime/mfinal.go:158 +0xaa fp=0xc8200257c0 sp=0xc820025750\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200257c8 sp=0xc8200257c0\r\ncreated by runtime.createfing\r\n\t/usr/local/go/src/runtime/mfinal.go:139 +0x60\r\n\r\ngoroutine 5 [syscall]:\r\nruntime.notetsleepg(0x8c3ca0, 0xffffffffffffffff, 0x1)\r\n\t/usr/local/go/src/runtime/lock_futex.go:205 +0x4e fp=0xc820025f40 sp=0xc820025f18\r\nos/signal.signal_recv(0x0)\r\n\t/usr/local/go/src/runtime/sigqueue.go:116 +0x132 fp=0xc820025f78 sp=0xc820025f40\r\nos/signal.loop()\r\n\t/usr/local/go/src/os/signal/signal_unix.go:22 +0x18 fp=0xc820025fc0 sp=0xc820025f78\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820025fc8 sp=0xc820025fc0\r\ncreated by os/signal.init.1\r\n\t/usr/local/go/src/os/signal/signal_unix.go:28 +0x37\r\n\r\ngoroutine 6 [syscall]:\r\nruntime.notetsleepg(0x7f8f3255a008, 0xffffffffffffffff, 0x0)\r\n\t/usr/local/go/src/runtime/lock_futex.go:205 +0x4e fp=0xc820026620 sp=0xc8200265f8\r\nruntime.(*cpuProfile).getprofile(0x7f8f3255a000, 0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/cpuprof.go:341 +0x5dd fp=0xc820026728 sp=0xc820026620\r\nruntime.CPUProfile(0x0, 0x0, 0x0)\r\n\t/usr/local/go/src/runtime/cpuprof.go:421 +0x34 fp=0xc820026750 sp=0xc820026728\r\nruntime/pprof.profileWriter(0x7f8f34bdd308, 0xc820028030)\r\n\t/usr/local/go/src/runtime/pprof/pprof.go:607 +0x1c fp=0xc8200267b0 sp=0xc820026750\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200267b8 sp=0xc8200267b0\r\ncreated by runtime/pprof.StartCPUProfile\r\n\t/usr/local/go/src/runtime/pprof/pprof.go:601 +0x145\r\n\r\ngoroutine 8 [runnable, locked to thread]:\r\nruntime.cgocall(0x536610, 0xc820036ea0, 0x0)\r\n\t/usr/local/go/src/runtime/cgocall.go:123 +0x11b fp=0xc820036e50 sp=0xc820036e20\r\nmain._Cfunc_nflog_handle_packet(0x13f3b50, 0x7f8f180008c0, 0x1dc4, 0xffffffff)\r\n\t??:0 +0x41 fp=0xc820036ea0 sp=0xc820036e50\r\nmain.(*NfLog).Loop(0xc820016140)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:357 +0x386 fp=0xc820036fa8 sp=0xc820036ea0\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820036fb0 sp=0xc820036fa8\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 9 [syscall, locked to thread]:\r\nruntime.cgocall(0x5364a0, 0xc820035ea0, 0x0)\r\n\t/usr/local/go/src/runtime/cgocall.go:123 +0x11b fp=0xc820035e30 sp=0xc820035e00\r\nmain._C2func_recv(0x6, 0x7f8f280008c0, 0x400000, 0x0, 0x0, 0x0, 0x0)\r\n\t??:0 +0x56 fp=0xc820035ea0 sp=0xc820035e30\r\nmain.(*NfLog).Loop(0xc8200161e0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202 fp=0xc820035fa8 sp=0xc820035ea0\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820035fb0 sp=0xc820035fa8\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 10 [syscall, locked to thread]:\r\nruntime.cgocall(0x5364a0, 0xc8200e4ea0, 0xc800000000)\r\n\t/usr/local/go/src/runtime/cgocall.go:123 +0x11b fp=0xc8200e4e30 sp=0xc8200e4e00\r\nmain._C2func_recv(0x7, 0x7f8f1c0008c0, 0x400000, 0x0, 0x0, 0x0, 0x0)\r\n\t??:0 +0x56 fp=0xc8200e4ea0 sp=0xc8200e4e30\r\nmain.(*NfLog).Loop(0xc820016280)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:344 +0x202 fp=0xc8200e4fa8 sp=0xc8200e4ea0\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200e4fb0 sp=0xc8200e4fa8\r\ncreated by main.NewNfLog\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/nflog.go:192 +0x501\r\n\r\ngoroutine 11 [select]:\r\nruntime.gopark(0x60bf20, 0xc820034ed8, 0x5c24d8, 0x6, 0xc820485e18, 0x2)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820034c00 sp=0xc820034bd8\r\nruntime.selectgoImpl(0xc820034ed8, 0x0, 0x18)\r\n\t/usr/local/go/src/runtime/select.go:392 +0xa67 fp=0xc820034dc0 sp=0xc820034c00\r\nruntime.selectgo(0xc820034ed8)\r\n\t/usr/local/go/src/runtime/select.go:215 +0x12 fp=0xc820034de0 sp=0xc820034dc0\r\nmain.(*Accounting).Engine(0xc82000a1b0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:190 +0x3fa fp=0xc820034fa8 sp=0xc820034de0\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820034fb0 sp=0xc820034fa8\r\ncreated by main.(*Accounting).Start\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:280 +0x8a\r\n\r\ngoroutine 12 [select]:\r\nruntime.gopark(0x60bf20, 0xc820077f00, 0x5c24d8, 0x6, 0x18, 0x2)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820077bc8 sp=0xc820077ba0\r\nruntime.selectgoImpl(0xc820077f00, 0x0, 0x18)\r\n\t/usr/local/go/src/runtime/select.go:392 +0xa67 fp=0xc820077d88 sp=0xc820077bc8\r\nruntime.selectgo(0xc820077f00)\r\n\t/usr/local/go/src/runtime/select.go:215 +0x12 fp=0xc820077da8 sp=0xc820077d88\r\nmain.(*Accounting).DumpStats(0xc82000a1b0)\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:260 +0x6f1 fp=0xc820077f98 sp=0xc820077da8\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820077fa0 sp=0xc820077f98\r\ncreated by main.(*Accounting).Start\r\n\t/home/ncw/Code/Go/src/github.com/ncw/go-nflog-acctd/main.go:282 +0xcf\r\n\r\ngoroutine 13 [select, locked to thread]:\r\nruntime.gopark(0x60bf20, 0xc820021f28, 0x5c24d8, 0x6, 0x18, 0x2)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820021d08 sp=0xc820021ce0\r\nruntime.selectgoImpl(0xc820021f28, 0x0, 0x18)\r\n\t/usr/local/go/src/runtime/select.go:392 +0xa67 fp=0xc820021ec8 sp=0xc820021d08\r\nruntime.selectgo(0xc820021f28)\r\n\t/usr/local/go/src/runtime/select.go:215 +0x12 fp=0xc820021ee8 sp=0xc820021ec8\r\nruntime.ensureSigM.func1()\r\n\t/usr/local/go/src/runtime/signal1_unix.go:279 +0x358 fp=0xc820021fc0 sp=0xc820021ee8\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820021fc8 sp=0xc820021fc0\r\ncreated by runtime.ensureSigM\r\n\t/usr/local/go/src/runtime/signal1_unix.go:292 +0xd0\r\n\r\ngoroutine 14 [syscall]:\r\nruntime.notetsleepg(0x8a8f38, 0x25406bc80, 0x16)\r\n\t/usr/local/go/src/runtime/lock_futex.go:205 +0x4e fp=0xc820022738 sp=0xc820022710\r\nruntime.timerproc()\r\n\t/usr/local/go/src/runtime/time.go:209 +0xde fp=0xc8200227c0 sp=0xc820022738\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200227c8 sp=0xc8200227c0\r\ncreated by runtime.addtimerLocked\r\n\t/usr/local/go/src/runtime/time.go:116 +0x11f\r\n\r\ngoroutine 18 [GC worker (idle)]:\r\nruntime.gopark(0xc8203b8010, 0xc82048c7a0, 0x5e06b0, 0x10, 0x14, 0x0)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc82048c740 sp=0xc82048c718\r\nruntime.gcBgMarkWorker(0xc820018000)\r\n\t/usr/local/go/src/runtime/mgc.go:1402 +0xda fp=0xc82048c7b8 sp=0xc82048c740\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc82048c7c0 sp=0xc82048c7b8\r\ncreated by runtime.gcBgMarkStartWorkers\r\n\t/usr/local/go/src/runtime/mgc.go:1329 +0x92\r\n\r\ngoroutine 19 [GC worker (idle)]:\r\nruntime.gopark(0xc820478000, 0xc82048cfa0, 0x5e06b0, 0x10, 0x14, 0x0)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc82048cf40 sp=0xc82048cf18\r\nruntime.gcBgMarkWorker(0xc820019500)\r\n\t/usr/local/go/src/runtime/mgc.go:1402 +0xda fp=0xc82048cfb8 sp=0xc82048cf40\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc82048cfc0 sp=0xc82048cfb8\r\ncreated by runtime.gcBgMarkStartWorkers\r\n\t/usr/local/go/src/runtime/mgc.go:1329 +0x92\r\n\r\ngoroutine 15 [GC worker (idle)]:\r\nruntime.gopark(0xc82017dba0, 0xc8200217a0, 0x5e06b0, 0x10, 0x14, 0x0)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820021740 sp=0xc820021718\r\nruntime.gcBgMarkWorker(0xc82001aa00)\r\n\t/usr/local/go/src/runtime/mgc.go:1402 +0xda fp=0xc8200217b8 sp=0xc820021740\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc8200217c0 sp=0xc8200217b8\r\ncreated by runtime.gcBgMarkStartWorkers\r\n\t/usr/local/go/src/runtime/mgc.go:1329 +0x92\r\n\r\ngoroutine 16 [GC worker (idle)]:\r\nruntime.gopark(0xc820185910, 0xc820022fa0, 0x5e06b0, 0x10, 0x14, 0x0)\r\n\t/usr/local/go/src/runtime/proc.go:262 +0x163 fp=0xc820022f40 sp=0xc820022f18\r\nruntime.gcBgMarkWorker(0xc82001c000)\r\n\t/usr/local/go/src/runtime/mgc.go:1402 +0xda fp=0xc820022fb8 sp=0xc820022f40\r\nruntime.goexit()\r\n\t/usr/local/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820022fc0 sp=0xc820022fb8\r\ncreated by runtime.gcBgMarkStartWorkers\r\n\t/usr/local/go/src/runtime/mgc.go:1329 +0x92\r\n```",
	"user": {
		"login": "ncw",
		"id": 536803,
		"type": "User",
		"site_admin": false
	},
	"assignee": {
		"login": "ianlancetaylor",
		"id": 3194333,
		"type": "User",
		"site_admin": false
	},
	"comments": 5,
	"closed_at": "2016-03-04T21:06:50Z",
	"created_at": "2016-03-02T17:44:52Z",
	"updated_at": "2016-04-19T23:13:51Z",
	"milestone": {
		"id": 1688612,
		"number": 37,
		"title": "Go1.6.2"
	}
}
