{
	"id": 171323377,
	"number": 16720,
	"state": "closed",
	"title": "cmd/vet: go vet import panic",
	"body": "Please answer these questions before submitting your issue. Thanks!\r\n\r\n1. What version of Go are you using (`go version`)?\r\ngo version go1.7 linux/amd64\r\n\r\n2. What operating system and processor architecture are you using (`go env`)?\r\nGOARCH=\"amd64\"\r\nGOBIN=\"\"\r\nGOEXE=\"\"\r\nGOHOSTARCH=\"amd64\"\r\nGOHOSTOS=\"linux\"\r\nGOOS=\"linux\"\r\nGOPATH=\"/home/chris/go\"\r\nGORACE=\"\"\r\nGOROOT=\"/usr/local/go\"\r\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\r\nCC=\"gcc\"\r\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build917801568=/tmp/go-build -gno-record-gcc-switches\"\r\nCXX=\"g++\"\r\nCGO_ENABLED=\"1\"\r\n\r\n3. What did you do?\r\n`\r\ncd $GOPATH/src/github.com/prometheus/client_golang \u0026\u0026 go vet ./...\r\n`\r\nThe client_golang hash: 25db0447498b30e85d2947c24d5f1d37979b56bd\r\n\r\nHowever, this is bizarre because I then removed and reinstalled this repo with the same hash. Afterwards, warnings were printed as one would expect.\r\n\r\nI think the particular package is a red herring. I also saw go vet panics against constabulary/gb, but reinstalling the repo (same version) made the panics disappear.\r\n\r\nI don't understand why panics are consistent, and then disappear when I reinstall. I tried running 'touch' against all the files in these repos before removing things, but I still saw panics.\r\n\r\nI can cat the files just fine, so I don't think I have crazy filesystem/disk problems.\r\n\r\nI'd recommend running:\r\n\r\n`\r\ncd $GOPATH/src \u0026\u0026 go vet ./...\r\n`\r\nSee if you notice any panics in your environment.\r\n\r\n4. What did you expect to see?\r\nNothing, or go vet warnings\r\n\r\n5. What did you see instead?\r\n\r\npanic: inconsistent import:\r\n       \tvar io.ErrUnexpectedEOF error\r\npreviously imported as:\r\n       \tvar ErrUnexpectedEOF error\r\n [recovered]\r\n       \tpanic: inconsistent import:\r\n       \tvar io.ErrUnexpectedEOF error\r\npreviously imported as:\r\n       \tvar ErrUnexpectedEOF error\r\n\r\n\r\ngoroutine 1 [running]:\r\npanic(0x674b20, 0xc420326cb0)\r\n       \t/usr/local/go/src/runtime/panic.go:500 +0x1a1\r\ngo/types.(*Checker).handleBailout(0xc4200b61c0, 0xc4203db8d8)\r\n       \t/usr/local/go/src/go/types/check.go:213 +0xae\r\npanic(0x674b20, 0xc420326cb0)\r\n       \t/usr/local/go/src/runtime/panic.go:458 +0x243\r\ngo/internal/gcimporter.(*importer).declare(0xc4203aea90, 0x7f64a0, 0xc4204efb80)\r\n       \t/usr/local/go/src/go/internal/gcimporter/bimport.go:175 +0x17c\r\ngo/internal/gcimporter.(*importer).obj(0xc4203aea90, 0xfffffffffffffffc)\r\n       \t/usr/local/go/src/go/internal/gcimporter/bimport.go:195 +0x1b4\r\ngo/internal/gcimporter.BImportData(0xc420012ff0, 0xc420410000, 0x107a4, 0x1fe00, 0xc4201f35e9, 0x2, 0x0, 0x2, 0xc41ffe82af, 0x0)\r\n       \t/usr/local/go/src/go/internal/gcimporter/bimport.go:88 +0x390\r\ngo/internal/gcimporter.Import(0xc420012ff0, 0xc4201f35e9, 0x2, 0x7ffea37951ea, 0xa, 0xc42014e3c0, 0x0, 0x0)\r\n       \t/usr/local/go/src/go/internal/gcimporter/gcimporter.go:166 +0x551\r\ngo/importer.gcimports.ImportFrom(0xc420012ff0, 0xc4201f35e9, 0x2, 0x7ffea37951ea, 0xa, 0x0, 0xc420053810, 0x0, 0x0)\r\n       \t/usr/local/go/src/go/importer/importer.go:70 +0x67\r\ngo/types.(*Checker).collectObjects(0xc4200b61c0)\r\n       \t/usr/local/go/src/go/types/resolver.go:191 +0x826\r\ngo/types.(*Checker).checkFiles(0xc4200b61c0, 0xc4202fa600, 0x1b, 0x20, 0x0, 0x0)\r\n       \t/usr/local/go/src/go/types/check.go:225 +0xaa\r\ngo/types.(*Checker).Files(0xc4200b61c0, 0xc4202fa600, 0x1b, 0x20, 0xc420395680, 0xc4200c9960)\r\n       \t/usr/local/go/src/go/types/check.go:218 +0x49\r\ngo/types.(*Config).Check(0xc42039ea00, 0xc42000f9e0, 0xa, 0xc420019540, 0xc4202fa600, 0x1b, 0x20, 0xc42038bb80, 0x40, 0xc4200001a0, ...)\r\n       \t/usr/local/go/src/go/types/api.go:344 +0x1a3\r\nmain.(*Package).check(0xc420071920, 0xc420019540, 0xc4202fa600, 0x1b, 0x20, 0x0, 0xc420363280)\r\n       \t/usr/local/go/src/cmd/vet/types.go:76 +0x370\r\nmain.doPackage(0x6cf324, 0x1, 0xc42000a1d0, 0x1b, 0x1b, 0x0, 0x1)\r\n       \t/usr/local/go/src/cmd/vet/main.go:336 +0x999\r\nmain.main()\r\n       \t/usr/local/go/src/cmd/vet/main.go:244 +0x345\r\nexit status 2\r\npanic: inconsistent import:\r\n       \tfunc errors.New(text string) error\r\npreviously imported as:\r\n       \tfunc errors.New(text string) error\r\n [recovered]\r\n       \tpanic: inconsistent import:\r\n       \tfunc errors.New(text string) error\r\npreviously imported as:\r\n       \tfunc errors.New(text string) error\r\n\r\ngoroutine 1 [running]:\r\npanic(0x674b20, 0xc420131110)\r\n       \t/usr/local/go/src/runtime/panic.go:500 +0x1a1\r\ngo/types.(*Checker).handleBailout(0xc4200b41c0, 0xc4202078d8)\r\n       \t/usr/local/go/src/go/types/check.go:213 +0xae\r\npanic(0x674b20, 0xc420131110)\r\n       \t/usr/local/go/src/runtime/panic.go:458 +0x243\r\ngo/internal/gcimporter.(*importer).declare(0xc420137930, 0x7f6180, 0xc420134b40)\r\n       \t/usr/local/go/src/go/internal/gcimporter/bimport.go:175 +0x17c\r\ngo/internal/gcimporter.(*importer).obj(0xc420137930, 0xfffffffffffffffb)\r\n       \t/usr/local/go/src/go/internal/gcimporter/bimport.go:203 +0x4a2\r\ngo/internal/gcimporter.BImportData(0xc42000b050, 0xc420139000, 0xb52, 0xe00, 0xc42015f079, 0x6, 0x0, 0x6, 0xc42012afc0, 0xc420207098)\r\n       \t/usr/local/go/src/go/internal/gcimporter/bimport.go:88 +0x390\r\ngo/internal/gcimporter.Import(0xc42000b050, 0xc42015f079, 0x6, 0x7ffc57888440, 0x13, 0xc4206f8960, 0x0, 0x0)\r\n       \t/usr/local/go/src/go/internal/gcimporter/gcimporter.go:166 +0x551\r\ngo/importer.gcimports.ImportFrom(0xc42000b050, 0xc42015f079, 0x6, 0x7ffc57888440, 0x13, 0x0, 0xc420178550, 0x0, 0x0)\r\n       \t/usr/local/go/src/go/importer/importer.go:70 +0x67\r\ngo/types.(*Checker).collectObjects(0xc4200b41c0)\r\n       \t/usr/local/go/src/go/types/resolver.go:191 +0x826\r\ngo/types.(*Checker).checkFiles(0xc4200b41c0, 0xc4201761e0, 0x2, 0x2, 0x0, 0x0)\r\n       \t/usr/local/go/src/go/types/check.go:225 +0xaa\r\ngo/types.(*Checker).Files(0xc4200b41c0, 0xc4201761e0, 0x2, 0x2, 0xc42016b1d0, 0xc4200c7960)\r\n       \t/usr/local/go/src/go/types/check.go:218 +0x49\r\ngo/types.(*Config).Check(0xc420170ec0, 0xc42000f9d8, 0x8, 0xc420017540, 0xc4201761e0, 0x2, 0x2, 0xc420178050, 0x80, 0xc4200001a0, ...)\r\n       \t/usr/local/go/src/go/types/api.go:344 +0x1a3\r\nmain.(*Package).check(0xc42006e840, 0xc420017540, 0xc4201761e0, 0x2, 0x2, 0xc4201761f0, 0x1)\r\n       \t/usr/local/go/src/cmd/vet/types.go:76 +0x370\r\nmain.doPackage(0x6cf324, 0x1, 0xc42000a2e0, 0x2, 0x2, 0x0, 0x1)\r\n       \t/usr/local/go/src/cmd/vet/main.go:336 +0x999\r\nmain.main()\r\n       \t/usr/local/go/src/cmd/vet/main.go:244 +0x345\r\nexit status 2\r\n",
	"user": {
		"login": "tendervittles",
		"id": 5739852,
		"type": "User",
		"site_admin": false
	},
	"comments": 1,
	"closed_at": "2016-08-16T13:36:50Z",
	"created_at": "2016-08-16T04:38:12Z",
	"updated_at": "2016-08-16T13:36:50Z",
	"milestone": {
		"id": 1709363,
		"number": 38,
		"title": "Go1.8"
	}
}
