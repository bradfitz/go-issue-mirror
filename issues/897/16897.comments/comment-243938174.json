{
	"id": 243938174,
	"body": "@josharian I have now implemented fmt.Formatters for all types handled by fmt.go and also converted all source code to use formatted printing. For instance, an `sconv(s, FmtSign)` for the format `%v` becomes just `s` with the format `%+v` (I'm going to make these formats `%+S` for better readability).\r\n\r\nRunning the above benchmark above against commit c85b77c and current tip (commit cd0ba4c, excl. my new changes) results in:\r\n```\r\nname       old time/op     new time/op     delta\r\nTemplate       307ms ± 4%      301ms ± 5%   -1.84%        (p=0.003 n=29+29)\r\nUnicode        164ms ± 4%      160ms ± 4%   -2.18%        (p=0.000 n=30+29)\r\nGoTypes        1.01s ± 3%      1.01s ± 3%     ~           (p=0.398 n=30+30)\r\nCompiler       5.49s ± 1%      5.47s ± 2%     ~           (p=0.181 n=30+29)\r\n\r\nname       old alloc/op    new alloc/op    delta\r\nTemplate      46.8MB ± 0%     47.2MB ± 0%   +0.98%        (p=0.000 n=29+30)\r\nUnicode       37.8MB ± 0%     38.0MB ± 0%   +0.55%        (p=0.000 n=30+29)\r\nGoTypes        143MB ± 0%      145MB ± 0%   +1.59%        (p=0.000 n=30+30)\r\nCompiler       683MB ± 0%      700MB ± 0%   +2.42%        (p=0.000 n=30+30)\r\n\r\nname       old allocs/op   new allocs/op   delta\r\nTemplate        444k ± 0%       479k ± 0%   +7.86%        (p=0.000 n=30+30)\r\nUnicode         369k ± 0%       378k ± 0%   +2.69%        (p=0.000 n=30+30)\r\nGoTypes        1.35M ± 0%      1.50M ± 0%  +10.68%        (p=0.000 n=30+30)\r\nCompiler       5.66M ± 0%      6.21M ± 0%   +9.72%        (p=0.000 n=29+30)\r\n```\r\nThis is about what we had yesterday.\r\n\r\nRunning the above benchmark above against commit c85b77c and and my local tip (incl. my new changes) results in:\r\n```\r\nname       old time/op     new time/op     delta\r\nTemplate       307ms ± 4%      304ms ± 3%    ~           (p=0.053 n=29+29)\r\nUnicode        164ms ± 4%      160ms ± 8%  -2.34%        (p=0.000 n=30+30)\r\nGoTypes        1.01s ± 3%      1.05s ± 3%  +3.60%        (p=0.000 n=30+29)\r\nCompiler       5.49s ± 1%      5.52s ± 1%  +0.42%        (p=0.009 n=30+29)\r\n\r\nname       old alloc/op    new alloc/op    delta\r\nTemplate      46.8MB ± 0%     46.8MB ± 0%  +0.14%        (p=0.000 n=29+30)\r\nUnicode       37.8MB ± 0%     37.9MB ± 0%  +0.24%        (p=0.000 n=30+30)\r\nGoTypes        143MB ± 0%      144MB ± 0%  +0.50%        (p=0.000 n=30+30)\r\nCompiler       683MB ± 0%      688MB ± 0%  +0.69%        (p=0.000 n=30+30)\r\n\r\nname       old allocs/op   new allocs/op   delta\r\nTemplate        444k ± 0%       471k ± 0%  +6.05%        (p=0.000 n=30+30)\r\nUnicode         369k ± 0%       376k ± 0%  +2.00%        (p=0.000 n=30+30)\r\nGoTypes        1.35M ± 0%      1.47M ± 0%  +8.53%        (p=0.000 n=30+30)\r\nCompiler       5.66M ± 0%      6.07M ± 0%  +7.22%        (p=0.000 n=29+29)\r\n```\r\nThis shows an improvement - albeit not as much as I hoped. But the changes should have removed many function calls to the various Xconv routines all over the place. There should also much fewer strings be allocated and concatenated.\r\n\r\nFor final comparison: Current master tip as above against my local tip:\r\n```\r\nname       old time/op     new time/op     delta\r\nTemplate       301ms ± 5%      304ms ± 3%    ~           (p=0.110 n=29+29)\r\nUnicode        160ms ± 4%      160ms ± 8%    ~           (p=0.769 n=29+30)\r\nGoTypes        1.01s ± 3%      1.05s ± 3%  +3.82%        (p=0.000 n=30+29)\r\nCompiler       5.47s ± 2%      5.52s ± 1%  +0.82%        (p=0.000 n=29+29)\r\n\r\nname       old alloc/op    new alloc/op    delta\r\nTemplate      47.2MB ± 0%     46.8MB ± 0%  -0.83%        (p=0.000 n=30+30)\r\nUnicode       38.0MB ± 0%     37.9MB ± 0%  -0.31%        (p=0.000 n=29+30)\r\nGoTypes        145MB ± 0%      144MB ± 0%  -1.07%        (p=0.000 n=30+30)\r\nCompiler       700MB ± 0%      688MB ± 0%  -1.69%        (p=0.000 n=30+30)\r\n\r\nname       old allocs/op   new allocs/op   delta\r\nTemplate        479k ± 0%       471k ± 0%  -1.67%        (p=0.000 n=30+30)\r\nUnicode         378k ± 0%       376k ± 0%  -0.68%        (p=0.000 n=30+30)\r\nGoTypes        1.50M ± 0%      1.47M ± 0%  -1.94%        (p=0.000 n=30+30)\r\nCompiler       6.21M ± 0%      6.07M ± 0%  -2.28%        (p=0.000 n=30+29)\r\n```\r\nI'm going to send out a series of CLs (about one dozen in total) with the respective changes.\r\n",
	"user": {
		"login": "griesemer",
		"id": 8528975,
		"type": "User",
		"site_admin": false
	},
	"created_at": "2016-08-31T23:59:55Z",
	"updated_at": "2016-08-31T23:59:55Z"
}
