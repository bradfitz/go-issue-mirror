{
	"id": 51287624,
	"number": 8063,
	"state": "closed",
	"title": "runtime: async signal can cause traceback failure errors",
	"body": "\u003cpre\u003eNormally we expect tracebacks to only need to handle frame sequences starting at a safe\npoint (a function call or a possible panic). Assembly that cannot fault typically\ndoesn't need an argument frame size because it will not appear in a traceback. However,\nDave Cheney reports that SIGQUIT can cause the traceback code to run starting at an\narbitrary location. If the traceback is just for printing the stack, we should probably\ntell the traceback code not to complain about missing arg frame size. If the traceback\nwas being used for something more important, we need to understand what that was and\nmake the async signal handler not need that.\n\n\n\n---------- Forwarded message ----------\nFrom: Dave Cheney \u0026lt;dave@cheney.net\u0026gt;\nDate: Tue, May 20, 2014 at 8:11 PM\nSubject: runtime: unknown argument frame size for math/big.addMulVVW called from\n0x8abf6e [math/big.basicMul]\nTo: Russ Cox \u0026lt;rsc@golang.org\u0026gt;\n\n\nHi Russ,\n\nI ran across this failure today. The repro is a bit hard as it relies\non the test being killed by the watchdog, so this panic was due to the\ntimeout code killing the test process with SIGQUIT.\n\nWould you like to see this as an issue?\n\nCheers\n\nDave\n\nSIGQUIT: quit\n\n\n                                                  [416/743]\nPC=0x8b7467\n\ngoroutine 4425 [running]:\nruntime: unknown argument frame size for math/big.addMulVVW called\nfrom 0x8abf6e [math/big.basicMul]\nmath/big.addMulVVW()\n        /home/dfc/go/src/pkg/math/big/arith_amd64.s:362 +0x37 fp=0x7f5f6af630e0\nmath/big.basicMul(0xc2085d87e0, 0x20, 0x24, 0xc208652240, 0x10, 0x24,\n0xc208652240, 0x10, 0x24)\n        /home/dfc/go/src/pkg/math/big/nat.go:216 +0x11e fp=0x7f5f6af63158\nmath/big.nat.mul(0xc2085d87e0, 0x20, 0x24, 0xc208652240, 0x10, 0x24,\n0xc208652240, 0x10, 0x24, 0xc2087142c0, ...)\n        /home/dfc/go/src/pkg/math/big/nat.go:401 +0x34d fp=0x7f5f6af63318\nmath/big.nat.expNNWindowed(0xc208652240, 0x10, 0x24, 0xc2083d6320,\n0x10, 0x14, 0xc2083d61e0, 0x10, 0x14, 0xc2087142c0, ...)\n        /home/dfc/go/src/pkg/math/big/nat.go:1354 +0x8ed fp=0x7f5f6af635a8\nmath/big.nat.expNN(0xc2085d87e0, 0x10, 0x24, 0xc2083d6320, 0x10, 0x14,\n0xc2083d61e0, 0x10, 0x14, 0xc2087142c0, ...)\n        /home/dfc/go/src/pkg/math/big/nat.go:1260 +0x3a0 fp=0x7f5f6af63738\nmath/big.nat.probablyPrime(0xc2087142c0, 0x10, 0x15, 0x14, 0xd2b101)\n        /home/dfc/go/src/pkg/math/big/nat.go:1445 +0x821 fp=0x7f5f6af638b8\nmath/big.(*Int).ProbablyPrime(0xc2085beb60, 0x14, 0x7f5f6b0d3001)\n        /home/dfc/go/src/pkg/math/big/int.go:722 +0x4a fp=0x7f5f6af638f0\ncrypto/rsa.(*PrivateKey).Validate(0xc2082a0660, 0x2, 0x2)\n        /home/dfc/go/src/pkg/crypto/rsa/rsa.go:91 +0xc1 fp=0x7f5f6af639b8\ncrypto/x509.ParsePKCS1PrivateKey(0xc208254000, 0x4a8, 0x4aa,\n0xc2082a0660, 0x0, 0x0)\n        /home/dfc/go/src/pkg/crypto/x509/pkcs1.go:77 +0x480 fp=0x7f5f6af63ac0\ngithub.com/joyent/gosign/auth.GetSignature(0xc20821b340, 0xc208699a40,\n0x23, 0x1d, 0xc208699a40, 0x23, 0x7f5f6af63c10)\n        /home/dfc/src/github.com/joyent/gosign/auth/auth.go:78 +0x1ab\nfp=0x7f5f6af63b90\ngithub.com/joyent/gosign/auth.CreateAuthorizationHeader(0xc208699920,\n0xc20821b340, 0x1, 0xc2085beae0, 0x1d, 0x127565625887be89,\n0xc212756562)\n        /home/dfc/src/github.com/joyent/gosign/auth/auth.go:56 +0xbb\nfp=0x7f5f6af63c60\ngithub.com/joyent/gocommon/http.createHeaders(0xc208699800,\n0xc20821b340, 0xdf2a70, 0x18, 0xd3a430, 0x0, 0xd3a430, 0x0, 0x429201,\n0x7f5f6af63dd0, ...)\n        /home/dfc/src/github.com/joyent/gocommon/http/client.go:111\n+0x2e0 fp=0x7f5f6af63d48\ngithub.com/joyent/gocommon/http.(*Client).BinaryRequest(0xc2083b4900,\n0xd44070, 0x3, 0xc2085d03c0, 0x38, 0xd3a430, 0x0, 0xc2085d0340,\n0xc2085d0380, 0xc2085d03c0, ...)\n        /home/dfc/src/github.com/joyent/gocommon/http/client.go:239\n+0x168 fp=0x7f5f6af63df8\ngithub.com/joyent/gocommon/client.(*client).sendRequest(0xc2084c8b40,\n0xd44070, 0x3, 0xc2085d03c0, 0x38, 0xd3a430, 0x0, 0xc2085d0340,\n0xc2085d0380, 0x7f5f5bf21d60, ...)\n        /home/dfc/src/github.com/joyent/gocommon/client/client.go:69\n+0x9d fp=0x7f5f6af63e58\ngithub.com/joyent/gocommon/client.(*client).SendRequest(0xc2084c8b40,\n0xd44070, 0x3, 0xc2085bea20, 0x1c, 0xd3a430, 0x0, 0xc2085d0340,\n0xc2085d0380, 0x0, ...)\n        /home/dfc/src/github.com/joyent/gocommon/client/client.go:76\n+0x11f fp=0x7f5f6af63ef8\ngithub.com/joyent/gomanta/manta.(*Client).sendRequest(0xc2081cb2e0,\n0xd44070, 0x3, 0xc2085bea20, 0x1c, 0x0, 0x0, 0xc208699800, 0x0, 0x0,\n...)\n        /home/dfc/src/github.com/joyent/gomanta/manta/manta.go:88\n+0x21d fp=0x7f5f6af64000\ngithub.com/joyent/gomanta/manta.(*Client).PutDirectory(0xc2081cb2e0,\n0xc2085be9c0, 0x17, 0xc2085be9c0, 0x17)\n        /home/dfc/src/github.com/joyent/gomanta/manta/manta.go:125\n+0x189 fp=0x7f5f6af641a0\nlaunchpad.net/juju-core/provider/joyent.(*JoyentStorage).Put(0xc2084c8b70,\n0xc2085bee40, 0x1b, 0x7f5f6b0f6cc0, 0xc2086994a0, 0x1f2, 0xc208114d80,\n0x1f2)\n        /home/dfc/src/launchpad.net/juju-core/provider/joyent/storage.go:177\n+0x41b fp=0x7f5f6af64370\nlaunchpad.net/juju-core/environs/tools.WriteMetadata(0x7f5f6b0ea860,\n0xc2084c8b70, 0xc20819a4f0, 0x2, 0x2, 0x0, 0xc20819a4f0, 0x2)\n        /home/dfc/src/launchpad.net/juju-core/environs/tools/simplestreams.go:380\n+0x576 fp=0x7f5f6af645d0\nlaunchpad.net/juju-core/environs/tools.MergeAndWriteMetadata(0x7f5f6b0ea860,\n0xc2084c8b70, 0xc20819a910, 0x2, 0x2, 0x0, 0x2, 0x0)\n        /home/dfc/src/launchpad.net/juju-core/environs/tools/simplestreams.go:407\n+0x182 fp=0x7f5f6af64658\nlaunchpad.net/juju-core/environs/testing.UploadFakeToolsVersions(0x7f5f6b0ea860,\n0xc2084c8b70, 0xc20839c480, 0x2, 0x2, 0xc20839c480, 0x1, 0x2,\n0xc2082d2450, 0xffffffff)\n        /home/dfc/src/launchpad.net/juju-core/environs/testing/tools.go:155\n+0x2d6 fp=0x7f5f6af64800\nlaunchpad.net/juju-core/environs/testing.(*ToolsFixture).UploadFakeTools(0xc20803c6e0,\n0xc2087148f0, 0x7f5f6b0ea860, 0xc2084c8b70)\n        /home/dfc/src/launchpad.net/juju-core/environs/testing/tools.go:65\n+0x256 fp=0x7f5f6af64950\nlaunchpad.net/juju-core/environs/jujutest.(*LiveTests).TestPorts(0xc20803c6e0,\n0xc2087148f0)\n        /home/dfc/src/launchpad.net/juju-core/environs/jujutest/livetests.go:214\n+0xa6 fp=0x7f5f6af64ac0\nruntime.call16(0xd1a130, 0xc2081cb890, 0x1000000010)\n        /home/dfc/go/src/pkg/runtime/asm_amd64.s:345 +0x32 fp=0x7f5f6af64ad8\nreflect.Value.call(0xd19c80, 0xc20803c640, 0x0, 0x2d38, 0xd3e530, 0x4,\n0xc208194e20, 0x1, 0x1, 0x20, ...)\n        /home/dfc/go/src/pkg/reflect/value.go:563 +0x1069 fp=0x7f5f6af64e00\nreflect.Value.Call(0xd19c80, 0xc20803c640, 0x0, 0x2d38, 0xc208194e20,\n0x1, 0x1, 0x41cc8c, 0xa839c0, 0xc20806e160)\n        /home/dfc/go/src/pkg/reflect/value.go:411 +0xb3 fp=0x7f5f6af64e68\nlaunchpad.net/gocheck.func·006(0xc2087148f0)\n        /home/dfc/src/launchpad.net/gocheck/gocheck.go:735 +0x355\nfp=0x7f5f6af64f78\nlaunchpad.net/gocheck.func·004()\n        /home/dfc/src/launchpad.net/gocheck/gocheck.go:630 +0x8f\nfp=0x7f5f6af64fa8\nruntime.goexit()\n        /home/dfc/go/src/pkg/runtime/proc.c:1445 fp=0x7f5f6af64fb0\ncreated by launchpad.net/gocheck.(*suiteRunner).forkCall\n        /home/dfc/src/launchpad.net/gocheck/gocheck.go:631 +0x246\u003c/pre\u003e",
	"user": {
		"login": "rsc",
		"id": 104030,
		"type": "User",
		"site_admin": false
	},
	"labels": [
		{
			"name": "FrozenDueToAge"
		}
	],
	"comments": 1,
	"closed_at": "2014-12-08T10:44:44Z",
	"created_at": "2014-05-21T15:25:44Z",
	"updated_at": "2016-06-25T01:34:58Z",
	"milestone": {
		"id": 1067218,
		"number": 21,
		"title": "Go1.4"
	}
}
